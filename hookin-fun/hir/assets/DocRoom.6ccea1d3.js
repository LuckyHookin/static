var Th=Object.defineProperty,_h=Object.defineProperties;var Eh=Object.getOwnPropertyDescriptors;var Oo=Object.getOwnPropertySymbols;var lc=Object.prototype.hasOwnProperty,uc=Object.prototype.propertyIsEnumerable;var fc=(e,t,n)=>t in e?Th(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,S=(e,t)=>{for(var n in t||(t={}))lc.call(t,n)&&fc(e,n,t[n]);if(Oo)for(var n of Oo(t))uc.call(t,n)&&fc(e,n,t[n]);return e},Jt=(e,t)=>_h(e,Eh(t));var pc=(e,t)=>{var n={};for(var r in e)lc.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Oo)for(var r of Oo(e))t.indexOf(r)<0&&uc.call(e,r)&&(n[r]=e[r]);return n};import{g as Dt,l as Rt,P as xr,S as xo,U as _n,w as Ah,V as hc,a as De,W as dc,X as Mo,k as En,Y as Nh,Z as Ih,r as xe,o as q,c as lt,f as rt,s as Ot,F as Ke,p as Bi,n as Re,_ as vc,i as V,x as Co,y as nn,b as Xn,q as rn,$ as Ph,a0 as Dh,a1 as Rh,a2 as Li,a3 as Zn,h as te,a4 as To,R as zi,a5 as Bh,a6 as mc,H as gc,a7 as yc,T as Lh,a8 as bc,a9 as zh,aa as Fh,ab as $h,t as wc,v as kc,Q as Vh,ac as Hh,ad as Sc}from"./vendor.fc9a2dee.js";import{i as jh,F as Jh,G as Wh,H as qh,I as Oc,J as xc,S as Mc,K as Kh,Y as Ue,L as Uh,M as on,N as Gh,P as Yh,Q as Xh,y as Mr,R as Zh,T as Cc,U as Qh,V as td,W as ed,D as Fi,X as $i,Z as Vi,C as nd,_ as rd,B as od,$ as id,s as sd,a0 as ad,a1 as Cr,a2 as Tc,a3 as _c,a4 as cd,a5 as ld,a6 as ud}from"./mutex.decd1ecc.js";import{_ as Tr,S as An}from"./index.6063f5c0.js";const fd=e=>class{constructor(n){this._=n}destroy(){e(this._)}},pd=fd(clearTimeout),hd=(e,t)=>new pd(setTimeout(t,e));function Bt(e){this.content=e}Bt.prototype={constructor:Bt,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return o==-1?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new Bt(i)},remove:function(e){var t=this.find(e);if(t==-1)return this;var n=this.content.slice();return n.splice(t,2),new Bt(n)},addToStart:function(e,t){return new Bt([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new Bt(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(i==-1?o.length:i,0,t,n),new Bt(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=Bt.from(e),e.size?new Bt(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=Bt.from(e),e.size?new Bt(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Bt.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},get size(){return this.content.length>>1}};Bt.from=function(e){if(e instanceof Bt)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new Bt(t)};var Ec=Bt;function Ac(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var o=e.child(r),i=t.child(r);if(o==i){n+=o.nodeSize;continue}if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=Ac(o.content,i.content,n+1);if(a!=null)return a}n+=o.nodeSize}}function Nc(e,t,n,r){for(var o=e.childCount,i=t.childCount;;){if(o==0||i==0)return o==i?null:{a:n,b:r};var s=e.child(--o),a=t.child(--i),c=s.nodeSize;if(s==a){n-=c,r-=c;continue}if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var l=0,u=Math.min(s.text.length,a.text.length);l<u&&s.text[s.text.length-l-1]==a.text[a.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=Nc(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}}var k=function(t,n){if(this.content=t,this.size=n||0,n==null)for(var r=0;r<t.length;r++)this.size+=t[r].nodeSize},_o={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};k.prototype.nodesBetween=function(t,n,r,o,i){o===void 0&&(o=0);for(var s=0,a=0;a<n;s++){var c=this.content[s],l=a+c.nodeSize;if(l>t&&r(c,o+a,i,s)!==!1&&c.content.size){var u=a+1;c.nodesBetween(Math.max(0,t-u),Math.min(c.content.size,n-u),r,o+u)}a=l}};k.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)};k.prototype.textBetween=function(t,n,r,o){var i="",s=!0;return this.nodesBetween(t,n,function(a,c){a.isText?(i+=a.text.slice(Math.max(t,c)-c,n-c),s=!r):a.isLeaf&&o?(i+=typeof o=="function"?o(a):o,s=!r):!s&&a.isBlock&&(i+=r,s=!0)},0),i};k.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var n=this.lastChild,r=t.firstChild,o=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(o[o.length-1]=n.withText(n.text+r.text),i=1);i<t.content.length;i++)o.push(t.content[i]);return new k(o,this.size+t.size)};k.prototype.cut=function(t,n){if(n==null&&(n=this.size),t==0&&n==this.size)return this;var r=[],o=0;if(n>t)for(var i=0,s=0;s<n;i++){var a=this.content[i],c=s+a.nodeSize;c>t&&((s<t||c>n)&&(a.isText?a=a.cut(Math.max(0,t-s),Math.min(a.text.length,n-s)):a=a.cut(Math.max(0,t-s-1),Math.min(a.content.size,n-s-1))),r.push(a),o+=a.nodeSize),s=c}return new k(r,o)};k.prototype.cutByIndex=function(t,n){return t==n?k.empty:t==0&&n==this.content.length?this:new k(this.content.slice(t,n))};k.prototype.replaceChild=function(t,n){var r=this.content[t];if(r==n)return this;var o=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return o[t]=n,new k(o,i)};k.prototype.addToStart=function(t){return new k([t].concat(this.content),this.size+t.nodeSize)};k.prototype.addToEnd=function(t){return new k(this.content.concat(t),this.size+t.nodeSize)};k.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var n=0;n<this.content.length;n++)if(!this.content[n].eq(t.content[n]))return!1;return!0};_o.firstChild.get=function(){return this.content.length?this.content[0]:null};_o.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null};_o.childCount.get=function(){return this.content.length};k.prototype.child=function(t){var n=this.content[t];if(!n)throw new RangeError("Index "+t+" out of range for "+this);return n};k.prototype.maybeChild=function(t){return this.content[t]};k.prototype.forEach=function(t){for(var n=0,r=0;n<this.content.length;n++){var o=this.content[n];t(o,r,n),r+=o.nodeSize}};k.prototype.findDiffStart=function(t,n){return n===void 0&&(n=0),Ac(this,t,n)};k.prototype.findDiffEnd=function(t,n,r){return n===void 0&&(n=this.size),r===void 0&&(r=t.size),Nc(this,t,n,r)};k.prototype.findIndex=function(t,n){if(n===void 0&&(n=-1),t==0)return Eo(0,t);if(t==this.size)return Eo(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var r=0,o=0;;r++){var i=this.child(r),s=o+i.nodeSize;if(s>=t)return s==t||n>0?Eo(r+1,s):Eo(r,o);o=s}};k.prototype.toString=function(){return"<"+this.toStringInner()+">"};k.prototype.toStringInner=function(){return this.content.join(", ")};k.prototype.toJSON=function(){return this.content.length?this.content.map(function(t){return t.toJSON()}):null};k.fromJSON=function(t,n){if(!n)return k.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new k(n.map(t.nodeFromJSON))};k.fromArray=function(t){if(!t.length)return k.empty;for(var n,r=0,o=0;o<t.length;o++){var i=t[o];r+=i.nodeSize,o&&i.isText&&t[o-1].sameMarkup(i)?(n||(n=t.slice(0,o)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new k(n||t,r)};k.from=function(t){if(!t)return k.empty;if(t instanceof k)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new k([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))};Object.defineProperties(k.prototype,_o);var Hi={index:0,offset:0};function Eo(e,t){return Hi.index=e,Hi.offset=t,Hi}k.empty=new k([],0);function Ao(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!Ao(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!Ao(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}var j=function(t,n){this.type=t,this.attrs=n};j.prototype.addToSet=function(t){for(var n,r=!1,o=0;o<t.length;o++){var i=t[o];if(this.eq(i))return t;if(this.type.excludes(i.type))n||(n=t.slice(0,o));else{if(i.type.excludes(this.type))return t;!r&&i.type.rank>this.type.rank&&(n||(n=t.slice(0,o)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=t.slice()),r||n.push(this),n};j.prototype.removeFromSet=function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return t.slice(0,n).concat(t.slice(n+1));return t};j.prototype.isInSet=function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return!0;return!1};j.prototype.eq=function(t){return this==t||this.type==t.type&&Ao(this.attrs,t.attrs)};j.prototype.toJSON=function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return t};j.fromJSON=function(t,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");var r=t.marks[n.type];if(!r)throw new RangeError("There is no mark type "+n.type+" in this schema");return r.create(n.attrs)};j.sameSet=function(t,n){if(t==n)return!0;if(t.length!=n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].eq(n[r]))return!1;return!0};j.setFrom=function(t){if(!t||t.length==0)return j.none;if(t instanceof j)return[t];var n=t.slice();return n.sort(function(r,o){return r.type.rank-o.type.rank}),n};j.none=[];function Be(e){var t=Error.call(this,e);return t.__proto__=Be.prototype,t}Be.prototype=Object.create(Error.prototype);Be.prototype.constructor=Be;Be.prototype.name="ReplaceError";var _=function(t,n,r){this.content=t,this.openStart=n,this.openEnd=r},Ic={size:{configurable:!0}};Ic.size.get=function(){return this.content.size-this.openStart-this.openEnd};_.prototype.insertAt=function(t,n){var r=Dc(this.content,t+this.openStart,n,null);return r&&new _(r,this.openStart,this.openEnd)};_.prototype.removeBetween=function(t,n){return new _(Pc(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)};_.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd};_.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"};_.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t};_.fromJSON=function(t,n){if(!n)return _.empty;var r=n.openStart||0,o=n.openEnd||0;if(typeof r!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new _(k.fromJSON(t,n.content),r,o)};_.maxOpen=function(t,n){n===void 0&&(n=!0);for(var r=0,o=0,i=t.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(var s=t.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)o++;return new _(t,r,o)};Object.defineProperties(_.prototype,Ic);function Pc(e,t,n){var r=e.findIndex(t),o=r.index,i=r.offset,s=e.maybeChild(o),a=e.findIndex(n),c=a.index,l=a.offset;if(i==t||s.isText){if(l!=n&&!e.child(c).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return e.replaceChild(o,s.copy(Pc(s.content,t-i-1,n-i-1)))}function Dc(e,t,n,r){var o=e.findIndex(t),i=o.index,s=o.offset,a=e.maybeChild(i);if(s==t||a.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));var c=Dc(a.content,t-s-1,n);return c&&e.replaceChild(i,a.copy(c))}_.empty=new _(k.empty,0,0);function dd(e,t,n){if(n.openStart>e.depth)throw new Be("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new Be("Inconsistent open depths");return Rc(e,t,n,0)}function Rc(e,t,n,r){var o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){var s=Rc(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&e.depth==r&&t.depth==r){var a=e.parent,c=a.content;return In(a,c.cut(0,e.parentOffset).append(n.content).append(c.cut(t.parentOffset)))}else{var l=vd(n,e),u=l.start,f=l.end;return In(i,Lc(e,u,f,t,r))}else return In(i,No(e,t,r))}function Bc(e,t){if(!t.type.compatibleContent(e.type))throw new Be("Cannot join "+t.type.name+" onto "+e.type.name)}function ji(e,t,n){var r=e.node(n);return Bc(r,t.node(n)),r}function Nn(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function _r(e,t,n,r){var o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(Nn(e.nodeAfter,r),i++));for(var a=i;a<s;a++)Nn(o.child(a),r);t&&t.depth==n&&t.textOffset&&Nn(t.nodeBefore,r)}function In(e,t){if(!e.type.validContent(t))throw new Be("Invalid content for node "+e.type.name);return e.copy(t)}function Lc(e,t,n,r,o){var i=e.depth>o&&ji(e,t,o+1),s=r.depth>o&&ji(n,r,o+1),a=[];return _r(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(Bc(i,s),Nn(In(i,Lc(e,t,n,r,o+1)),a)):(i&&Nn(In(i,No(e,t,o+1)),a),_r(t,n,o,a),s&&Nn(In(s,No(n,r,o+1)),a)),_r(r,null,o,a),new k(a)}function No(e,t,n){var r=[];if(_r(null,e,n,r),e.depth>n){var o=ji(e,t,n+1);Nn(In(o,No(e,t,n+1)),r)}return _r(t,null,n,r),new k(r)}function vd(e,t){for(var n=t.depth-e.openStart,r=t.node(n),o=r.copy(e.content),i=n-1;i>=0;i--)o=t.node(i).copy(k.from(o));return{start:o.resolveNoCache(e.openStart+n),end:o.resolveNoCache(o.content.size-e.openEnd-n)}}var st=function(t,n,r){this.pos=t,this.path=n,this.depth=n.length/3-1,this.parentOffset=r},Qn={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};st.prototype.resolveDepth=function(t){return t==null?this.depth:t<0?this.depth+t:t};Qn.parent.get=function(){return this.node(this.depth)};Qn.doc.get=function(){return this.node(0)};st.prototype.node=function(t){return this.path[this.resolveDepth(t)*3]};st.prototype.index=function(t){return this.path[this.resolveDepth(t)*3+1]};st.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)};st.prototype.start=function(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1};st.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size};st.prototype.before=function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]};st.prototype.after=function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize};Qn.textOffset.get=function(){return this.pos-this.path[this.path.length-1]};Qn.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r};Qn.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)};st.prototype.posAtIndex=function(t,n){n=this.resolveDepth(n);for(var r=this.path[n*3],o=n==0?0:this.path[n*3-1]+1,i=0;i<t;i++)o+=r.child(i).nodeSize;return o};st.prototype.marks=function(){var t=this.parent,n=this.index();if(t.content.size==0)return j.none;if(this.textOffset)return t.child(n).marks;var r=t.maybeChild(n-1),o=t.maybeChild(n);if(!r){var i=r;r=o,o=i}for(var s=r.marks,a=0;a<s.length;a++)s[a].type.spec.inclusive===!1&&(!o||!s[a].isInSet(o.marks))&&(s=s[a--].removeFromSet(s));return s};st.prototype.marksAcross=function(t){var n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;for(var r=n.marks,o=t.parent.maybeChild(t.index()),i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!o||!r[i].isInSet(o.marks))&&(r=r[i--].removeFromSet(r));return r};st.prototype.sharedDepth=function(t){for(var n=this.depth;n>0;n--)if(this.start(n)<=t&&this.end(n)>=t)return n;return 0};st.prototype.blockRange=function(t,n){if(t===void 0&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!n||n(this.node(r))))return new Er(this,t,r)};st.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset};st.prototype.max=function(t){return t.pos>this.pos?t:this};st.prototype.min=function(t){return t.pos<this.pos?t:this};st.prototype.toString=function(){for(var t="",n=1;n<=this.depth;n++)t+=(t?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return t+":"+this.parentOffset};st.resolve=function(t,n){if(!(n>=0&&n<=t.content.size))throw new RangeError("Position "+n+" out of range");for(var r=[],o=0,i=n,s=t;;){var a=s.content.findIndex(i),c=a.index,l=a.offset,u=i-l;if(r.push(s,c,o+l),!u||(s=s.child(c),s.isText))break;i=u-1,o+=l+1}return new st(n,r,i)};st.resolveCached=function(t,n){for(var r=0;r<Ji.length;r++){var o=Ji[r];if(o.pos==n&&o.doc==t)return o}var i=Ji[Wi]=st.resolve(t,n);return Wi=(Wi+1)%md,i};Object.defineProperties(st.prototype,Qn);var Ji=[],Wi=0,md=12,Er=function(t,n,r){this.$from=t,this.$to=n,this.depth=r},tr={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};tr.start.get=function(){return this.$from.before(this.depth+1)};tr.end.get=function(){return this.$to.after(this.depth+1)};tr.parent.get=function(){return this.$from.node(this.depth)};tr.startIndex.get=function(){return this.$from.index(this.depth)};tr.endIndex.get=function(){return this.$to.indexAfter(this.depth)};Object.defineProperties(Er.prototype,tr);var gd=Object.create(null),J=function(t,n,r,o){this.type=t,this.attrs=n,this.content=r||k.empty,this.marks=o||j.none},se={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};se.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size};se.childCount.get=function(){return this.content.childCount};J.prototype.child=function(t){return this.content.child(t)};J.prototype.maybeChild=function(t){return this.content.maybeChild(t)};J.prototype.forEach=function(t){this.content.forEach(t)};J.prototype.nodesBetween=function(t,n,r,o){o===void 0&&(o=0),this.content.nodesBetween(t,n,r,o,this)};J.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)};se.textContent.get=function(){return this.textBetween(0,this.content.size,"")};J.prototype.textBetween=function(t,n,r,o){return this.content.textBetween(t,n,r,o)};se.firstChild.get=function(){return this.content.firstChild};se.lastChild.get=function(){return this.content.lastChild};J.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)};J.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)};J.prototype.hasMarkup=function(t,n,r){return this.type==t&&Ao(this.attrs,n||t.defaultAttrs||gd)&&j.sameSet(this.marks,r||j.none)};J.prototype.copy=function(t){return t===void 0&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)};J.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)};J.prototype.cut=function(t,n){return t==0&&n==this.content.size?this:this.copy(this.content.cut(t,n))};J.prototype.slice=function(t,n,r){if(n===void 0&&(n=this.content.size),r===void 0&&(r=!1),t==n)return _.empty;var o=this.resolve(t),i=this.resolve(n),s=r?0:o.sharedDepth(n),a=o.start(s),c=o.node(s),l=c.content.cut(o.pos-a,i.pos-a);return new _(l,o.depth-s,i.depth-s)};J.prototype.replace=function(t,n,r){return dd(this.resolve(t),this.resolve(n),r)};J.prototype.nodeAt=function(t){for(var n=this;;){var r=n.content.findIndex(t),o=r.index,i=r.offset;if(n=n.maybeChild(o),!n)return null;if(i==t||n.isText)return n;t-=i+1}};J.prototype.childAfter=function(t){var n=this.content.findIndex(t),r=n.index,o=n.offset;return{node:this.content.maybeChild(r),index:r,offset:o}};J.prototype.childBefore=function(t){if(t==0)return{node:null,index:0,offset:0};var n=this.content.findIndex(t),r=n.index,o=n.offset;if(o<t)return{node:this.content.child(r),index:r,offset:o};var i=this.content.child(r-1);return{node:i,index:r-1,offset:o-i.nodeSize}};J.prototype.resolve=function(t){return st.resolveCached(this,t)};J.prototype.resolveNoCache=function(t){return st.resolve(this,t)};J.prototype.rangeHasMark=function(t,n,r){var o=!1;return n>t&&this.nodesBetween(t,n,function(i){return r.isInSet(i.marks)&&(o=!0),!o}),o};se.isBlock.get=function(){return this.type.isBlock};se.isTextblock.get=function(){return this.type.isTextblock};se.inlineContent.get=function(){return this.type.inlineContent};se.isInline.get=function(){return this.type.isInline};se.isText.get=function(){return this.type.isText};se.isLeaf.get=function(){return this.type.isLeaf};se.isAtom.get=function(){return this.type.isAtom};J.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),zc(this.marks,t)};J.prototype.contentMatchAt=function(t){var n=this.type.contentMatch.matchFragment(this.content,0,t);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n};J.prototype.canReplace=function(t,n,r,o,i){r===void 0&&(r=k.empty),o===void 0&&(o=0),i===void 0&&(i=r.childCount);var s=this.contentMatchAt(t).matchFragment(r,o,i),a=s&&s.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(var c=o;c<i;c++)if(!this.type.allowsMarks(r.child(c).marks))return!1;return!0};J.prototype.canReplaceWith=function(t,n,r,o){if(o&&!this.type.allowsMarks(o))return!1;var i=this.contentMatchAt(t).matchType(r),s=i&&i.matchFragment(this.content,n);return s?s.validEnd:!1};J.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)};J.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var t=j.none,n=0;n<this.marks.length;n++)t=this.marks[n].addToSet(t);if(!j.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map(function(r){return r.type.name}));this.content.forEach(function(r){return r.check()})};J.prototype.toJSON=function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(function(r){return r.toJSON()})),t};J.fromJSON=function(t,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");var r=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(t.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(n.text,r)}var o=k.fromJSON(t,n.content);return t.nodeType(n.type).create(n.attrs,o,r)};Object.defineProperties(J.prototype,se);var yd=function(e){function t(r,o,i,s){if(e.call(this,r,o,null,s),!i)throw new RangeError("Empty text nodes are not allowed");this.text=i}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):zc(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},t.prototype.textBetween=function(o,i){return this.text.slice(o,i)},n.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(o){return o==this.marks?this:new t(this.type,this.attrs,this.text,o)},t.prototype.withText=function(o){return o==this.text?this:new t(this.type,this.attrs,o,this.marks)},t.prototype.cut=function(o,i){return o===void 0&&(o=0),i===void 0&&(i=this.text.length),o==0&&i==this.text.length?this:this.withText(this.text.slice(o,i))},t.prototype.eq=function(o){return this.sameMarkup(o)&&this.text==o.text},t.prototype.toJSON=function(){var o=e.prototype.toJSON.call(this);return o.text=this.text,o},Object.defineProperties(t.prototype,n),t}(J);function zc(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var Lt=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},Io={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Lt.parse=function(t,n){var r=new Po(t,n);if(r.next==null)return Lt.empty;var o=$c(r);r.next&&r.err("Unexpected trailing text");var i=Md(xd(o));return Cd(i,r),i};Lt.prototype.matchType=function(t){for(var n=0;n<this.next.length;n+=2)if(this.next[n]==t)return this.next[n+1];return null};Lt.prototype.matchFragment=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=t.childCount);for(var o=this,i=n;o&&i<r;i++)o=o.matchType(t.child(i).type);return o};Io.inlineContent.get=function(){var e=this.next[0];return e?e.isInline:!1};Io.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}};Lt.prototype.compatible=function(t){for(var n=0;n<this.next.length;n+=2)for(var r=0;r<t.next.length;r+=2)if(this.next[n]==t.next[r])return!0;return!1};Lt.prototype.fillBefore=function(t,n,r){n===void 0&&(n=!1),r===void 0&&(r=0);var o=[this];function i(s,a){var c=s.matchFragment(t,r);if(c&&(!n||c.validEnd))return k.from(a.map(function(h){return h.createAndFill()}));for(var l=0;l<s.next.length;l+=2){var u=s.next[l],f=s.next[l+1];if(!(u.isText||u.hasRequiredAttrs())&&o.indexOf(f)==-1){o.push(f);var p=i(f,a.concat(u));if(p)return p}}}return i(this,[])};Lt.prototype.findWrapping=function(t){for(var n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];var r=this.computeWrapping(t);return this.wrapCache.push(t,r),r};Lt.prototype.computeWrapping=function(t){for(var n=Object.create(null),r=[{match:this,type:null,via:null}];r.length;){var o=r.shift(),i=o.match;if(i.matchType(t)){for(var s=[],a=o;a.type;a=a.via)s.push(a.type);return s.reverse()}for(var c=0;c<i.next.length;c+=2){var l=i.next[c];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!o.type||i.next[c+1].validEnd)&&(r.push({match:l.contentMatch,type:l,via:o}),n[l.name]=!0)}}};Io.edgeCount.get=function(){return this.next.length>>1};Lt.prototype.edge=function(t){var n=t<<1;if(n>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[n],next:this.next[n+1]}};Lt.prototype.toString=function(){var t=[];function n(r){t.push(r);for(var o=1;o<r.next.length;o+=2)t.indexOf(r.next[o])==-1&&n(r.next[o])}return n(this),t.map(function(r,o){for(var i=o+(r.validEnd?"*":" ")+" ",s=0;s<r.next.length;s+=2)i+=(s?", ":"")+r.next[s].name+"->"+t.indexOf(r.next[s+1]);return i}).join(`
`)};Object.defineProperties(Lt.prototype,Io);Lt.empty=new Lt(!0);var Po=function(t,n){this.string=t,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()},Fc={next:{configurable:!0}};Fc.next.get=function(){return this.tokens[this.pos]};Po.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)};Po.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")};Object.defineProperties(Po.prototype,Fc);function $c(e){var t=[];do t.push(bd(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function bd(e){var t=[];do t.push(wd(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function wd(e){for(var t=Od(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=kd(e,t);else break;return t}function Vc(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function kd(e,t){var n=Vc(e),r=n;return e.eat(",")&&(e.next!="}"?r=Vc(e):r=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Sd(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(t)>-1&&o.push(s)}return o.length==0&&e.err("No node type or group '"+t+"' found"),o}function Od(e){if(e.eat("(")){var t=$c(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{var n=Sd(e,e.next).map(function(r){return e.inline==null?e.inline=r.isInline:e.inline!=r.isInline&&e.err("Mixing inline and block content"),{type:"name",value:r}});return e.pos++,n.length==1?n[0]:{type:"choice",exprs:n}}}function xd(e){var t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(s,a,c){var l={term:c,to:a};return t[s].push(l),l}function o(s,a){s.forEach(function(c){return c.to=a})}function i(s,a){if(s.type=="choice")return s.exprs.reduce(function(b,y){return b.concat(i(y,a))},[]);if(s.type=="seq")for(var c=0;;c++){var l=i(s.exprs[c],a);if(c==s.exprs.length-1)return l;o(l,a=n())}else if(s.type=="star"){var u=n();return r(a,u),o(i(s.expr,u),u),[r(u)]}else if(s.type=="plus"){var f=n();return o(i(s.expr,a),f),o(i(s.expr,f),f),[r(f)]}else{if(s.type=="opt")return[r(a)].concat(i(s.expr,a));if(s.type=="range"){for(var p=a,h=0;h<s.min;h++){var d=n();o(i(s.expr,p),d),p=d}if(s.max==-1)o(i(s.expr,p),p);else for(var v=s.min;v<s.max;v++){var g=n();r(p,g),o(i(s.expr,p),g),p=g}return[r(p)]}else if(s.type=="name")return[r(a,null,s.value)]}}}function Hc(e,t){return t-e}function jc(e,t){var n=[];return r(t),n.sort(Hc);function r(o){var i=e[o];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(o);for(var s=0;s<i.length;s++){var a=i[s],c=a.term,l=a.to;!c&&n.indexOf(l)==-1&&r(l)}}}function Md(e){var t=Object.create(null);return n(jc(e,0));function n(r){var o=[];r.forEach(function(c){e[c].forEach(function(l){var u=l.term,f=l.to;if(!!u){var p=o.indexOf(u),h=p>-1&&o[p+1];jc(e,f).forEach(function(d){h||o.push(u,h=[]),h.indexOf(d)==-1&&h.push(d)})}})});for(var i=t[r.join(",")]=new Lt(r.indexOf(e.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Hc);i.next.push(o[s],t[a.join(",")]||n(a))}return i}}function Cd(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),i&&!(c.isText||c.hasRequiredAttrs())&&(i=!1),r.indexOf(l)==-1&&r.push(l)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Jc(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function Wc(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(o===void 0){var i=e[r];if(i.hasDefault)o=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=o}return n}function qc(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new Kc(e[n]);return t}var Wt=function(t,n,r){this.name=t,this.schema=n,this.spec=r,this.groups=r.group?r.group.split(" "):[],this.attrs=qc(r.attrs),this.defaultAttrs=Jc(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"},Ar={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Ar.isInline.get=function(){return!this.isBlock};Ar.isTextblock.get=function(){return this.isBlock&&this.inlineContent};Ar.isLeaf.get=function(){return this.contentMatch==Lt.empty};Ar.isAtom.get=function(){return this.isLeaf||this.spec.atom};Wt.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1};Wt.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)};Wt.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Wc(this.attrs,t)};Wt.prototype.create=function(t,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new J(this,this.computeAttrs(t),k.from(n),j.setFrom(r))};Wt.prototype.createChecked=function(t,n,r){if(n=k.from(n),!this.validContent(n))throw new RangeError("Invalid content for node "+this.name);return new J(this,this.computeAttrs(t),n,j.setFrom(r))};Wt.prototype.createAndFill=function(t,n,r){if(t=this.computeAttrs(t),n=k.from(n),n.size){var o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}var i=this.contentMatch.matchFragment(n).fillBefore(k.empty,!0);return i?new J(this,t,n.append(i),j.setFrom(r)):null};Wt.prototype.validContent=function(t){var n=this.contentMatch.matchFragment(t);if(!n||!n.validEnd)return!1;for(var r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0};Wt.prototype.allowsMarkType=function(t){return this.markSet==null||this.markSet.indexOf(t)>-1};Wt.prototype.allowsMarks=function(t){if(this.markSet==null)return!0;for(var n=0;n<t.length;n++)if(!this.allowsMarkType(t[n].type))return!1;return!0};Wt.prototype.allowedMarks=function(t){if(this.markSet==null)return t;for(var n,r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?n&&n.push(t[r]):n||(n=t.slice(0,r));return n?n.length?n:j.empty:t};Wt.compile=function(t,n){var r=Object.create(null);t.forEach(function(s,a){return r[s]=new Wt(s,n,a)});var o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(var i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r};Object.defineProperties(Wt.prototype,Ar);var Kc=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},Uc={isRequired:{configurable:!0}};Uc.isRequired.get=function(){return!this.hasDefault};Object.defineProperties(Kc.prototype,Uc);var sn=function(t,n,r,o){this.name=t,this.schema=r,this.spec=o,this.attrs=qc(o.attrs),this.rank=n,this.excluded=null;var i=Jc(this.attrs);this.instance=i&&new j(this,i)};sn.prototype.create=function(t){return!t&&this.instance?this.instance:new j(this,Wc(this.attrs,t))};sn.compile=function(t,n){var r=Object.create(null),o=0;return t.forEach(function(i,s){return r[i]=new sn(i,o++,n,s)}),r};sn.prototype.removeFromSet=function(t){for(var n=0;n<t.length;n++)t[n].type==this&&(t=t.slice(0,n).concat(t.slice(n+1)),n--);return t};sn.prototype.isInSet=function(t){for(var n=0;n<t.length;n++)if(t[n].type==this)return t[n]};sn.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var Pn=function(t){this.spec={};for(var n in t)this.spec[n]=t[n];this.spec.nodes=Ec.from(t.nodes),this.spec.marks=Ec.from(t.marks),this.nodes=Wt.compile(this.spec.nodes,this),this.marks=sn.compile(this.spec.marks,this);var r=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=r[s]||(r[s]=Lt.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet=a=="_"?null:a?Gc(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=u==null?[l]:u==""?[]:Gc(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};Pn.prototype.node=function(t,n,r,o){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof Wt){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(n,r,o)};Pn.prototype.text=function(t,n){var r=this.nodes.text;return new yd(r,r.defaultAttrs,t,j.setFrom(n))};Pn.prototype.mark=function(t,n){return typeof t=="string"&&(t=this.marks[t]),t.create(n)};Pn.prototype.nodeFromJSON=function(t){return J.fromJSON(this,t)};Pn.prototype.markFromJSON=function(t){return j.fromJSON(this,t)};Pn.prototype.nodeType=function(t){var n=this.nodes[t];if(!n)throw new RangeError("Unknown node type: "+t);return n};function Gc(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(var a in e.marks){var c=e.marks[a];(o=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}var Me=function(t,n){var r=this;this.schema=t,this.rules=n,this.tags=[],this.styles=[],n.forEach(function(o){o.tag?r.tags.push(o):o.style&&r.styles.push(o)}),this.normalizeLists=!this.tags.some(function(o){if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;var i=t.nodes[o.node];return i.contentMatch.matchType(i)})};Me.prototype.parse=function(t,n){n===void 0&&(n={});var r=new ot(this,n,!1);return r.addAll(t,null,n.from,n.to),r.finish()};Me.prototype.parseSlice=function(t,n){n===void 0&&(n={});var r=new ot(this,n,!0);return r.addAll(t,null,n.from,n.to),_.maxOpen(r.finish())};Me.prototype.matchTag=function(t,n,r){for(var o=r?this.tags.indexOf(r)+1:0;o<this.tags.length;o++){var i=this.tags[o];if(Ed(t,i.tag)&&(i.namespace===void 0||t.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){var s=i.getAttrs(t);if(s===!1)continue;i.attrs=s}return i}}};Me.prototype.matchStyle=function(t,n,r,o){for(var i=o?this.styles.indexOf(o)+1:0;i<this.styles.length;i++){var s=this.styles[i];if(!(s.style.indexOf(t)!=0||s.context&&!r.matchesContext(s.context)||s.style.length>t.length&&(s.style.charCodeAt(t.length)!=61||s.style.slice(t.length+1)!=n))){if(s.getAttrs){var a=s.getAttrs(n);if(a===!1)continue;s.attrs=a}return s}}};Me.schemaRules=function(t){var n=[];function r(c){for(var l=c.priority==null?50:c.priority,u=0;u<n.length;u++){var f=n[u],p=f.priority==null?50:f.priority;if(p<l)break}n.splice(u,0,c)}var o=function(c){var l=t.marks[c].spec.parseDOM;l&&l.forEach(function(u){r(u=Zc(u)),u.mark=c})};for(var i in t.marks)o(i);var s=function(c){var l=t.nodes[a].spec.parseDOM;l&&l.forEach(function(u){r(u=Zc(u)),u.node=a})};for(var a in t.nodes)s();return n};Me.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Me(t,Me.schemaRules(t)))};var qi={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Td={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Yc={ol:!0,ul:!0},Ki=1,Ui=2,Nr=4;function Xc(e){return(e?Ki:0)|(e==="full"?Ui:0)}var Ge=function(t,n,r,o,i,s,a){this.type=t,this.attrs=n,this.solid=i,this.match=s||(a&Nr?null:t.contentMatch),this.options=a,this.content=[],this.marks=r,this.activeMarks=j.none,this.pendingMarks=o,this.stashMarks=[]};Ge.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var n=this.type.contentMatch.fillBefore(k.from(t));if(n)this.match=this.type.contentMatch.matchFragment(n);else{var r=this.type.contentMatch,o;return(o=r.findWrapping(t.type))?(this.match=r,o):null}}return this.match.findWrapping(t.type)};Ge.prototype.finish=function(t){if(!(this.options&Ki)){var n=this.content[this.content.length-1],r;n&&n.isText&&(r=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-r[0].length)))}var o=k.from(this.content);return!t&&this.match&&(o=o.append(this.match.fillBefore(k.empty,!0))),this.type?this.type.create(this.attrs,o,this.marks):o};Ge.prototype.popFromStashMark=function(t){for(var n=this.stashMarks.length-1;n>=0;n--)if(t.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]};Ge.prototype.applyPending=function(t){for(var n=0,r=this.pendingMarks;n<r.length;n++){var o=r[n];(this.type?this.type.allowsMarkType(o.type):Nd(o.type,t))&&!o.isInSet(this.activeMarks)&&(this.activeMarks=o.addToSet(this.activeMarks),this.pendingMarks=o.removeFromSet(this.pendingMarks))}};Ge.prototype.inlineContext=function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!qi.hasOwnProperty(t.parentNode.nodeName.toLowerCase())};var ot=function(t,n,r){this.parser=t,this.options=n,this.isOpen=r;var o=n.topNode,i,s=Xc(n.preserveWhitespace)|(r?Nr:0);o?i=new Ge(o.type,o.attrs,j.none,j.none,!0,n.topMatch||o.type.contentMatch,s):r?i=new Ge(null,null,j.none,j.none,!0,null,s):i=new Ge(t.schema.topNodeType,null,j.none,j.none,!0,null,s),this.nodes=[i],this.open=0,this.find=n.findPositions,this.needsBlock=!1},Gi={top:{configurable:!0},currentPos:{configurable:!0}};Gi.top.get=function(){return this.nodes[this.open]};ot.prototype.addDOM=function(t){if(t.nodeType==3)this.addTextNode(t);else if(t.nodeType==1){var n=t.getAttribute("style"),r=n?this.readStyles(Ad(n)):null,o=this.top;if(r!=null)for(var i=0;i<r.length;i++)this.addPendingMark(r[i]);if(this.addElement(t),r!=null)for(var s=0;s<r.length;s++)this.removePendingMark(r[s],o)}};ot.prototype.addTextNode=function(t){var n=t.nodeValue,r=this.top;if(r.options&Ui||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(r.options&Ki)r.options&Ui?n=n.replace(/\r\n?/g,`
`):n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){var o=r.content[r.content.length-1],i=t.previousSibling;(!o||i&&i.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(t)}else this.findInside(t)};ot.prototype.addElement=function(t,n){var r=t.nodeName.toLowerCase(),o;Yc.hasOwnProperty(r)&&this.parser.normalizeLists&&_d(t);var i=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(o=this.parser.matchTag(t,this,n));if(i?i.ignore:Td.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(t=i.skip);var s,a=this.top,c=this.needsBlock;if(qi.hasOwnProperty(r))s=!0,a.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t);return}this.addAll(t),s&&this.sync(a),this.needsBlock=c}else this.addElementByRule(t,i,i.consuming===!1?o:null)};ot.prototype.leafFallback=function(t){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`))};ot.prototype.ignoreFallback=function(t){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))};ot.prototype.readStyles=function(t){var n=j.none;t:for(var r=0;r<t.length;r+=2)for(var o=null;;){var i=this.parser.matchStyle(t[r],t[r+1],this,o);if(!i)continue t;if(i.ignore)return null;if(n=this.parser.schema.marks[i.mark].create(i.attrs).addToSet(n),i.consuming===!1)o=i;else break}return n};ot.prototype.addElementByRule=function(t,n,r){var o=this,i,s,a,c;n.node?(s=this.parser.schema.nodes[n.node],s.isLeaf?this.insertNode(s.create(n.attrs))||this.leafFallback(t):i=this.enter(s,n.attrs,n.preserveWhitespace)):(a=this.parser.schema.marks[n.mark],c=a.create(n.attrs),this.addPendingMark(c));var l=this.top;if(s&&s.isLeaf)this.findInside(t);else if(r)this.addElement(t,r);else if(n.getContent)this.findInside(t),n.getContent(t,this.parser.schema).forEach(function(f){return o.insertNode(f)});else{var u=n.contentElement;typeof u=="string"?u=t.querySelector(u):typeof u=="function"&&(u=u(t)),u||(u=t),this.findAround(t,u,!0),this.addAll(u,i)}i&&(this.sync(l),this.open--),c&&this.removePendingMark(c,l)};ot.prototype.addAll=function(t,n,r,o){for(var i=r||0,s=r?t.childNodes[r]:t.firstChild,a=o==null?null:t.childNodes[o];s!=a;s=s.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(s),n&&qi.hasOwnProperty(s.nodeName.toLowerCase())&&this.sync(n);this.findAtPoint(t,i)};ot.prototype.findPlace=function(t){for(var n,r,o=this.open;o>=0;o--){var i=this.nodes[o],s=i.findWrapping(t);if(s&&(!n||n.length>s.length)&&(n=s,r=i,!s.length)||i.solid)break}if(!n)return!1;this.sync(r);for(var a=0;a<n.length;a++)this.enterInner(n[a],null,!1);return!0};ot.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(t)){this.closeExtra();var r=this.top;r.applyPending(t.type),r.match&&(r.match=r.match.matchType(t.type));for(var o=r.activeMarks,i=0;i<t.marks.length;i++)(!r.type||r.type.allowsMarkType(t.marks[i].type))&&(o=t.marks[i].addToSet(o));return r.content.push(t.mark(o)),!0}return!1};ot.prototype.enter=function(t,n,r){var o=this.findPlace(t.create(n));return o&&this.enterInner(t,n,!0,r),o};ot.prototype.enterInner=function(t,n,r,o){this.closeExtra();var i=this.top;i.applyPending(t),i.match=i.match&&i.match.matchType(t,n);var s=o==null?i.options&~Nr:Xc(o);i.options&Nr&&i.content.length==0&&(s|=Nr),this.nodes.push(new Ge(t,n,i.activeMarks,i.pendingMarks,r,null,s)),this.open++};ot.prototype.closeExtra=function(t){var n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(t));this.nodes.length=this.open+1}};ot.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)};ot.prototype.sync=function(t){for(var n=this.open;n>=0;n--)if(this.nodes[n]==t){this.open=n;return}};Gi.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e};ot.prototype.findAtPoint=function(t,n){if(this.find)for(var r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)};ot.prototype.findInside=function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].pos==null&&t.nodeType==1&&t.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)};ot.prototype.findAround=function(t,n,r){if(t!=n&&this.find){for(var o=0;o<this.find.length;o++)if(this.find[o].pos==null&&t.nodeType==1&&t.contains(this.find[o].node)){var i=n.compareDocumentPosition(this.find[o].node);i&(r?2:4)&&(this.find[o].pos=this.currentPos)}}};ot.prototype.findInText=function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&(this.find[n].pos=this.currentPos-(t.nodeValue.length-this.find[n].offset))};ot.prototype.matchesContext=function(t){var n=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var r=t.split("/"),o=this.options.context,i=!this.isOpen&&(!o||o.parent.type==this.nodes[0].type),s=-(o?o.depth+1:0)+(i?0:1),a=function(c,l){for(;c>=0;c--){var u=r[c];if(u==""){if(c==r.length-1||c==0)continue;for(;l>=s;l--)if(a(c-1,l))return!0;return!1}else{var f=l>0||l==0&&i?n.nodes[l].type:o&&l>=s?o.node(l-s).type:null;if(!f||f.name!=u&&f.groups.indexOf(u)==-1)return!1;l--}}return!0};return a(r.length-1,this.open)};ot.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var n=t.depth;n>=0;n--){var r=t.node(n).contentMatchAt(t.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(var o in this.parser.schema.nodes){var i=this.parser.schema.nodes[o];if(i.isTextblock&&i.defaultAttrs)return i}};ot.prototype.addPendingMark=function(t){var n=Id(t,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)};ot.prototype.removePendingMark=function(t,n){for(var r=this.open;r>=0;r--){var o=this.nodes[r],i=o.pendingMarks.lastIndexOf(t);if(i>-1)o.pendingMarks=t.removeFromSet(o.pendingMarks);else{o.activeMarks=t.removeFromSet(o.activeMarks);var s=o.popFromStashMark(t);s&&o.type&&o.type.allowsMarkType(s.type)&&(o.activeMarks=s.addToSet(o.activeMarks))}if(o==n)break}};Object.defineProperties(ot.prototype,Gi);function _d(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&Yc.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):r=="li"?n=t:r&&(n=null)}}function Ed(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Ad(e){for(var t=/\s*([\w-]+)\s*:\s*([^;]+)/g,n,r=[];n=t.exec(e);)r.push(n[1],n[2].trim());return r}function Zc(e){var t={};for(var n in e)t[n]=e[n];return t}function Nd(e,t){var n=t.schema.nodes,r=function(s){var a=n[s];if(!!a.allowsMarkType(e)){var c=[],l=function(u){c.push(u);for(var f=0;f<u.edgeCount;f++){var p=u.edge(f),h=p.type,d=p.next;if(h==t||c.indexOf(d)<0&&l(d))return!0}};if(l(a.contentMatch))return{v:!0}}};for(var o in n){var i=r(o);if(i)return i.v}}function Id(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}var xt=function(t,n){this.nodes=t||{},this.marks=n||{}};xt.prototype.serializeFragment=function(t,n,r){var o=this;n===void 0&&(n={}),r||(r=Yi(n).createDocumentFragment());var i=r,s=null;return t.forEach(function(a){if(s||a.marks.length){s||(s=[]);for(var c=0,l=0;c<s.length&&l<a.marks.length;){var u=a.marks[l];if(!o.marks[u.type.name]){l++;continue}if(!u.eq(s[c])||u.type.spec.spanning===!1)break;c+=2,l++}for(;c<s.length;)i=s.pop(),s.pop();for(;l<a.marks.length;){var f=a.marks[l++],p=o.serializeMark(f,a.isInline,n);p&&(s.push(f,i),i.appendChild(p.dom),i=p.contentDOM||p.dom)}}i.appendChild(o.serializeNodeInner(a,n))}),r};xt.prototype.serializeNodeInner=function(t,n){n===void 0&&(n={});var r=xt.renderSpec(Yi(n),this.nodes[t.type.name](t)),o=r.dom,i=r.contentDOM;if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");n.onContent?n.onContent(t,i,n):this.serializeFragment(t.content,n,i)}return o};xt.prototype.serializeNode=function(t,n){n===void 0&&(n={});for(var r=this.serializeNodeInner(t,n),o=t.marks.length-1;o>=0;o--){var i=this.serializeMark(t.marks[o],t.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r};xt.prototype.serializeMark=function(t,n,r){r===void 0&&(r={});var o=this.marks[t.type.name];return o&&xt.renderSpec(Yi(r),o(t,n))};xt.renderSpec=function(t,n,r){if(r===void 0&&(r=null),typeof n=="string")return{dom:t.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;var o=n[0],i=o.indexOf(" ");i>0&&(r=o.slice(0,i),o=o.slice(i+1));var s=null,a=r?t.createElementNS(r,o):t.createElement(o),c=n[1],l=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){l=2;for(var u in c)if(c[u]!=null){var f=u.indexOf(" ");f>0?a.setAttributeNS(u.slice(0,f),u.slice(f+1),c[u]):a.setAttribute(u,c[u])}}for(var p=l;p<n.length;p++){var h=n[p];if(h===0){if(p<n.length-1||p>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{var d=xt.renderSpec(t,h,r),v=d.dom,g=d.contentDOM;if(a.appendChild(v),g){if(s)throw new RangeError("Multiple content holes");s=g}}}return{dom:a,contentDOM:s}};xt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new xt(this.nodesFromSchema(t),this.marksFromSchema(t)))};xt.nodesFromSchema=function(t){var n=Qc(t.nodes);return n.text||(n.text=function(r){return r.text}),n};xt.marksFromSchema=function(t){return Qc(t.marks)};function Qc(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Yi(e){return e.document||window.document}var tl=65535,el=Math.pow(2,16);function Pd(e,t){return e+t*el}function nl(e){return e&tl}function Dd(e){return(e-(e&tl))/el}var Xi=function(t,n,r){n===void 0&&(n=!1),r===void 0&&(r=null),this.pos=t,this.deleted=n,this.recover=r},Mt=function(t,n){n===void 0&&(n=!1),this.ranges=t,this.inverted=n};Mt.prototype.recover=function(t){var n=0,r=nl(t);if(!this.inverted)for(var o=0;o<r;o++)n+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[r*3]+n+Dd(t)};Mt.prototype.mapResult=function(t,n){return n===void 0&&(n=1),this._map(t,n,!1)};Mt.prototype.map=function(t,n){return n===void 0&&(n=1),this._map(t,n,!0)};Mt.prototype._map=function(t,n,r){for(var o=0,i=this.inverted?2:1,s=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var c=this.ranges[a]-(this.inverted?o:0);if(c>t)break;var l=this.ranges[a+i],u=this.ranges[a+s],f=c+l;if(t<=f){var p=l?t==c?-1:t==f?1:n:n,h=c+o+(p<0?0:u);if(r)return h;var d=t==(n<0?c:f)?null:Pd(a/3,t-c);return new Xi(h,n<0?t!=c:t!=f,d)}o+=u-l}return r?t+o:new Xi(t+o)};Mt.prototype.touches=function(t,n){for(var r=0,o=nl(n),i=this.inverted?2:1,s=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var c=this.ranges[a]-(this.inverted?r:0);if(c>t)break;var l=this.ranges[a+i],u=c+l;if(t<=u&&a==o*3)return!0;r+=this.ranges[a+s]-l}return!1};Mt.prototype.forEach=function(t){for(var n=this.inverted?2:1,r=this.inverted?1:2,o=0,i=0;o<this.ranges.length;o+=3){var s=this.ranges[o],a=s-(this.inverted?i:0),c=s+(this.inverted?0:i),l=this.ranges[o+n],u=this.ranges[o+r];t(a,a+l,c,c+u),i+=u-l}};Mt.prototype.invert=function(){return new Mt(this.ranges,!this.inverted)};Mt.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)};Mt.offset=function(t){return t==0?Mt.empty:new Mt(t<0?[0,-t,0]:[0,0,t])};Mt.empty=new Mt([]);var zt=function(t,n,r,o){this.maps=t||[],this.from=r||0,this.to=o==null?this.maps.length:o,this.mirror=n};zt.prototype.slice=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=this.maps.length),new zt(this.maps,this.mirror,t,n)};zt.prototype.copy=function(){return new zt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)};zt.prototype.appendMap=function(t,n){this.to=this.maps.push(t),n!=null&&this.setMirror(this.maps.length-1,n)};zt.prototype.appendMapping=function(t){for(var n=0,r=this.maps.length;n<t.maps.length;n++){var o=t.getMirror(n);this.appendMap(t.maps[n],o!=null&&o<n?r+o:null)}};zt.prototype.getMirror=function(t){if(this.mirror){for(var n=0;n<this.mirror.length;n++)if(this.mirror[n]==t)return this.mirror[n+(n%2?-1:1)]}};zt.prototype.setMirror=function(t,n){this.mirror||(this.mirror=[]),this.mirror.push(t,n)};zt.prototype.appendMappingInverted=function(t){for(var n=t.maps.length-1,r=this.maps.length+t.maps.length;n>=0;n--){var o=t.getMirror(n);this.appendMap(t.maps[n].invert(),o!=null&&o>n?r-o-1:null)}};zt.prototype.invert=function(){var t=new zt;return t.appendMappingInverted(this),t};zt.prototype.map=function(t,n){if(n===void 0&&(n=1),this.mirror)return this._map(t,n,!0);for(var r=this.from;r<this.to;r++)t=this.maps[r].map(t,n);return t};zt.prototype.mapResult=function(t,n){return n===void 0&&(n=1),this._map(t,n,!1)};zt.prototype._map=function(t,n,r){for(var o=!1,i=this.from;i<this.to;i++){var s=this.maps[i],a=s.mapResult(t,n);if(a.recover!=null){var c=this.getMirror(i);if(c!=null&&c>i&&c<this.to){i=c,t=this.maps[c].recover(a.recover);continue}}a.deleted&&(o=!0),t=a.pos}return r?t:new Xi(t,o)};function er(e){var t=Error.call(this,e);return t.__proto__=er.prototype,t}er.prototype=Object.create(Error.prototype);er.prototype.constructor=er;er.prototype.name="TransformError";var ft=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new zt},Zi={before:{configurable:!0},docChanged:{configurable:!0}};Zi.before.get=function(){return this.docs.length?this.docs[0]:this.doc};ft.prototype.step=function(t){var n=this.maybeStep(t);if(n.failed)throw new er(n.failed);return this};ft.prototype.maybeStep=function(t){var n=t.apply(this.doc);return n.failed||this.addStep(t,n.doc),n};Zi.docChanged.get=function(){return this.steps.length>0};ft.prototype.addStep=function(t,n){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=n};Object.defineProperties(ft.prototype,Zi);function Do(){throw new Error("Override me")}var Qi=Object.create(null),Ft=function(){};Ft.prototype.apply=function(t){return Do()};Ft.prototype.getMap=function(){return Mt.empty};Ft.prototype.invert=function(t){return Do()};Ft.prototype.map=function(t){return Do()};Ft.prototype.merge=function(t){return null};Ft.prototype.toJSON=function(){return Do()};Ft.fromJSON=function(t,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");var r=Qi[n.stepType];if(!r)throw new RangeError("No step type "+n.stepType+" defined");return r.fromJSON(t,n)};Ft.jsonID=function(t,n){if(t in Qi)throw new RangeError("Duplicate use of step JSON ID "+t);return Qi[t]=n,n.prototype.jsonID=t,n};var qt=function(t,n){this.doc=t,this.failed=n};qt.ok=function(t){return new qt(t,null)};qt.fail=function(t){return new qt(null,t)};qt.fromReplace=function(t,n,r,o){try{return qt.ok(t.replace(n,r,o))}catch(i){if(i instanceof Be)return qt.fail(i.message);throw i}};var Ye=function(e){function t(n,r,o,i){e.call(this),this.from=n,this.to=r,this.slice=o,this.structure=!!i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){return this.structure&&ts(r,this.from,this.to)?qt.fail("Structure replace would overwrite content"):qt.fromReplace(r,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new Mt([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(r){return new t(this.from,this.from+this.slice.size,r.slice(this.from,this.to))},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1);return o.deleted&&i.deleted?null:new t(o.pos,Math.max(o.pos,i.pos),this.slice)},t.prototype.merge=function(r){if(!(r instanceof t)||r.structure||this.structure)return null;if(this.from+this.slice.size==r.from&&!this.slice.openEnd&&!r.slice.openStart){var o=this.slice.size+r.slice.size==0?_.empty:new _(this.slice.content.append(r.slice.content),this.slice.openStart,r.slice.openEnd);return new t(this.from,this.to+(r.to-r.from),o,this.structure)}else if(r.to==this.from&&!this.slice.openStart&&!r.slice.openEnd){var i=this.slice.size+r.slice.size==0?_.empty:new _(r.slice.content.append(this.slice.content),r.slice.openStart,this.slice.openEnd);return new t(r.from,this.to,i,this.structure)}else return null},t.prototype.toJSON=function(){var r={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(r.slice=this.slice.toJSON()),this.structure&&(r.structure=!0),r},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(o.from,o.to,_.fromJSON(r,o.slice),!!o.structure)},t}(Ft);Ft.jsonID("replace",Ye);var ee=function(e){function t(n,r,o,i,s,a,c){e.call(this),this.from=n,this.to=r,this.gapFrom=o,this.gapTo=i,this.slice=s,this.insert=a,this.structure=!!c}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){if(this.structure&&(ts(r,this.from,this.gapFrom)||ts(r,this.gapTo,this.to)))return qt.fail("Structure gap-replace would overwrite content");var o=r.slice(this.gapFrom,this.gapTo);if(o.openStart||o.openEnd)return qt.fail("Gap is not a flat range");var i=this.slice.insertAt(this.insert,o.content);return i?qt.fromReplace(r,this.from,this.to,i):qt.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new Mt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(r){var o=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+o,this.from+this.insert,this.from+this.insert+o,r.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1),s=r.map(this.gapFrom,-1),a=r.map(this.gapTo,1);return o.deleted&&i.deleted||s<o.pos||a>i.pos?null:new t(o.pos,i.pos,s,a,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var r={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(r.slice=this.slice.toJSON()),this.structure&&(r.structure=!0),r},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number"||typeof o.gapFrom!="number"||typeof o.gapTo!="number"||typeof o.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(o.from,o.to,o.gapFrom,o.gapTo,_.fromJSON(r,o.slice),o.insert,!!o.structure)},t}(Ft);Ft.jsonID("replaceAround",ee);function ts(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function Rd(e,t,n){return(t==0||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function nr(e){for(var t=e.parent,n=t.content.cutByIndex(e.startIndex,e.endIndex),r=e.depth;;--r){var o=e.$from.node(r),i=e.$from.index(r),s=e.$to.indexAfter(r);if(r<e.depth&&o.canReplace(i,s,n))return r;if(r==0||o.type.spec.isolating||!Rd(o,i,s))break}}ft.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=k.empty,u=0,f=o,p=!1;f>t;f--)p||n.index(f)>0?(p=!0,l=k.from(n.node(f).copy(l)),u++):a--;for(var h=k.empty,d=0,v=o,g=!1;v>t;v--)g||r.after(v+1)<r.end(v)?(g=!0,h=k.from(r.node(v).copy(h)),d++):c++;return this.step(new ee(a,c,i,s,new _(l.append(h),u,d),l.size-u,!0))};function es(e,t,n,r){r===void 0&&(r=e);var o=Bd(e,t),i=o&&Ld(r,t);return i?o.map(rl).concat({type:t,attrs:n}).concat(i.map(rl)):null}function rl(e){return{type:e,attrs:null}}function Bd(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;var s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}function Ld(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=s.length?s[s.length-1]:t,c=a.contentMatch,l=r;c&&l<o;l++)c=c.matchType(n.child(l).type);return!c||!c.validEnd?null:s}ft.prototype.wrap=function(e,t){for(var n=k.empty,r=t.length-1;r>=0;r--)n=k.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new ee(o,i,o,i,new _(n,0,0),t.length,!0))};ft.prototype.setBlockType=function(e,t,n,r){var o=this;if(t===void 0&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,function(s,a){if(s.isTextblock&&!s.hasMarkup(n,r)&&zd(o.doc,o.mapping.slice(i).map(a),n)){o.clearIncompatible(o.mapping.slice(i).map(a,1),n);var c=o.mapping.slice(i),l=c.map(a,1),u=c.map(a+s.nodeSize,1);return o.step(new ee(l,u,l+1,u-1,new _(k.from(n.create(r,null,s.marks)),0,0),1,!0)),!1}}),this};function zd(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}ft.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new ee(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new _(k.from(i),0,0),1,!0))};function Xe(e,t,n,r){n===void 0&&(n=1);var o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var l=o.node(a),u=o.index(a);if(l.type.spec.isolating)return!1;var f=l.content.cutByIndex(u,l.childCount),p=r&&r[c]||l;if(p!=l&&(f=f.replaceChild(0,p.type.create(p.attrs))),!l.canReplace(u+1,l.childCount)||!p.type.validContent(f))return!1}var h=o.indexAfter(i),d=r&&r[0];return o.node(i).canReplaceWith(h,h,d?d.type:o.node(i+1).type)}ft.prototype.split=function(e,t,n){t===void 0&&(t=1);for(var r=this.doc.resolve(e),o=k.empty,i=k.empty,s=r.depth,a=r.depth-t,c=t-1;s>a;s--,c--){o=k.from(r.node(s).copy(o));var l=n&&n[c];i=k.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new Ye(e,e,new _(o.append(i),t,t),!0))};function ns(e,t){var n=e.resolve(t),r=n.index();return Fd(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Fd(e,t){return e&&t&&!e.isLeaf&&e.canAppend(t)}ft.prototype.join=function(e,t){t===void 0&&(t=1);var n=new Ye(e-t,e+t,_.empty,!0);return this.step(n)};function $d(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(r.parentOffset==0)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}function ol(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,l=r.index(a)+(c>0?1:0),u=r.node(a),f=!1;if(s==1)f=u.canReplace(l,l,o);else{var p=u.contentMatchAt(l).findWrapping(o.firstChild.type);f=p&&u.canReplaceWith(l,l,p[0])}if(f)return c==0?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}function rs(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(rs(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return k.fromArray(r)}var is=function(e){function t(n,r,o){e.call(this),this.from=n,this.to=r,this.mark=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){var o=this,i=r.slice(this.from,this.to),s=r.resolve(this.from),a=s.node(s.sharedDepth(this.to)),c=new _(rs(i.content,function(l,u){return!l.isAtom||!u.type.allowsMarkType(o.mark.type)?l:l.mark(o.mark.addToSet(l.marks))},a),i.openStart,i.openEnd);return qt.fromReplace(r,this.from,this.to,c)},t.prototype.invert=function(){return new Ir(this.from,this.to,this.mark)},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1);return o.deleted&&i.deleted||o.pos>=i.pos?null:new t(o.pos,i.pos,this.mark)},t.prototype.merge=function(r){if(r instanceof t&&r.mark.eq(this.mark)&&this.from<=r.to&&this.to>=r.from)return new t(Math.min(this.from,r.from),Math.max(this.to,r.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(o.from,o.to,r.markFromJSON(o.mark))},t}(Ft);Ft.jsonID("addMark",is);var Ir=function(e){function t(n,r,o){e.call(this),this.from=n,this.to=r,this.mark=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){var o=this,i=r.slice(this.from,this.to),s=new _(rs(i.content,function(a){return a.mark(o.mark.removeFromSet(a.marks))}),i.openStart,i.openEnd);return qt.fromReplace(r,this.from,this.to,s)},t.prototype.invert=function(){return new is(this.from,this.to,this.mark)},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1);return o.deleted&&i.deleted||o.pos>=i.pos?null:new t(o.pos,i.pos,this.mark)},t.prototype.merge=function(r){if(r instanceof t&&r.mark.eq(this.mark)&&this.from<=r.to&&this.to>=r.from)return new t(Math.min(this.from,r.from),Math.max(this.to,r.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(o.from,o.to,r.markFromJSON(o.mark))},t}(Ft);Ft.jsonID("removeMark",Ir);ft.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(e,t,function(c,l,u){if(!!c.isInline){var f=c.marks;if(!n.isInSet(f)&&u.type.allowsMarkType(n.type)){for(var p=Math.max(l,e),h=Math.min(l+c.nodeSize,t),d=n.addToSet(f),v=0;v<f.length;v++)f[v].isInSet(d)||(s&&s.to==p&&s.mark.eq(f[v])?s.to=h:o.push(s=new Ir(p,h,f[v])));a&&a.to==p?a.to=h:i.push(a=new is(p,h,n))}}}),o.forEach(function(c){return r.step(c)}),i.forEach(function(c){return r.step(c)}),this};ft.prototype.removeMark=function(e,t,n){var r=this;n===void 0&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,function(s,a){if(!!s.isInline){i++;var c=null;if(n instanceof sn)for(var l=s.marks,u;u=n.isInSet(l);)(c||(c=[])).push(u),l=u.removeFromSet(l);else n?n.isInSet(s.marks)&&(c=[n]):c=s.marks;if(c&&c.length)for(var f=Math.min(a+s.nodeSize,t),p=0;p<c.length;p++){for(var h=c[p],d=void 0,v=0;v<o.length;v++){var g=o[v];g.step==i-1&&h.eq(o[v].style)&&(d=g)}d?(d.to=f,d.step=i):o.push({style:h,from:Math.max(a,e),to:f,step:i})}}}),o.forEach(function(s){return r.step(new Ir(s.from,s.to,s.style))}),this};ft.prototype.clearIncompatible=function(e,t,n){n===void 0&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(!l)o.push(new Ye(i,c,_.empty));else{n=l;for(var u=0;u<a.marks.length;u++)t.allowsMarkType(a.marks[u].type)||this.step(new Ir(i,c,a.marks[u]))}i=c}if(!n.validEnd){var f=n.fillBefore(k.empty,!0);this.replace(i,i,new _(f,0,0))}for(var p=o.length-1;p>=0;p--)this.step(o[p]);return this};function Vd(e,t,n,r){if(n===void 0&&(n=t),r===void 0&&(r=_.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return il(o,i,r)?new Ye(t,n,r):new ve(o,i,r).fit()}ft.prototype.replace=function(e,t,n){t===void 0&&(t=e),n===void 0&&(n=_.empty);var r=Vd(this.doc,e,t,n);return r&&this.step(r),this};ft.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new _(k.from(n),0,0))};ft.prototype.delete=function(e,t){return this.replace(e,t,_.empty)};ft.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};function il(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}var ve=function(t,n,r){this.$to=n,this.$from=t,this.unplaced=r,this.frontier=[];for(var o=0;o<=t.depth;o++){var i=t.node(o);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(o))})}this.placed=k.empty;for(var s=t.depth;s>0;s--)this.placed=k.from(t.node(s).copy(this.placed))},sl={depth:{configurable:!0}};sl.depth.get=function(){return this.frontier.length-1};ve.prototype.fit=function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var n=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,o=this.$from,i=this.close(n<0?this.$to:o.doc.resolve(n));if(!i)return null;for(var s=this.placed,a=o.depth,c=i.depth;a&&c&&s.childCount==1;)s=s.firstChild.content,a--,c--;var l=new _(s,a,c);if(n>-1)return new ee(o.pos,n,this.$to.pos,this.$to.end(),l,r);if(l.size||o.pos!=this.$to.pos)return new Ye(o.pos,i.pos,l)};ve.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var n=this.unplaced.openStart;n>=0;n--){var r=void 0,o=void 0;n?(o=ss(this.unplaced.content,n-1).firstChild,r=o.content):r=this.unplaced.content;for(var i=r.firstChild,s=this.depth;s>=0;s--){var a=this.frontier[s],c=a.type,l=a.match,u=void 0,f=void 0;if(t==1&&(i?l.matchType(i.type)||(f=l.fillBefore(k.from(i),!1)):c.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:s,parent:o,inject:f};if(t==2&&i&&(u=l.findWrapping(i.type)))return{sliceDepth:n,frontierDepth:s,parent:o,wrap:u};if(o&&l.matchType(o.type))break}}};ve.prototype.openMore=function(){var t=this.unplaced,n=t.content,r=t.openStart,o=t.openEnd,i=ss(n,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new _(n,r+1,Math.max(o,i.size+r>=n.size-o?r+1:0)),!0)};ve.prototype.dropNode=function(){var t=this.unplaced,n=t.content,r=t.openStart,o=t.openEnd,i=ss(n,r);if(i.childCount<=1&&r>0){var s=n.size-r<=r+i.size;this.unplaced=new _(Pr(n,r-1,1),r-1,s?r-1:o)}else this.unplaced=new _(Pr(n,r,1),r,o)};ve.prototype.placeNodes=function(t){for(var n=t.sliceDepth,r=t.frontierDepth,o=t.parent,i=t.inject,s=t.wrap;this.depth>r;)this.closeFrontierNode();if(s)for(var a=0;a<s.length;a++)this.openFrontierNode(s[a]);var c=this.unplaced,l=o?o.content:c.content,u=c.openStart-n,f=0,p=[],h=this.frontier[r],d=h.match,v=h.type;if(i){for(var g=0;g<i.childCount;g++)p.push(i.child(g));d=d.matchFragment(i)}for(var b=l.size+n-(c.content.size-c.openEnd);f<l.childCount;){var y=l.child(f),M=d.matchType(y.type);if(!M)break;f++,(f>1||u==0||y.content.size)&&(d=M,p.push(al(y.mark(v.allowedMarks(y.marks)),f==1?u:0,f==l.childCount?b:-1)))}var m=f==l.childCount;m||(b=-1),this.placed=Dr(this.placed,r,k.from(p)),this.frontier[r].match=d,m&&b<0&&o&&o.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var C=0,O=l;C<b;C++){var E=O.lastChild;this.frontier.push({type:E.type,match:E.contentMatchAt(E.childCount)}),O=E.content}this.unplaced=m?n==0?_.empty:new _(Pr(c.content,n-1,1),n-1,b<0?c.openEnd:n-1):new _(Pr(c.content,n,f),c.openStart,c.openEnd)};ve.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var t=this.frontier[this.depth],n;if(!t.type.isTextblock||!as(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;for(var r=this.$to,o=r.depth,i=this.$to.after(o);o>1&&i==this.$to.end(--o);)++i;return i};ve.prototype.findCloseLevel=function(t){t:for(var n=Math.min(this.depth,t.depth);n>=0;n--){var r=this.frontier[n],o=r.match,i=r.type,s=n<t.depth&&t.end(n+1)==t.pos+(t.depth-(n+1)),a=as(t,n,i,o,s);if(!!a){for(var c=n-1;c>=0;c--){var l=this.frontier[c],u=l.match,f=l.type,p=as(t,c,f,u,!0);if(!p||p.childCount)continue t}return{depth:n,fit:a,move:s?t.doc.resolve(t.after(n+1)):t}}}};ve.prototype.close=function(t){var n=this.findCloseLevel(t);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Dr(this.placed,n.depth,n.fit)),t=n.move;for(var r=n.depth+1;r<=t.depth;r++){var o=t.node(r),i=o.type.contentMatch.fillBefore(o.content,!0,t.index(r));this.openFrontierNode(o.type,o.attrs,i)}return t};ve.prototype.openFrontierNode=function(t,n,r){var o=this.frontier[this.depth];o.match=o.match.matchType(t),this.placed=Dr(this.placed,this.depth,k.from(t.create(n,r))),this.frontier.push({type:t,match:t.contentMatch})};ve.prototype.closeFrontierNode=function(){var t=this.frontier.pop(),n=t.match.fillBefore(k.empty,!0);n.childCount&&(this.placed=Dr(this.placed,this.frontier.length,n))};Object.defineProperties(ve.prototype,sl);function Pr(e,t,n){return t==0?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(Pr(e.firstChild.content,t-1,n)))}function Dr(e,t,n){return t==0?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Dr(e.lastChild.content,t-1,n)))}function ss(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function al(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,al(r.firstChild,t-1,r.childCount==1?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(k.empty,!0)))),e.copy(r)}function as(e,t,n,r,o){var i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!Hd(n,i.content,s)?a:null}function Hd(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}ft.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(il(r,o,n))return this.step(new Ye(e,t,n));var i=ll(r,this.doc.resolve(t));i[i.length-1]==0&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),f=[],p=n.openStart,h=n.content,d=0;;d++){var v=h.firstChild;if(f.push(v),d==n.openStart)break;h=v.content}p>0&&f[p-1].type.spec.defining&&r.node(u).type!=f[p-1].type?p-=1:p>=2&&f[p-1].isTextblock&&f[p-2].type.spec.defining&&r.node(u).type!=f[p-2].type&&(p-=2);for(var g=n.openStart;g>=0;g--){var b=(g+p+1)%(n.openStart+1),y=f[b];if(!!y)for(var M=0;M<i.length;M++){var m=i[(M+u)%i.length],C=!0;m<0&&(C=!1,m=-m);var O=r.node(m-1),E=r.index(m-1);if(O.canReplaceWith(E,E,y.type,y.marks))return this.replace(r.before(m),C?o.after(m):t,new _(cl(n.content,0,n.openStart,b),b,n.openEnd))}}for(var P=this.steps.length,D=i.length-1;D>=0&&(this.replace(e,t,n),!(this.steps.length>P));D--){var F=i[D];F<0||(e=r.before(F),t=o.after(F))}return this};function cl(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(cl(i.content,t+1,n,r,i)))}if(t>r){var s=o.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(k.empty,!0))}return e}ft.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=$d(this.doc,e,n.type);r!=null&&(e=t=r)}return this.replaceRange(e,t,new _(k.from(n),0,0))};ft.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=ll(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&s==0||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(e-n.start(c)==n.depth-c&&t>n.end(c)&&r.end(c)-t!=r.depth-c)return this.delete(n.before(c),t);return this.delete(e,t)};function ll(e,t){for(var n=[],r=Math.min(e.depth,t.depth),o=r;o>=0;o--){var i=e.start(o);if(i<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(i==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==i-1)&&n.push(o)}return n}var cs=Object.create(null),z=function(t,n,r){this.ranges=r||[new jd(t.min(n),t.max(n))],this.$anchor=t,this.$head=n},an={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};an.anchor.get=function(){return this.$anchor.pos};an.head.get=function(){return this.$head.pos};an.from.get=function(){return this.$from.pos};an.to.get=function(){return this.$to.pos};an.$from.get=function(){return this.ranges[0].$from};an.$to.get=function(){return this.ranges[0].$to};an.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0};z.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)};z.prototype.replace=function(t,n){n===void 0&&(n=_.empty);for(var r=n.content.lastChild,o=null,i=0;i<n.openEnd;i++)o=r,r=r.lastChild;for(var s=t.steps.length,a=this.ranges,c=0;c<a.length;c++){var l=a[c],u=l.$from,f=l.$to,p=t.mapping.slice(s);t.replaceRange(p.map(u.pos),p.map(f.pos),c?_.empty:n),c==0&&ul(t,s,(r?r.isInline:o&&o.isTextblock)?-1:1)}};z.prototype.replaceWith=function(t,n){for(var r=t.steps.length,o=this.ranges,i=0;i<o.length;i++){var s=o[i],a=s.$from,c=s.$to,l=t.mapping.slice(r),u=l.map(a.pos),f=l.map(c.pos);i?t.deleteRange(u,f):(t.replaceRangeWith(u,f,n),ul(t,r,n.isInline?-1:1))}};z.findFrom=function(t,n,r){var o=t.parent.inlineContent?new K(t):rr(t.node(0),t.parent,t.pos,t.index(),n,r);if(o)return o;for(var i=t.depth-1;i>=0;i--){var s=n<0?rr(t.node(0),t.node(i),t.before(i+1),t.index(i),n,r):rr(t.node(0),t.node(i),t.after(i+1),t.index(i)+1,n,r);if(s)return s}};z.near=function(t,n){return n===void 0&&(n=1),this.findFrom(t,n)||this.findFrom(t,-n)||new Ze(t.node(0))};z.atStart=function(t){return rr(t,t,0,0,1)||new Ze(t)};z.atEnd=function(t){return rr(t,t,t.content.size,t.childCount,-1)||new Ze(t)};z.fromJSON=function(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");var r=cs[n.type];if(!r)throw new RangeError("No selection type "+n.type+" defined");return r.fromJSON(t,n)};z.jsonID=function(t,n){if(t in cs)throw new RangeError("Duplicate use of selection JSON ID "+t);return cs[t]=n,n.prototype.jsonID=t,n};z.prototype.getBookmark=function(){return K.between(this.$anchor,this.$head).getBookmark()};Object.defineProperties(z.prototype,an);z.prototype.visible=!0;var jd=function(t,n){this.$from=t,this.$to=n},K=function(e){function t(r,o){o===void 0&&(o=r),e.call(this,r,o)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(o,i){var s=o.resolve(i.map(this.head));if(!s.parent.inlineContent)return e.near(s);var a=o.resolve(i.map(this.anchor));return new t(a.parent.inlineContent?a:s,s)},t.prototype.replace=function(o,i){if(i===void 0&&(i=_.empty),e.prototype.replace.call(this,o,i),i==_.empty){var s=this.$from.marksAcross(this.$to);s&&o.ensureMarks(s)}},t.prototype.eq=function(o){return o instanceof t&&o.anchor==this.anchor&&o.head==this.head},t.prototype.getBookmark=function(){return new Rr(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(o,i){if(typeof i.anchor!="number"||typeof i.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(o.resolve(i.anchor),o.resolve(i.head))},t.create=function(o,i,s){s===void 0&&(s=i);var a=o.resolve(i);return new this(a,s==i?a:o.resolve(s))},t.between=function(o,i,s){var a=o.pos-i.pos;if((!s||a)&&(s=a>=0?1:-1),!i.parent.inlineContent){var c=e.findFrom(i,s,!0)||e.findFrom(i,-s,!0);if(c)i=c.$head;else return e.near(i,s)}return o.parent.inlineContent||(a==0?o=i:(o=(e.findFrom(o,-s,!0)||e.findFrom(o,s,!0)).$anchor,o.pos<i.pos!=a<0&&(o=i))),new t(o,i)},Object.defineProperties(t.prototype,n),t}(z);z.jsonID("text",K);var Rr=function(t,n){this.anchor=t,this.head=n};Rr.prototype.map=function(t){return new Rr(t.map(this.anchor),t.map(this.head))};Rr.prototype.resolve=function(t){return K.between(t.resolve(this.anchor),t.resolve(this.head))};var L=function(e){function t(n){var r=n.nodeAfter,o=n.node(0).resolve(n.pos+r.nodeSize);e.call(this,n,o),this.node=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(r,o){var i=o.mapResult(this.anchor),s=i.deleted,a=i.pos,c=r.resolve(a);return s?e.near(c):new t(c)},t.prototype.content=function(){return new _(k.from(this.node),0,0)},t.prototype.eq=function(r){return r instanceof t&&r.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new Ro(this.anchor)},t.fromJSON=function(r,o){if(typeof o.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(r.resolve(o.anchor))},t.create=function(r,o){return new this(r.resolve(o))},t.isSelectable=function(r){return!r.isText&&r.type.spec.selectable!==!1},t}(z);L.prototype.visible=!1;z.jsonID("node",L);var Ro=function(t){this.anchor=t};Ro.prototype.map=function(t){var n=t.mapResult(this.anchor),r=n.deleted,o=n.pos;return r?new Rr(o,o):new Ro(o)};Ro.prototype.resolve=function(t){var n=t.resolve(this.anchor),r=n.nodeAfter;return r&&L.isSelectable(r)?new L(n):z.near(n)};var Ze=function(e){function t(n){e.call(this,n.resolve(0),n.resolve(n.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(r,o){if(o===void 0&&(o=_.empty),o==_.empty){r.delete(0,r.doc.content.size);var i=e.atStart(r.doc);i.eq(r.selection)||r.setSelection(i)}else e.prototype.replace.call(this,r,o)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(r){return new t(r)},t.prototype.map=function(r){return new t(r)},t.prototype.eq=function(r){return r instanceof t},t.prototype.getBookmark=function(){return Jd},t}(z);z.jsonID("all",Ze);var Jd={map:function(){return this},resolve:function(t){return new Ze(t)}};function rr(e,t,n,r,o,i){if(t.inlineContent)return K.create(e,n);for(var s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){var a=t.child(s);if(a.isAtom){if(!i&&L.isSelectable(a))return L.create(e,n-(o<0?a.nodeSize:0))}else{var c=rr(e,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function ul(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o=e.steps[r];if(o instanceof Ye||o instanceof ee){var i=e.mapping.maps[r],s;i.forEach(function(a,c,l,u){s==null&&(s=u)}),e.setSelection(z.near(e.doc.resolve(s),n))}}}var fl=1,Bo=2,pl=4,Wd=function(e){function t(r){e.call(this,r.doc),this.time=Date.now(),this.curSelection=r.selection,this.curSelectionFor=0,this.storedMarks=r.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(o){if(o.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=o,this.curSelectionFor=this.steps.length,this.updated=(this.updated|fl)&~Bo,this.storedMarks=null,this},n.selectionSet.get=function(){return(this.updated&fl)>0},t.prototype.setStoredMarks=function(o){return this.storedMarks=o,this.updated|=Bo,this},t.prototype.ensureMarks=function(o){return j.sameSet(this.storedMarks||this.selection.$from.marks(),o)||this.setStoredMarks(o),this},t.prototype.addStoredMark=function(o){return this.ensureMarks(o.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(o){return this.ensureMarks(o.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(this.updated&Bo)>0},t.prototype.addStep=function(o,i){e.prototype.addStep.call(this,o,i),this.updated=this.updated&~Bo,this.storedMarks=null},t.prototype.setTime=function(o){return this.time=o,this},t.prototype.replaceSelection=function(o){return this.selection.replace(this,o),this},t.prototype.replaceSelectionWith=function(o,i){var s=this.selection;return i!==!1&&(o=o.mark(this.storedMarks||(s.empty?s.$from.marks():s.$from.marksAcross(s.$to)||j.none))),s.replaceWith(this,o),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(o,i,s){s===void 0&&(s=i);var a=this.doc.type.schema;if(i==null)return o?this.replaceSelectionWith(a.text(o),!0):this.deleteSelection();if(!o)return this.deleteRange(i,s);var c=this.storedMarks;if(!c){var l=this.doc.resolve(i);c=s==i?l.marks():l.marksAcross(this.doc.resolve(s))}return this.replaceRangeWith(i,s,a.text(o,c)),this.selection.empty||this.setSelection(z.near(this.selection.$to)),this},t.prototype.setMeta=function(o,i){return this.meta[typeof o=="string"?o:o.key]=i,this},t.prototype.getMeta=function(o){return this.meta[typeof o=="string"?o:o.key]},n.isGeneric.get=function(){for(var r in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=pl,this},n.scrolledIntoView.get=function(){return(this.updated&pl)>0},Object.defineProperties(t.prototype,n),t}(ft);function hl(e,t){return!t||!e?e:e.bind(t)}var Br=function(t,n,r){this.name=t,this.init=hl(n.init,r),this.apply=hl(n.apply,r)},qd=[new Br("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Br("selection",{init:function(t,n){return t.selection||z.atStart(n.doc)},apply:function(t){return t.selection}}),new Br("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,n,r,o){return o.selection.$cursor?t.storedMarks:null}}),new Br("scrollToSelection",{init:function(){return 0},apply:function(t,n){return t.scrolledIntoView?n+1:n}})],ls=function(t,n){var r=this;this.schema=t,this.fields=qd.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),n&&n.forEach(function(o){if(r.pluginsByKey[o.key])throw new RangeError("Adding different instances of a keyed plugin ("+o.key+")");r.plugins.push(o),r.pluginsByKey[o.key]=o,o.spec.state&&r.fields.push(new Br(o.key,o.spec.state,o))})},$t=function(t){this.config=t},Lo={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Lo.schema.get=function(){return this.config.schema};Lo.plugins.get=function(){return this.config.plugins};$t.prototype.apply=function(t){return this.applyTransaction(t).state};$t.prototype.filterTransaction=function(t,n){n===void 0&&(n=-1);for(var r=0;r<this.config.plugins.length;r++)if(r!=n){var o=this.config.plugins[r];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,t,this))return!1}return!0};$t.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var n=[t],r=this.applyInner(t),o=null;;){for(var i=!1,s=0;s<this.config.plugins.length;s++){var a=this.config.plugins[s];if(a.spec.appendTransaction){var c=o?o[s].n:0,l=o?o[s].state:this,u=c<n.length&&a.spec.appendTransaction.call(a,c?n.slice(c):n,l,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",t),!o){o=[];for(var f=0;f<this.config.plugins.length;f++)o.push(f<s?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),i=!0}o&&(o[s]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}};$t.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new $t(this.config),r=this.config.fields,o=0;o<r.length;o++){var i=r[o];n[i.name]=i.apply(t,this[i.name],this,n)}for(var s=0;s<Lr.length;s++)Lr[s](this,t,n);return n};Lo.tr.get=function(){return new Wd(this)};$t.create=function(t){for(var n=new ls(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new $t(n),o=0;o<n.fields.length;o++)r[n.fields[o].name]=n.fields[o].init(t,r);return r};$t.prototype.reconfigure=function(t){for(var n=new ls(this.schema,t.plugins),r=n.fields,o=new $t(n),i=0;i<r.length;i++){var s=r[i].name;o[s]=this.hasOwnProperty(s)?this[s]:r[i].init(t,o)}return o};$t.prototype.toJSON=function(t){var n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(function(s){return s.toJSON()})),t&&typeof t=="object")for(var r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");var o=t[r],i=o.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(o,this[o.key]))}return n};$t.fromJSON=function(t,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var o=new ls(t.schema,t.plugins),i=new $t(o);return o.fields.forEach(function(s){if(s.name=="doc")i.doc=J.fromJSON(t.schema,n.doc);else if(s.name=="selection")i.selection=z.fromJSON(i.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(r)for(var a in r){var c=r[a],l=c.spec.state;if(c.key==s.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){i[s.name]=l.fromJSON.call(c,t,n[a],i);return}}i[s.name]=s.init(t,i)}}),i};$t.addApplyListener=function(t){Lr.push(t)};$t.removeApplyListener=function(t){var n=Lr.indexOf(t);n>-1&&Lr.splice(n,1)};Object.defineProperties($t.prototype,Lo);var Lr=[];function dl(e,t,n){for(var r in e){var o=e[r];o instanceof Function?o=o.bind(t):r=="handleDOMEvents"&&(o=dl(o,t,{})),n[r]=o}return n}var Ct=function(t){this.props={},t.props&&dl(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:vl("plugin")};Ct.prototype.getState=function(t){return t[this.key]};var us=Object.create(null);function vl(e){return e in us?e+"$"+ ++us[e]:(us[e]=0,e+"$")}var ne=function(t){t===void 0&&(t="key"),this.key=vl(t)};ne.prototype.get=function(t){return t.config.pluginsByKey[this.key]};ne.prototype.getState=function(t){return t[this.key]};function fs(e,t){return e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function ml(e,t,n){var r=e.selection,o=r.$cursor;if(!o||(n?!n.endOfTextblock("backward",e):o.parentOffset>0))return!1;var i=yl(o);if(!i){var s=o.blockRange(),a=s&&nr(s);return a==null?!1:(t&&t(e.tr.lift(s,a).scrollIntoView()),!0)}var c=i.nodeBefore;if(!c.type.spec.isolating&&Tl(e,i,t))return!0;if(o.parent.content.size==0&&(or(c,"end")||L.isSelectable(c))){if(t){var l=e.tr.deleteRange(o.before(),o.after());l.setSelection(or(c,"end")?z.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):L.create(l.doc,i.pos-c.nodeSize)),t(l.scrollIntoView())}return!0}return c.isAtom&&i.depth==o.depth-1?(t&&t(e.tr.delete(i.pos-c.nodeSize,i.pos).scrollIntoView()),!0):!1}function or(e,t,n){for(;e;e=t=="start"?e.firstChild:e.lastChild){if(e.isTextblock)return!0;if(n&&e.childCount!=1)return!1}return!1}function gl(e,t,n){var r=e.selection,o=r.$head,i=r.empty,s=o;if(!i)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;s=yl(o)}var a=s&&s.nodeBefore;return!a||!L.isSelectable(a)?!1:(t&&t(e.tr.setSelection(L.create(e.doc,s.pos-a.nodeSize)).scrollIntoView()),!0)}function yl(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function bl(e,t,n){var r=e.selection,o=r.$cursor;if(!o||(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size))return!1;var i=kl(o);if(!i)return!1;var s=i.nodeAfter;if(Tl(e,i,t))return!0;if(o.parent.content.size==0&&(or(s,"start")||L.isSelectable(s))){if(t){var a=e.tr.deleteRange(o.before(),o.after());a.setSelection(or(s,"start")?z.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):L.create(a.doc,a.mapping.map(i.pos))),t(a.scrollIntoView())}return!0}return s.isAtom&&i.depth==o.depth-1?(t&&t(e.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1}function wl(e,t,n){var r=e.selection,o=r.$head,i=r.empty,s=o;if(!i)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;s=kl(o)}var a=s&&s.nodeAfter;return!a||!L.isSelectable(a)?!1:(t&&t(e.tr.setSelection(L.create(e.doc,s.pos)).scrollIntoView()),!0)}function kl(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function Sl(e,t){var n=e.selection,r=n.$from,o=n.$to,i=r.blockRange(o),s=i&&nr(i);return s==null?!1:(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)}function Ol(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!r.parent.type.spec.code||!r.sameParent(o)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)}function ps(e){for(var t=0;t<e.edgeCount;t++){var n=e.edge(t),r=n.type;if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function xl(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),s=r.indexAfter(-1),a=ps(i.contentMatchAt(s));if(!i.canReplaceWith(s,s,a))return!1;if(t){var c=r.after(),l=e.tr.replaceWith(c,c,a.createAndFill());l.setSelection(z.near(l.doc.resolve(c),1)),t(l.scrollIntoView())}return!0}function Ml(e,t){var n=e.selection,r=n.$from,o=n.$to;if(n instanceof Ze||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=ps(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(s,i.createAndFill());a.setSelection(K.create(a.doc,s+1)),t(a.scrollIntoView())}return!0}function Cl(e,t){var n=e.selection,r=n.$cursor;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){var o=r.before();if(Xe(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}var i=r.blockRange(),s=i&&nr(i);return s==null?!1:(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)}function Kd(e,t){var n=e.selection,r=n.$from,o=n.$to;if(e.selection instanceof L&&e.selection.node.isBlock)return!r.parentOffset||!Xe(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){var i=o.parentOffset==o.parent.content.size,s=e.tr;(e.selection instanceof K||e.selection instanceof Ze)&&s.deleteSelection();var a=r.depth==0?null:ps(r.node(-1).contentMatchAt(r.indexAfter(-1))),c=i&&a?[{type:a}]:null,l=Xe(s.doc,s.mapping.map(r.pos),1,c);if(!c&&!l&&Xe(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])&&(c=[{type:a}],l=!0),l&&(s.split(s.mapping.map(r.pos),1,c),!i&&!r.parentOffset&&r.parent.type!=a)){var u=s.mapping.map(r.before()),f=s.doc.resolve(u);r.node(-1).canReplaceWith(f.index(),f.index()+1,a)&&s.setNodeMarkup(s.mapping.map(r.before()),a)}t(s.scrollIntoView())}return!0}function Ud(e,t){var n=e.selection,r=n.$from,o=n.to,i,s=r.sharedDepth(o);return s==0?!1:(i=r.before(s),t&&t(e.tr.setSelection(L.create(e.doc,i))),!0)}function Gd(e,t){return t&&t(e.tr.setSelection(new Ze(e.doc))),!0}function Yd(e,t,n){var r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!r||!o||!r.type.compatibleContent(o.type)?!1:!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(i,i+1)||!(o.isTextblock||ns(e.doc,t.pos))?!1:(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),!0)}function Tl(e,t,n){var r=t.nodeBefore,o=t.nodeAfter,i,s;if(r.type.spec.isolating||o.type.spec.isolating)return!1;if(Yd(e,t,n))return!0;var a=t.parent.canReplace(t.index(),t.index()+1);if(a&&(i=(s=r.contentMatchAt(r.childCount)).findWrapping(o.type))&&s.matchType(i[0]||o.type).validEnd){if(n){for(var c=t.pos+o.nodeSize,l=k.empty,u=i.length-1;u>=0;u--)l=k.from(i[u].create(null,l));l=k.from(r.copy(l));var f=e.tr.step(new ee(t.pos-1,c,t.pos,c,new _(l,1,0),i.length,!0)),p=c+2*i.length;ns(f.doc,p)&&f.join(p),n(f.scrollIntoView())}return!0}var h=z.findFrom(t,1),d=h&&h.$from.blockRange(h.$to),v=d&&nr(d);if(v!=null&&v>=t.depth)return n&&n(e.tr.lift(d,v).scrollIntoView()),!0;if(a&&or(o,"start",!0)&&or(r,"end")){for(var g=r,b=[];b.push(g),!g.isTextblock;)g=g.lastChild;for(var y=o,M=1;!y.isTextblock;y=y.firstChild)M++;if(g.canReplace(g.childCount,g.childCount,y.content)){if(n){for(var m=k.empty,C=b.length-1;C>=0;C--)m=k.from(b[C].copy(m));var O=e.tr.step(new ee(t.pos-b.length,t.pos+o.nodeSize,t.pos+M,t.pos+o.nodeSize-M,new _(m,b.length,0),0,!0));n(O.scrollIntoView())}return!0}}return!1}function _l(e,t){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=a&&es(a,e,t);return c?(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0):!1}}function Xd(e,t){return function(n,r){var o=n.selection,i=o.from,s=o.to,a=!1;return n.doc.nodesBetween(i,s,function(c,l){if(a)return!1;if(!(!c.isTextblock||c.hasMarkup(e,t)))if(c.type==e)a=!0;else{var u=n.doc.resolve(l),f=u.index();a=u.parent.canReplaceWith(f,f+1,e)}}),a?(r&&r(n.tr.setBlockType(i,s,e,t).scrollIntoView()),!0):!1}}function hs(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(n,r,o){for(var i=0;i<e.length;i++)if(e[i](n,r,o))return!0;return!1}}var ds=hs(fs,ml,gl),El=hs(fs,bl,wl),cn={Enter:hs(Ol,Ml,Cl,Kd),"Mod-Enter":xl,Backspace:ds,"Mod-Backspace":ds,"Shift-Backspace":ds,Delete:El,"Mod-Delete":El,"Mod-a":Gd},Zd={"Ctrl-h":cn.Backspace,"Alt-Backspace":cn["Mod-Backspace"],"Ctrl-d":cn.Delete,"Ctrl-Alt-Backspace":cn["Mod-Delete"],"Alt-Delete":cn["Mod-Delete"],"Alt-d":cn["Mod-Delete"]};for(var Al in cn)Zd[Al]=cn[Al];typeof navigator!="undefined"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os!="undefined"&&os.platform()=="darwin";function Qd(e,t){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=!1,l=a;if(!a)return!1;if(a.depth>=2&&i.node(a.depth-1).type.compatibleContent(e)&&a.startIndex==0){if(i.index(a.depth-1)==0)return!1;var u=n.doc.resolve(a.start-2);l=new Er(u,u,a.depth),a.endIndex<a.parent.childCount&&(a=new Er(i,n.doc.resolve(s.end(a.depth)),a.depth)),c=!0}var f=es(l,e,t,a);return f?(r&&r(tv(n.tr,a,f,c,e).scrollIntoView()),!0):!1}}function tv(e,t,n,r,o){for(var i=k.empty,s=n.length-1;s>=0;s--)i=k.from(n[s].type.create(n[s].attrs,i));e.step(new ee(t.start-(r?2:0),t.end,t.start,t.end,new _(i,0,0),n.length,!0));for(var a=0,c=0;c<n.length;c++)n[c].type==o&&(a=c+1);for(var l=n.length-a,u=t.start+n.length-(r?2:0),f=t.parent,p=t.startIndex,h=t.endIndex,d=!0;p<h;p++,d=!1)!d&&Xe(e.doc,u,l)&&(e.split(u,l),u+=2*l),u+=f.child(p).nodeSize;return e}function ev(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,function(a){return a.childCount&&a.firstChild.type==e});return s?n?o.node(s.depth-1).type==e?nv(t,n,e,s):rv(t,n,s):!0:!1}}function nv(e,t,n,r){var o=e.tr,i=r.end,s=r.$to.end(r.depth);return i<s&&(o.step(new ee(i-1,s,i,s,new _(k.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Er(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth)),t(o.lift(r,nr(r)).scrollIntoView()),!0}function rv(e,t,n){for(var r=e.tr,o=n.parent,i=n.end,s=n.endIndex-1,a=n.startIndex;s>a;s--)i-=o.child(s).nodeSize,r.delete(i-1,i+1);var c=r.doc.resolve(n.start),l=c.nodeAfter;if(r.mapping.map(n.end)!=n.start+c.nodeAfter.nodeSize)return!1;var u=n.startIndex==0,f=n.endIndex==o.childCount,p=c.node(-1),h=c.index(-1);if(!p.canReplace(h+(u?0:1),h+1,l.content.append(f?k.empty:k.from(o))))return!1;var d=c.pos,v=d+l.nodeSize;return r.step(new ee(d-(u?1:0),v+(f?1:0),d+1,v-1,new _((u?k.empty:k.from(o.copy(k.empty))).append(f?k.empty:k.from(o.copy(k.empty))),u?0:1,f?0:1),u?0:1)),t(r.scrollIntoView()),!0}function ov(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,function(v){return v.childCount&&v.firstChild.type==e});if(!s)return!1;var a=s.startIndex;if(a==0)return!1;var c=s.parent,l=c.child(a-1);if(l.type!=e)return!1;if(n){var u=l.lastChild&&l.lastChild.type==c.type,f=k.from(u?e.create():null),p=new _(k.from(e.create(null,k.from(c.type.create(null,f)))),u?3:1,0),h=s.start,d=s.end;n(t.tr.step(new ee(h-(u?3:1),d,h,d,p,1,!0)).scrollIntoView())}return!0}}var x={};if(typeof navigator!="undefined"&&typeof document!="undefined"){var vs=/Edge\/(\d+)/.exec(navigator.userAgent),Nl=/MSIE \d/.test(navigator.userAgent),ms=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),gs=x.ie=!!(Nl||ms||vs);x.ie_version=Nl?document.documentMode||6:ms?+ms[1]:vs?+vs[1]:null,x.gecko=!gs&&/gecko\/(\d+)/i.test(navigator.userAgent),x.gecko_version=x.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var ys=!gs&&/Chrome\/(\d+)/.exec(navigator.userAgent);x.chrome=!!ys,x.chrome_version=ys&&+ys[1],x.safari=!gs&&/Apple Computer/.test(navigator.vendor),x.ios=x.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),x.mac=x.ios||/Mac/.test(navigator.platform),x.android=/Android \d/.test(navigator.userAgent),x.webkit="webkitFontSmoothing"in document.documentElement.style,x.webkit_version=x.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var ae=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},bs=function(e){var t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t},Il=null,Qe=function(e,t,n){var r=Il||(Il=document.createRange());return r.setEnd(e,n==null?e.nodeValue.length:n),r.setStart(e,t||0),r},zo=function(e,t,n,r){return n&&(Pl(e,t,n,r,-1)||Pl(e,t,n,r,1))},iv=/^(img|br|input|textarea|hr)$/i;function Pl(e,t,n,r,o){for(;;){if(e==n&&t==r)return!0;if(t==(o<0?0:Le(e))){var i=e.parentNode;if(i.nodeType!=1||av(e)||iv.test(e.nodeName)||e.contentEditable=="false")return!1;t=ae(e)+(o<0?0:1),e=i}else if(e.nodeType==1){if(e=e.childNodes[t+(o<0?-1:0)],e.contentEditable=="false")return!1;t=o<0?Le(e):0}else return!1}}function Le(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function sv(e,t,n){for(var r=t==0,o=t==Le(e);r||o;){if(e==n)return!0;var i=ae(e);if(e=e.parentNode,!e)return!1;r=r&&i==0,o=o&&i==Le(e)}}function av(e){for(var t,n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var ws=function(e){var t=e.isCollapsed;return t&&x.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t};function ir(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function cv(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function ln(e,t){return typeof e=="number"?e:e[t]}function lv(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function Dl(e,t,n){for(var r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,s=n||e.dom;s;s=bs(s))if(s.nodeType==1){var a=s==i.body||s.nodeType!=1,c=a?cv(i):lv(s),l=0,u=0;if(t.top<c.top+ln(r,"top")?u=-(c.top-t.top+ln(o,"top")):t.bottom>c.bottom-ln(r,"bottom")&&(u=t.bottom-c.bottom+ln(o,"bottom")),t.left<c.left+ln(r,"left")?l=-(c.left-t.left+ln(o,"left")):t.right>c.right-ln(r,"right")&&(l=t.right-c.right+ln(o,"right")),l||u)if(a)i.defaultView.scrollBy(l,u);else{var f=s.scrollLeft,p=s.scrollTop;u&&(s.scrollTop+=u),l&&(s.scrollLeft+=l);var h=s.scrollLeft-f,d=s.scrollTop-p;t={left:t.left-h,top:t.top-d,right:t.right-h,bottom:t.bottom-d}}if(a)break}}function uv(e){for(var t=e.dom.getBoundingClientRect(),n=Math.max(0,t.top),r,o,i=(t.left+t.right)/2,s=n+1;s<Math.min(innerHeight,t.bottom);s+=5){var a=e.root.elementFromPoint(i,s);if(!(a==e.dom||!e.dom.contains(a))){var c=a.getBoundingClientRect();if(c.top>=n-20){r=a,o=c.top;break}}}return{refDOM:r,refTop:o,stack:Rl(e.dom)}}function Rl(e){for(var t=[],n=e.ownerDocument;e&&(t.push({dom:e,top:e.scrollTop,left:e.scrollLeft}),e!=n);e=bs(e));return t}function fv(e){var t=e.refDOM,n=e.refTop,r=e.stack,o=t?t.getBoundingClientRect().top:0;Bl(r,o==0?0:o-n)}function Bl(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=s&&(o.scrollLeft=s)}}var sr=null;function pv(e){if(e.setActive)return e.setActive();if(sr)return e.focus(sr);var t=Rl(e);e.focus(sr==null?{get preventScroll(){return sr={preventScroll:!0},!0}}:void 0),sr||(sr=!1,Bl(t,0))}function Ll(e,t){for(var n,r=2e8,o,i=0,s=t.top,a=t.top,c=e.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(c.nodeType==1)u=c.getClientRects();else if(c.nodeType==3)u=Qe(c).getClientRects();else continue;for(var f=0;f<u.length;f++){var p=u[f];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);var h=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(h<r){n=c,r=h,o=h&&n.nodeType==3?{left:p.right<t.left?p.right:p.left,top:t.top}:t,c.nodeType==1&&h&&(i=l+(t.left>=(p.left+p.right)/2?1:0));continue}}!n&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(i=l+1)}}return n&&n.nodeType==3?hv(n,o):!n||r&&n.nodeType==1?{node:e,offset:i}:Ll(n,o)}function hv(e,t){for(var n=e.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);var i=un(r,1);if(i.top!=i.bottom&&ks(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}function ks(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function dv(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}function vv(e,t,n){var r=Ll(t,n),o=r.node,i=r.offset,s=-1;if(o.nodeType==1&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return e.docView.posFromDOM(o,i,s)}function mv(e,t,n,r){for(var o=-1,i=t;i!=e.dom;){var s=e.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else if(a.right<r.left||a.bottom<r.top)o=s.posAfter;else break}i=s.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n)}function zl(e,t,n){var r=e.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=e.childNodes[i];if(s.nodeType==1)for(var a=s.getClientRects(),c=0;c<a.length;c++){var l=a[c];if(ks(t,l))return zl(s,t,l)}if((i=(i+1)%r)==o)break}return e}function gv(e,t){var n,r,o=e.dom.ownerDocument,i,s;if(o.caretPositionFromPoint)try{var a=o.caretPositionFromPoint(t.left,t.top);a&&(n=a,i=n.offsetNode,s=n.offset)}catch{}if(!i&&o.caretRangeFromPoint){var c=o.caretRangeFromPoint(t.left,t.top);c&&(r=c,i=r.startContainer,s=r.startOffset)}var l=(e.root.elementFromPoint?e.root:o).elementFromPoint(t.left,t.top+1),u;if(!l||!e.dom.contains(l.nodeType!=1?l.parentNode:l)){var f=e.dom.getBoundingClientRect();if(!ks(t,f)||(l=zl(e.dom,t,f),!l))return null}if(x.safari)for(var p=l;i&&p;p=bs(p))p.draggable&&(i=s=null);if(l=dv(l,t),i){if(x.gecko&&i.nodeType==1&&(s=Math.min(s,i.childNodes.length),s<i.childNodes.length)){var h=i.childNodes[s],d;h.nodeName=="IMG"&&(d=h.getBoundingClientRect()).right<=t.left&&d.bottom>t.top&&s++}i==e.dom&&s==i.childNodes.length-1&&i.lastChild.nodeType==1&&t.top>i.lastChild.getBoundingClientRect().bottom?u=e.state.doc.content.size:(s==0||i.nodeType!=1||i.childNodes[s-1].nodeName!="BR")&&(u=mv(e,i,s,t))}u==null&&(u=vv(e,l,t));var v=e.docView.nearestDesc(l,!0);return{pos:u,inside:v?v.posAtStart-v.border:-1}}function un(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}var yv=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Fl(e,t,n){var r=e.docView.domFromPos(t,n<0?-1:1),o=r.node,i=r.offset,s=x.webkit||x.gecko;if(o.nodeType==3)if(s&&(yv.test(o.nodeValue)||(n<0?!i:i==o.nodeValue.length))){var a=un(Qe(o,i,i),n);if(x.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var c=un(Qe(o,i-1,i-1),-1);if(c.top==a.top){var l=un(Qe(o,i,i+1),-1);if(l.top!=a.top)return zr(l,l.left<c.left)}}return a}else{var u=i,f=i,p=n<0?1:-1;return n<0&&!i?(f++,p=-1):n>=0&&i==o.nodeValue.length?(u--,p=1):n<0?u--:f++,zr(un(Qe(o,u,f),p),p<0)}if(!e.state.doc.resolve(t).parent.inlineContent){if(i&&(n<0||i==Le(o))){var h=o.childNodes[i-1];if(h.nodeType==1)return Ss(h.getBoundingClientRect(),!1)}if(i<Le(o)){var d=o.childNodes[i];if(d.nodeType==1)return Ss(d.getBoundingClientRect(),!0)}return Ss(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==Le(o))){var v=o.childNodes[i-1],g=v.nodeType==3?Qe(v,Le(v)-(s?0:1)):v.nodeType==1&&(v.nodeName!="BR"||!v.nextSibling)?v:null;if(g)return zr(un(g,1),!1)}if(i<Le(o)){for(var b=o.childNodes[i];b.pmViewDesc&&b.pmViewDesc.ignoreForCoords;)b=b.nextSibling;var y=b?b.nodeType==3?Qe(b,0,s?0:1):b.nodeType==1?b:null:null;if(y)return zr(un(y,-1),!0)}return zr(un(o.nodeType==3?Qe(o):o,-n),n>=0)}function zr(e,t){if(e.width==0)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Ss(e,t){if(e.height==0)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function $l(e,t,n){var r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}function bv(e,t,n){var r=t.selection,o=n=="up"?r.$from:r.$to;return $l(e,t,function(){for(var i=e.docView.domFromPos(o.pos,n=="up"?-1:1),s=i.node;;){var a=e.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.dom;break}s=a.dom.parentNode}for(var c=Fl(e,o.pos,1),l=s.firstChild;l;l=l.nextSibling){var u=void 0;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=Qe(l,0,l.nodeValue.length).getClientRects();else continue;for(var f=0;f<u.length;f++){var p=u[f];if(p.bottom>p.top+1&&(n=="up"?c.top-p.top>(p.bottom-c.top)*2:p.bottom-c.bottom>(c.bottom-p.top)*2))return!1}}return!0})}var wv=/[\u0590-\u08ac]/;function kv(e,t,n){var r=t.selection,o=r.$head;if(!o.parent.isTextblock)return!1;var i=o.parentOffset,s=!i,a=i==o.parent.content.size,c=e.root.getSelection();return!wv.test(o.parent.textContent)||!c.modify?n=="left"||n=="backward"?s:a:$l(e,t,function(){var l=c.getRangeAt(0),u=c.focusNode,f=c.focusOffset,p=c.caretBidiLevel;c.modify("move",n,"character");var h=o.depth?e.docView.domAfterPos(o.before()):e.dom,d=!h.contains(c.focusNode.nodeType==1?c.focusNode:c.focusNode.parentNode)||u==c.focusNode&&f==c.focusOffset;return c.removeAllRanges(),c.addRange(l),p!=null&&(c.caretBidiLevel=p),d})}var Vl=null,Hl=null,jl=!1;function Sv(e,t,n){return Vl==t&&Hl==n?jl:(Vl=t,Hl=n,jl=n=="up"||n=="down"?bv(e,t,n):kv(e,t,n))}var Ce=0,Jl=1,Fr=2,fn=3,nt=function(t,n,r,o){this.parent=t,this.children=n,this.dom=r,r.pmViewDesc=this,this.contentDOM=o,this.dirty=Ce},ze={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};nt.prototype.matchesWidget=function(){return!1};nt.prototype.matchesMark=function(){return!1};nt.prototype.matchesNode=function(){return!1};nt.prototype.matchesHack=function(t){return!1};nt.prototype.parseRule=function(){return null};nt.prototype.stopEvent=function(){return!1};ze.size.get=function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e};ze.border.get=function(){return 0};nt.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()};nt.prototype.posBeforeChild=function(t){for(var n=0,r=this.posAtStart;n<this.children.length;n++){var o=this.children[n];if(o==t)return r;r+=o.size}};ze.posBefore.get=function(){return this.parent.posBeforeChild(this)};ze.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0};ze.posAfter.get=function(){return this.posBefore+this.size};ze.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border};nt.prototype.localPosFromDOM=function(t,n,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){var o,i;if(t==this.contentDOM)o=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.previousSibling}for(;o&&!((i=o.pmViewDesc)&&i.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(i)+i.size:this.posAtStart}else{var s,a;if(t==this.contentDOM)s=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(a):this.posAtEnd}var c;if(t==this.dom&&this.contentDOM)c=n>ae(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))c=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(var l=t;;l=l.parentNode){if(l==this.dom){c=!1;break}if(l.parentNode.firstChild!=l)break}if(c==null&&n==t.childNodes.length)for(var u=t;;u=u.parentNode){if(u==this.dom){c=!0;break}if(u.parentNode.lastChild!=u)break}}return(c==null?r>0:c)?this.posAtEnd:this.posAtStart};nt.prototype.nearestDesc=function(t,n){for(var r=!0,o=t;o;o=o.parentNode){var i=this.getDesc(o);if(i&&(!n||i.node))if(r&&i.nodeDOM&&!(i.nodeDOM.nodeType==1?i.nodeDOM.contains(t.nodeType==1?t:t.parentNode):i.nodeDOM==t))r=!1;else return i}};nt.prototype.getDesc=function(t){for(var n=t.pmViewDesc,r=n;r;r=r.parent)if(r==this)return n};nt.prototype.posFromDOM=function(t,n,r){for(var o=t;o;o=o.parentNode){var i=this.getDesc(o);if(i)return i.localPosFromDOM(t,n,r)}return-1};nt.prototype.descAt=function(t){for(var n=0,r=0;n<this.children.length;n++){var o=this.children[n],i=r+o.size;if(r==t&&i!=r){for(;!o.border&&o.children.length;)o=o.children[0];return o}if(t<i)return o.descAt(t-r-o.border);r=i}};nt.prototype.domFromPos=function(t,n){if(!this.contentDOM)return{node:this.dom,offset:0};for(var r=0,o=0,i=0;r<this.children.length;r++){var s=this.children[r],a=i+s.size;if(a>t||s instanceof Ul){o=t-i;break}i=a}if(o)return this.children[r].domFromPos(o-this.children[r].border,n);for(var c=void 0;r&&!(c=this.children[r-1]).size&&c instanceof Wl&&c.widget.type.side>=0;r--);if(n<=0){for(var l,u=!0;l=r?this.children[r-1]:null,!(!l||l.dom.parentNode==this.contentDOM);r--,u=!1);return l&&n&&u&&!l.border&&!l.domAtom?l.domFromPos(l.size,n):{node:this.contentDOM,offset:l?ae(l.dom)+1:0}}else{for(var f,p=!0;f=r<this.children.length?this.children[r]:null,!(!f||f.dom.parentNode==this.contentDOM);r++,p=!1);return f&&p&&!f.border&&!f.domAtom?f.domFromPos(0,n):{node:this.contentDOM,offset:f?ae(f.dom):this.contentDOM.childNodes.length}}};nt.prototype.parseRange=function(t,n,r){if(r===void 0&&(r=0),this.children.length==0)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var o=-1,i=-1,s=r,a=0;;a++){var c=this.children[a],l=s+c.size;if(o==-1&&t<=l){var u=s+c.border;if(t>=u&&n<=l-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(t,n,u);t=s;for(var f=a;f>0;f--){var p=this.children[f-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){o=ae(p.dom)+1;break}t-=p.size}o==-1&&(o=0)}if(o>-1&&(l>n||a==this.children.length-1)){n=l;for(var h=a+1;h<this.children.length;h++){var d=this.children[h];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=ae(d.dom);break}n+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}s=l}return{node:this.contentDOM,from:t,to:n,fromOffset:o,toOffset:i}};nt.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var n=this.children[t<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(t)};nt.prototype.domAfterPos=function(t){var n=this.domFromPos(t,0),r=n.node,o=n.offset;if(r.nodeType!=1||o==r.childNodes.length)throw new RangeError("No node after pos "+t);return r.childNodes[o]};nt.prototype.setSelection=function(t,n,r,o){for(var i=Math.min(t,n),s=Math.max(t,n),a=0,c=0;a<this.children.length;a++){var l=this.children[a],u=c+l.size;if(i>c&&s<u)return l.setSelection(t-c-l.border,n-c-l.border,r,o);c=u}var f=this.domFromPos(t,t?-1:1),p=n==t?f:this.domFromPos(n,n?-1:1),h=r.getSelection(),d=!1;if((x.gecko||x.safari)&&t==n){var v=f.node,g=f.offset;if(v.nodeType==3){if(d=g&&v.nodeValue[g-1]==`
`,d&&g==v.nodeValue.length)for(var b=v,y=void 0;b;b=b.parentNode){if(y=b.nextSibling){y.nodeName=="BR"&&(f=p={node:y.parentNode,offset:ae(y)+1});break}var M=b.pmViewDesc;if(M&&M.node&&M.node.isBlock)break}}else{var m=v.childNodes[g-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(x.gecko&&h.focusNode&&h.focusNode!=p.node&&h.focusNode.nodeType==1){var C=h.focusNode.childNodes[h.focusOffset];C&&C.contentEditable=="false"&&(o=!0)}if(!(!(o||d&&x.safari)&&zo(f.node,f.offset,h.anchorNode,h.anchorOffset)&&zo(p.node,p.offset,h.focusNode,h.focusOffset))){var O=!1;if((h.extend||t==n)&&!d){h.collapse(f.node,f.offset);try{t!=n&&h.extend(p.node,p.offset),O=!0}catch(D){if(!(D instanceof DOMException))throw D}}if(!O){if(t>n){var E=f;f=p,p=E}var P=document.createRange();P.setEnd(p.node,p.offset),P.setStart(f.node,f.offset),h.removeAllRanges(),h.addRange(P)}}};nt.prototype.ignoreMutation=function(t){return!this.contentDOM&&t.type!="selection"};ze.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)};nt.prototype.markDirty=function(t,n){for(var r=0,o=0;o<this.children.length;o++){var i=this.children[o],s=r+i.size;if(r==s?t<=s&&n>=r:t<s&&n>r){var a=r+i.border,c=s-i.border;if(t>=a&&n<=c){this.dirty=t==r||n==s?Fr:Jl,t==a&&n==c&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=fn:i.markDirty(t-a,n-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM?Fr:fn}r=s}this.dirty=Fr};nt.prototype.markParentsDirty=function(){for(var t=1,n=this.parent;n;n=n.parent,t++){var r=t==1?Fr:Jl;n.dirty<r&&(n.dirty=r)}};ze.domAtom.get=function(){return!1};ze.ignoreForCoords.get=function(){return!1};Object.defineProperties(nt.prototype,ze);var pn=[],Wl=function(e){function t(r,o,i,s){var a,c=o.type.toDOM;if(typeof c=="function"&&(c=c(i,function(){if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)})),!o.type.spec.raw){if(c.nodeType!=1){var l=document.createElement("span");l.appendChild(c),c=l}c.contentEditable=!1,c.classList.add("ProseMirror-widget")}e.call(this,r,pn,c,null),this.widget=o,a=this}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.matchesWidget=function(o){return this.dirty==Ce&&o.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(o){var i=this.widget.spec.stopEvent;return i?i(o):!1},t.prototype.ignoreMutation=function(o){return o.type!="selection"||this.widget.spec.ignoreSelection},n.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,n),t}(nt),Ov=function(e){function t(r,o,i,s){e.call(this,r,pn,o,null),this.textDOM=i,this.text=s}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(o,i){return o!=this.textDOM?this.posAtStart+(i?this.size:0):this.posAtStart+i},t.prototype.domFromPos=function(o){return{node:this.textDOM,offset:o}},t.prototype.ignoreMutation=function(o){return o.type==="characterData"&&o.target.nodeValue==o.oldValue},Object.defineProperties(t.prototype,n),t}(nt),Os=function(e){function t(n,r,o,i){e.call(this,n,[],o,i),this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(r,o,i,s){var a=s.nodeViews[o.type.name],c=a&&a(o,s,i);return(!c||!c.dom)&&(c=xt.renderSpec(document,o.type.spec.toDOM(o,i))),new t(r,o,c.dom,c.contentDOM||c.dom)},t.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(r){return this.dirty!=fn&&this.mark.eq(r)},t.prototype.markDirty=function(r,o){if(e.prototype.markDirty.call(this,r,o),this.dirty!=Ce){for(var i=this.parent;!i.node;)i=i.parent;i.dirty<this.dirty&&(i.dirty=this.dirty),this.dirty=Ce}},t.prototype.slice=function(r,o,i){var s=t.create(this.parent,this.mark,!0,i),a=this.children,c=this.size;o<c&&(a=Cs(a,o,c,i)),r>0&&(a=Cs(a,0,r,i));for(var l=0;l<a.length;l++)a[l].parent=s;return s.children=a,s},t}(nt),$r=function(e){function t(r,o,i,s,a,c,l,u,f){e.call(this,r,o.isLeaf?pn:[],a,c),this.nodeDOM=l,this.node=o,this.outerDeco=i,this.innerDeco=s,c&&this.updateChildren(u,f)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return t.create=function(o,i,s,a,c,l){var u,f=c.nodeViews[i.type.name],p,h=f&&f(i,c,function(){if(!p)return l;if(p.parent)return p.parent.posBeforeChild(p)},s,a),d=h&&h.dom,v=h&&h.contentDOM;if(i.isText){if(!d)d=document.createTextNode(i.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||(u=xt.renderSpec(document,i.type.spec.toDOM(i)),d=u.dom,v=u.contentDOM);!v&&!i.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable=!1),i.type.spec.draggable&&(d.draggable=!0));var g=d;return d=Xl(d,s,i),h?p=new xv(o,i,s,a,d,v,g,h,c,l+1):i.isText?new Kl(o,i,s,a,d,g,c):new t(o,i,s,a,d,v,g,c,l+1)},t.prototype.parseRule=function(){var o=this;if(this.node.type.spec.reparseInView)return null;var i={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(i.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?i.contentElement=this.contentDOM:i.getContent=function(){return o.contentDOM?k.empty:o.node.content},i},t.prototype.matchesNode=function(o,i,s){return this.dirty==Ce&&o.eq(this.node)&&Ms(i,this.outerDeco)&&s.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(o,i){var s=this,a=this.node.inlineContent,c=i,l=o.composing&&this.localCompositionInfo(o,i),u=l&&l.pos>-1?l:null,f=l&&l.pos<0,p=new me(this,u&&u.node);_v(this.node,this.innerDeco,function(h,d,v){h.spec.marks?p.syncToMarks(h.spec.marks,a,o):h.type.side>=0&&!v&&p.syncToMarks(d==s.node.childCount?j.none:s.node.child(d).marks,a,o),p.placeWidget(h,o,c)},function(h,d,v,g){p.syncToMarks(h.marks,a,o);var b;p.findNodeMatch(h,d,v,g)||f&&o.state.selection.from>c&&o.state.selection.to<c+h.nodeSize&&(b=p.findIndexWithChild(l.node))>-1&&p.updateNodeAt(h,d,v,b,o)||p.updateNextNode(h,d,v,o,g)||p.addNode(h,d,v,o,c),c+=h.nodeSize}),p.syncToMarks(pn,a,o),this.node.isTextblock&&p.addTextblockHacks(),p.destroyRest(),(p.changed||this.dirty==Fr)&&(u&&this.protectLocalComposition(o,u),Gl(this.contentDOM,this.children,o),x.ios&&Ev(this.dom))},t.prototype.localCompositionInfo=function(o,i){var s=o.state.selection,a=s.from,c=s.to;if(!(!(o.state.selection instanceof K)||a<i||c>i+this.node.content.size)){var l=o.root.getSelection(),u=Av(l.focusNode,l.focusOffset);if(!(!u||!this.dom.contains(u.parentNode)))if(this.node.inlineContent){var f=u.nodeValue,p=Nv(this.node.content,f,a-i,c-i);return p<0?null:{node:u,pos:p,text:f}}else return{node:u,pos:-1}}},t.prototype.protectLocalComposition=function(o,i){var s=i.node,a=i.pos,c=i.text;if(!this.getDesc(s)){for(var l=s;l.parentNode!=this.contentDOM;l=l.parentNode){for(;l.previousSibling;)l.parentNode.removeChild(l.previousSibling);for(;l.nextSibling;)l.parentNode.removeChild(l.nextSibling);l.pmViewDesc&&(l.pmViewDesc=null)}var u=new Ov(this,l,s,c);o.compositionNodes.push(u),this.children=Cs(this.children,a,a+c.length,o,u)}},t.prototype.update=function(o,i,s,a){return this.dirty==fn||!o.sameMarkup(this.node)?!1:(this.updateInner(o,i,s,a),!0)},t.prototype.updateInner=function(o,i,s,a){this.updateOuterDeco(i),this.node=o,this.innerDeco=s,this.contentDOM&&this.updateChildren(a,this.posAtStart),this.dirty=Ce},t.prototype.updateOuterDeco=function(o){if(!Ms(o,this.outerDeco)){var i=this.nodeDOM.nodeType!=1,s=this.dom;this.dom=Yl(this.dom,this.nodeDOM,xs(this.outerDeco,this.node,i),xs(o,this.node,i)),this.dom!=s&&(s.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=o}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(t.prototype,n),t}(nt);function ql(e,t,n,r,o){return Xl(r,t,e),new $r(null,e,t,n,r,r,r,o,0)}var Kl=function(e){function t(r,o,i,s,a,c,l){e.call(this,r,o,i,s,a,null,c,l)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){for(var o=this.nodeDOM.parentNode;o&&o!=this.dom&&!o.pmIsDeco;)o=o.parentNode;return{skip:o||!0}},t.prototype.update=function(o,i,s,a){return this.dirty==fn||this.dirty!=Ce&&!this.inParent()||!o.sameMarkup(this.node)?!1:(this.updateOuterDeco(i),(this.dirty!=Ce||o.text!=this.node.text)&&o.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=o.text,a.trackWrites==this.nodeDOM&&(a.trackWrites=null)),this.node=o,this.dirty=Ce,!0)},t.prototype.inParent=function(){for(var o=this.parent.contentDOM,i=this.nodeDOM;i;i=i.parentNode)if(i==o)return!0;return!1},t.prototype.domFromPos=function(o){return{node:this.nodeDOM,offset:o}},t.prototype.localPosFromDOM=function(o,i,s){return o==this.nodeDOM?this.posAtStart+Math.min(i,this.node.text.length):e.prototype.localPosFromDOM.call(this,o,i,s)},t.prototype.ignoreMutation=function(o){return o.type!="characterData"&&o.type!="selection"},t.prototype.slice=function(o,i,s){var a=this.node.cut(o,i),c=document.createTextNode(a.text);return new t(this.parent,a,this.outerDeco,this.innerDeco,c,c,s)},t.prototype.markDirty=function(o,i){e.prototype.markDirty.call(this,o,i),this.dom!=this.nodeDOM&&(o==0||i==this.nodeDOM.nodeValue.length)&&(this.dirty=fn)},n.domAtom.get=function(){return!1},Object.defineProperties(t.prototype,n),t}($r),Ul=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(o){return this.dirty==Ce&&this.dom.nodeName==o},n.domAtom.get=function(){return!0},n.ignoreForCoords.get=function(){return this.dom.nodeName=="IMG"},Object.defineProperties(t.prototype,n),t}(nt),xv=function(e){function t(n,r,o,i,s,a,c,l,u,f){e.call(this,n,r,o,i,s,a,c,u,f),this.spec=l}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(r,o,i,s){if(this.dirty==fn)return!1;if(this.spec.update){var a=this.spec.update(r,o,i);return a&&this.updateInner(r,o,i,s),a}else return!this.contentDOM&&!r.isLeaf?!1:e.prototype.update.call(this,r,o,i,s)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(r,o,i,s){this.spec.setSelection?this.spec.setSelection(r,o,i):e.prototype.setSelection.call(this,r,o,i,s)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(r){return this.spec.stopEvent?this.spec.stopEvent(r):!1},t.prototype.ignoreMutation=function(r){return this.spec.ignoreMutation?this.spec.ignoreMutation(r):e.prototype.ignoreMutation.call(this,r)},t}($r);function Gl(e,t,n){for(var r=e.firstChild,o=!1,i=0;i<t.length;i++){var s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=r;)r=Zl(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(a,r);if(s instanceof Os){var c=r?r.previousSibling:e.lastChild;Gl(s.contentDOM,s.children,n),r=c?c.nextSibling:e.firstChild}}for(;r;)r=Zl(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}function Vr(e){e&&(this.nodeName=e)}Vr.prototype=Object.create(null);var Dn=[new Vr];function xs(e,t,n){if(e.length==0)return Dn;for(var r=n?Dn[0]:new Vr,o=[r],i=0;i<e.length;i++){var s=e[i].type.attrs;if(!!s){s.nodeName&&o.push(r=new Vr(s.nodeName));for(var a in s){var c=s[a];c!=null&&(n&&o.length==1&&o.push(r=new Vr(t.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+c:a=="style"?r.style=(r.style?r.style+";":"")+c:a!="nodeName"&&(r[a]=c))}}}return o}function Yl(e,t,n,r){if(n==Dn&&r==Dn)return t;for(var o=t,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=e&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||(c=document.createElement(s.nodeName),c.pmIsDeco=!0,c.appendChild(o),a=Dn[0]),o=c}Mv(o,a||Dn[0],s)}return o}function Mv(e,t,n){for(var r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&e.removeAttribute(r);for(var o in n)o!="class"&&o!="style"&&o!="nodeName"&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){for(var i=t.class?t.class.split(" ").filter(Boolean):pn,s=n.class?n.class.split(" ").filter(Boolean):pn,a=0;a<i.length;a++)s.indexOf(i[a])==-1&&e.classList.remove(i[a]);for(var c=0;c<s.length;c++)i.indexOf(s[c])==-1&&e.classList.add(s[c])}if(t.style!=n.style){if(t.style)for(var l=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,u;u=l.exec(t.style);)e.style.removeProperty(u[1]);n.style&&(e.style.cssText+=n.style)}}function Xl(e,t,n){return Yl(e,e,Dn,xs(t,n,e.nodeType!=1))}function Ms(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Zl(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var me=function(t,n){this.top=t,this.lock=n,this.index=0,this.stack=[],this.changed=!1,this.preMatch=Cv(t.node.content,t.children)};me.prototype.destroyBetween=function(t,n){if(t!=n){for(var r=t;r<n;r++)this.top.children[r].destroy();this.top.children.splice(t,n-t),this.changed=!0}};me.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)};me.prototype.syncToMarks=function(t,n,r){for(var o=0,i=this.stack.length>>1,s=Math.min(i,t.length);o<s&&(o==i-1?this.top:this.stack[o+1<<1]).matchesMark(t[o])&&t[o].type.spec.spanning!==!1;)o++;for(;o<i;)this.destroyRest(),this.top.dirty=Ce,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<t.length;){this.stack.push(this.top,this.index+1);for(var a=-1,c=this.index;c<Math.min(this.index+3,this.top.children.length);c++)if(this.top.children[c].matchesMark(t[i])){a=c;break}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{var l=Os.create(this.top,t[i],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}};me.prototype.findNodeMatch=function(t,n,r,o){var i=this.top.children,s=-1;if(o>=this.preMatch.index){for(var a=this.index;a<i.length;a++)if(i[a].matchesNode(t,n,r)){s=a;break}}else for(var c=this.index,l=Math.min(i.length,c+1);c<l;c++){var u=i[c];if(u.matchesNode(t,n,r)&&!this.preMatch.matched.has(u)){s=c;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)};me.prototype.updateNodeAt=function(t,n,r,o,i){var s=this.top.children[o];return s.update(t,n,r,i)?(this.destroyBetween(this.index,o),this.index=o+1,!0):!1};me.prototype.findIndexWithChild=function(t){for(;;){var n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){var r=t.pmViewDesc;if(r){for(var o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==r)return o}return-1}t=n}};me.prototype.updateNextNode=function(t,n,r,o,i){for(var s=this.index;s<this.top.children.length;s++){var a=this.top.children[s];if(a instanceof $r){var c=this.preMatch.matched.get(a);if(c!=null&&c!=i)return!1;var l=a.dom,u=this.lock&&(l==this.lock||l.nodeType==1&&l.contains(this.lock.parentNode))&&!(t.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==t.text&&a.dirty!=fn&&Ms(n,a.outerDeco));if(!u&&a.update(t,n,r,o))return this.destroyBetween(this.index,s),a.dom!=l&&(this.changed=!0),this.index++,!0;break}}return!1};me.prototype.addNode=function(t,n,r,o,i){this.top.children.splice(this.index++,0,$r.create(this.top,t,n,r,o,i)),this.changed=!0};me.prototype.placeWidget=function(t,n,r){var o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(t)&&(t==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{var i=new Wl(this.top,t,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}};me.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof Os;)t=t.children[t.children.length-1];(!t||!(t instanceof Kl)||/\n$/.test(t.node.text))&&((x.safari||x.chrome)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG"),this.addHackNode("BR"))};me.prototype.addHackNode=function(t){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(t))this.index++;else{var n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator"),t=="BR"&&(n.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new Ul(this.top,pn,n,null)),this.changed=!0}};function Cv(e,t){for(var n=e.childCount,r=t.length,o=new Map;n>0&&r>0;r--){var i=t[r-1],s=i.node;if(!!s){if(s!=e.child(n-1))break;--n,o.set(i,n)}}return{index:n,matched:o}}function Tv(e,t){return e.type.side-t.type.side}function _v(e,t,n,r){var o=t.locals(e),i=0;if(o.length==0){for(var s=0;s<e.childCount;s++){var a=e.child(s);r(a,o,t.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,l=[],u=null,f=0;;){if(c<o.length&&o[c].to==i){for(var p=o[c++],h=void 0;c<o.length&&o[c].to==i;)(h||(h=[p])).push(o[c++]);if(h){h.sort(Tv);for(var d=0;d<h.length;d++)n(h[d],f,!!u)}else n(p,f,!!u)}var v=void 0,g=void 0;if(u)g=-1,v=u,u=null;else if(f<e.childCount)g=f,v=e.child(f++);else break;for(var b=0;b<l.length;b++)l[b].to<=i&&l.splice(b--,1);for(;c<o.length&&o[c].from<=i&&o[c].to>i;)l.push(o[c++]);var y=i+v.nodeSize;if(v.isText){var M=y;c<o.length&&o[c].from<M&&(M=o[c].from);for(var m=0;m<l.length;m++)l[m].to<M&&(M=l[m].to);M<y&&(u=v.cut(M-i),v=v.cut(0,M-i),y=M,g=-1)}var C=l.length?v.isInline&&!v.isLeaf?l.filter(function(O){return!O.inline}):l.slice():pn;r(v,C,t.forChild(i,v),g),i=y}}function Ev(e){if(e.nodeName=="UL"||e.nodeName=="OL"){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function Av(e,t){for(;;){if(e.nodeType==3)return e;if(e.nodeType==1&&t>0){if(e.childNodes.length>t&&e.childNodes[t].nodeType==3)return e.childNodes[t];e=e.childNodes[t-1],t=Le(e)}else if(e.nodeType==1&&t<e.childNodes.length)e=e.childNodes[t],t=0;else return null}}function Nv(e,t,n,r){for(var o=0,i=0;o<e.childCount&&i<=r;){var s=e.child(o++),a=i;if(i+=s.nodeSize,!!s.isText){for(var c=s.text;o<e.childCount;){var l=e.child(o++);if(i+=l.nodeSize,!l.isText)break;c+=l.text}if(i>=n){var u=c.lastIndexOf(t,r-a);if(u>=0&&u+t.length+a>=n)return a+u}}}return-1}function Cs(e,t,n,r,o){for(var i=[],s=0,a=0;s<e.length;s++){var c=e[s],l=a,u=a+=c.size;l>=n||u<=t?i.push(c):(l<t&&i.push(c.slice(0,t-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function Ql(e,t){var n=e.root.getSelection(),r=e.state.doc;if(!n.focusNode)return null;var o=e.docView.nearestDesc(n.focusNode),i=o&&o.size==0,s=e.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a=r.resolve(s),c,l;if(ws(n)){for(c=a;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&L.isSelectable(o.node)&&o.parent&&!(o.node.isInline&&sv(n.focusNode,n.focusOffset,o.dom))){var u=o.posBefore;l=new L(s==u?a:r.resolve(u))}}else{var f=e.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;c=r.resolve(f)}if(!l){var p=t=="pointer"||e.state.selection.head<a.pos&&!i?1:-1;l=_s(e,c,a,p)}return l}function tu(e){return e.editable?e.hasFocus():Es(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function hn(e,t){var n=e.state.selection;if(ou(e,n),!!tu(e)){if(!t&&e.mouseDown&&e.mouseDown.allowDefault){e.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}if(e.domObserver.disconnectSelection(),e.cursorWrapper)Pv(e);else{var r=n.anchor,o=n.head,i,s;eu&&!(n instanceof K)&&(n.$from.parent.inlineContent||(i=nu(e,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=nu(e,n.to))),e.docView.setSelection(r,o,e.root,t),eu&&(i&&ru(i),s&&ru(s)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Iv(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var eu=x.safari||x.chrome&&x.chrome_version<63;function nu(e,t){var n=e.docView.domFromPos(t,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(x.safari&&i&&i.contentEditable=="false")return Ts(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Ts(i);if(s)return Ts(s)}}function Ts(e){return e.contentEditable="true",x.safari&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function ru(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Iv(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var n=e.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){(n.anchorNode!=r||n.anchorOffset!=o)&&(t.removeEventListener("selectionchange",e.hideSelectionGuard),setTimeout(function(){(!tu(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function Pv(e){var t=e.root.getSelection(),n=document.createRange(),r=e.cursorWrapper.dom,o=r.nodeName=="IMG";o?n.setEnd(r.parentNode,ae(r)+1):n.setEnd(r,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!o&&!e.state.selection.visible&&x.ie&&x.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}function ou(e,t){if(t instanceof L){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(iu(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else iu(e)}function iu(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function _s(e,t,n,r){return e.someProp("createSelectionBetween",function(o){return o(e,t,n)})||K.between(t,n,r)}function Dv(e){return e.editable&&e.root.activeElement!=e.dom?!1:Es(e)}function Es(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Rv(e){var t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.root.getSelection();return zo(t.node,t.offset,n.anchorNode,n.anchorOffset)}function As(e,t){var n=e.selection,r=n.$anchor,o=n.$head,i=t>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&z.findFrom(s,t)}function Rn(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function su(e,t,n){var r=e.state.selection;if(r instanceof K){if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var o=As(e.state,t);return o&&o instanceof L?Rn(e,o):!1}else if(!(x.mac&&n.indexOf("m")>-1)){var i=r.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,a;if(!s||s.isText)return!1;var c=t<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(a=e.docView.descAt(c))&&!a.contentDOM?L.isSelectable(s)?Rn(e,new L(t<0?e.state.doc.resolve(i.pos-s.nodeSize):i)):x.webkit?Rn(e,new K(e.state.doc.resolve(t<0?c:c+s.nodeSize))):!1:!1}}else{if(r instanceof L&&r.node.isInline)return Rn(e,new K(t>0?r.$to:r.$from));var l=As(e.state,t);return l?Rn(e,l):!1}}function Fo(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Hr(e){var t=e.pmViewDesc;return t&&t.size==0&&(e.nextSibling||e.nodeName!="BR")}function Ns(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(!!n){var o,i,s=!1;for(x.gecko&&n.nodeType==1&&r<Fo(n)&&Hr(n.childNodes[r])&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;var a=n.childNodes[r-1];if(Hr(a))o=n,i=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}else{if(au(n))break;for(var c=n.previousSibling;c&&Hr(c);)o=n.parentNode,i=ae(c),c=c.previousSibling;if(c)n=c,r=Fo(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}s?Ps(e,t,n,r):o&&Ps(e,t,o,i)}}function Is(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(!!n){for(var o=Fo(n),i,s;;)if(r<o){if(n.nodeType!=1)break;var a=n.childNodes[r];if(Hr(a))i=n,s=++r;else break}else{if(au(n))break;for(var c=n.nextSibling;c&&Hr(c);)i=c.parentNode,s=ae(c)+1,c=c.nextSibling;if(c)n=c,r=0,o=Fo(n);else{if(n=n.parentNode,n==e.dom)break;r=o=0}}i&&Ps(e,t,i,s)}}function au(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function Ps(e,t,n,r){if(ws(t)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(n,r);e.domObserver.setCurSelection();var i=e.state;setTimeout(function(){e.state==i&&hn(e)},50)}function cu(e,t,n){var r=e.state.selection;if(r instanceof K&&!r.empty||n.indexOf("s")>-1||x.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var s=As(e.state,t);if(s&&s instanceof L)return Rn(e,s)}if(!o.parent.inlineContent){var a=t<0?o:i,c=r instanceof Ze?z.near(a,t):z.findFrom(a,t);return c?Rn(e,c):!1}return!1}function lu(e,t){if(!(e.state.selection instanceof K))return!0;var n=e.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=e.state.tr;return t<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),e.dispatch(a),!0}return!1}function uu(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function Bv(e){if(!(!x.safari||e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n&&n.nodeType==1&&r==0&&n.firstChild&&n.firstChild.contentEditable=="false"){var o=n.firstChild;uu(e,o,!0),setTimeout(function(){return uu(e,o,!1)},20)}}}function Lv(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function zv(e,t){var n=t.keyCode,r=Lv(t);return n==8||x.mac&&n==72&&r=="c"?lu(e,-1)||Ns(e):n==46||x.mac&&n==68&&r=="c"?lu(e,1)||Is(e):n==13||n==27?!0:n==37?su(e,-1,r)||Ns(e):n==39?su(e,1,r)||Is(e):n==38?cu(e,-1,r)||Ns(e):n==40?Bv(e)||cu(e,1,r)||Is(e):r==(x.mac?"m":"c")&&(n==66||n==73||n==89||n==90)}function Fv(e,t,n){var r=e.docView.parseRange(t,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,l=e.root.getSelection(),u=null,f=l.anchorNode;if(f&&e.dom.contains(f.nodeType==1?f:f.parentNode)&&(u=[{node:f,offset:l.anchorOffset}],ws(l)||u.push({node:l.focusNode,offset:l.focusOffset})),x.chrome&&e.lastKeyCode===8)for(var p=s;p>i;p--){var h=o.childNodes[p-1],d=h.pmViewDesc;if(h.nodeName=="BR"&&!d){s=p;break}if(!d||d.size)break}var v=e.state.doc,g=e.someProp("domParser")||Me.fromSchema(e.state.schema),b=v.resolve(a),y=null,M=g.parse(o,{topNode:b.parent,topMatch:b.parent.contentMatchAt(b.index()),topOpen:!0,from:i,to:s,preserveWhitespace:b.parent.type.spec.code?"full":!0,editableContent:!0,findPositions:u,ruleFromNode:$v,context:b});if(u&&u[0].pos!=null){var m=u[0].pos,C=u[1]&&u[1].pos;C==null&&(C=m),y={anchor:m+a,head:C+a}}return{doc:M,sel:y,from:a,to:c}}function $v(e){var t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(x.safari&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(e.parentNode.lastChild==e||x.safari&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0}}function Vv(e,t,n,r,o){if(t<0){var i=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,s=Ql(e,i);if(s&&!e.state.selection.eq(s)){var a=e.state.tr.setSelection(s);i=="pointer"?a.setMeta("pointer",!0):i=="key"&&a.scrollIntoView(),e.dispatch(a)}return}var c=e.state.doc.resolve(t),l=c.sharedDepth(n);t=c.before(l+1),n=e.state.doc.resolve(n).after(l+1);var u=e.state.selection,f=Fv(e,t,n);if(x.chrome&&e.cursorWrapper&&f.sel&&f.sel.anchor==e.cursorWrapper.deco.from){var p=e.cursorWrapper.deco.type.toDOM.nextSibling,h=p&&p.nodeValue?p.nodeValue.length:1;f.sel={anchor:f.sel.anchor+h,head:f.sel.anchor+h}}var d=e.state.doc,v=d.slice(f.from,f.to),g,b;e.lastKeyCode===8&&Date.now()-100<e.lastKeyCodeTime?(g=e.state.selection.to,b="end"):(g=e.state.selection.from,b="start"),e.lastKeyCode=null;var y=Jv(v.content,f.doc.content,f.from,g,b);if(!y)if(r&&u instanceof K&&!u.empty&&u.$head.sameParent(u.$anchor)&&!e.composing&&!(f.sel&&f.sel.anchor!=f.sel.head))y={start:u.from,endA:u.to,endB:u.to};else if((x.ios&&e.lastIOSEnter>Date.now()-225||x.android)&&o.some(function(Y){return Y.nodeName=="DIV"||Y.nodeName=="P"})&&e.someProp("handleKeyDown",function(Y){return Y(e,ir(13,"Enter"))})){e.lastIOSEnter=0;return}else{if(f.sel){var M=fu(e,e.state.doc,f.sel);M&&!M.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(M))}return}e.domChangeCount++,e.state.selection.from<e.state.selection.to&&y.start==y.endB&&e.state.selection instanceof K&&(y.start>e.state.selection.from&&y.start<=e.state.selection.from+2?y.start=e.state.selection.from:y.endA<e.state.selection.to&&y.endA>=e.state.selection.to-2&&(y.endB+=e.state.selection.to-y.endA,y.endA=e.state.selection.to)),x.ie&&x.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>f.from&&f.doc.textBetween(y.start-f.from-1,y.start-f.from+1)==" \xA0"&&(y.start--,y.endA--,y.endB--);var m=f.doc.resolveNoCache(y.start-f.from),C=f.doc.resolveNoCache(y.endB-f.from),O=m.sameParent(C)&&m.parent.inlineContent,E;if((x.ios&&e.lastIOSEnter>Date.now()-225&&(!O||o.some(function(Y){return Y.nodeName=="DIV"||Y.nodeName=="P"}))||!O&&m.pos<f.doc.content.size&&(E=z.findFrom(f.doc.resolve(m.pos+1),1,!0))&&E.head==C.pos)&&e.someProp("handleKeyDown",function(Y){return Y(e,ir(13,"Enter"))})){e.lastIOSEnter=0;return}if(e.state.selection.anchor>y.start&&jv(d,y.start,y.endA,m,C)&&e.someProp("handleKeyDown",function(Y){return Y(e,ir(8,"Backspace"))})){x.android&&x.chrome&&e.domObserver.suppressSelectionUpdates();return}x.chrome&&x.android&&y.toB==y.from&&(e.lastAndroidDelete=Date.now()),x.android&&!O&&m.start()!=C.start()&&C.parentOffset==0&&m.depth==C.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==y.endA&&(y.endB-=2,C=f.doc.resolveNoCache(y.endB-f.from),setTimeout(function(){e.someProp("handleKeyDown",function(Y){return Y(e,ir(13,"Enter"))})},20));var P=y.start,D=y.endA,F,it,W,H;if(O){if(m.pos==C.pos)x.ie&&x.ie_version<=11&&m.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(function(){return hn(e)},20)),F=e.state.tr.delete(P,D),it=d.resolve(y.start).marksAcross(d.resolve(y.endA));else if(y.endA==y.endB&&(H=d.resolve(y.start))&&(W=Hv(m.parent.content.cut(m.parentOffset,C.parentOffset),H.parent.content.cut(H.parentOffset,y.endA-H.start()))))F=e.state.tr,W.type=="add"?F.addMark(P,D,W.mark):F.removeMark(P,D,W.mark);else if(m.parent.child(m.index()).isText&&m.index()==C.index()-(C.textOffset?0:1)){var mt=m.parent.textBetween(m.parentOffset,C.parentOffset);if(e.someProp("handleTextInput",function(Y){return Y(e,P,D,mt)}))return;F=e.state.tr.insertText(mt,P,D)}}if(F||(F=e.state.tr.replace(P,D,f.doc.slice(y.start-f.from,y.endB-f.from))),f.sel){var Z=fu(e,F.doc,f.sel);Z&&!(x.chrome&&x.android&&e.composing&&Z.empty&&(y.start!=y.endB||e.lastAndroidDelete<Date.now()-100)&&(Z.head==P||Z.head==F.mapping.map(D)-1)||x.ie&&Z.empty&&Z.head==P)&&F.setSelection(Z)}it&&F.ensureMarks(it),e.dispatch(F.scrollIntoView())}function fu(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:_s(e,t.resolve(n.anchor),t.resolve(n.head))}function Hv(e,t){for(var n=e.firstChild.marks,r=t.firstChild.marks,o=n,i=r,s,a,c,l=0;l<r.length;l++)o=r[l].removeFromSet(o);for(var u=0;u<n.length;u++)i=n[u].removeFromSet(i);if(o.length==1&&i.length==0)a=o[0],s="add",c=function(h){return h.mark(a.addToSet(h.marks))};else if(o.length==0&&i.length==1)a=i[0],s="remove",c=function(h){return h.mark(a.removeFromSet(h.marks))};else return null;for(var f=[],p=0;p<t.childCount;p++)f.push(c(t.child(p)));if(k.from(f).eq(e))return{mark:a,type:s}}function jv(e,t,n,r,o){if(!r.parent.isTextblock||n-t<=o.pos-r.pos||Ds(r,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=e.resolve(Ds(i,!0,!0));return!s.parent.isTextblock||s.pos>n||Ds(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Ds(e,t,n){for(var r=e.depth,o=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n)for(var i=e.node(r).maybeChild(e.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function Jv(e,t,n,r,o){var i=e.findDiffStart(t,n);if(i==null)return null;var s=e.findDiffEnd(t,n+e.size,n+t.size),a=s.a,c=s.b;if(o=="end"){var l=Math.max(0,i-Math.min(a,c));r-=a+l-i}if(a<i&&e.size<t.size){var u=r<=i&&r>=a?i-r:0;i-=u,c=i+(c-a),a=i}else if(c<i){var f=r<=i&&r>=c?i-r:0;i-=f,a=i+(a-c),c=i}return{start:i,endA:a,endB:c}}function pu(e,t){for(var n=[],r=t.content,o=t.openStart,i=t.openEnd;o>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=e.someProp("clipboardSerializer")||xt.fromSchema(e.state.schema),c=wu(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var u=l.firstChild,f;u&&u.nodeType==1&&(f=yu[u.nodeName.toLowerCase()]);){for(var p=f.length-1;p>=0;p--){for(var h=c.createElement(f[p]);l.firstChild;)h.appendChild(l.firstChild);l.appendChild(h),f[p]!="tbody"&&(o++,i++)}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n));var d=e.someProp("clipboardTextSerializer",function(v){return v(t)})||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:d}}function hu(e,t,n,r,o){var i,s=o.parent.type.spec.code,a;if(!n&&!t)return null;var c=t&&(r||s||!n);if(c){if(e.someProp("transformPastedText",function(C){t=C(t,s||r)}),s)return t?new _(k.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):_.empty;var l=e.someProp("clipboardTextParser",function(C){return C(t,o,r)});if(l)a=l;else{var u=o.marks(),f=e.state,p=f.schema,h=xt.fromSchema(p);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(function(C){var O=i.appendChild(document.createElement("p"));C&&O.appendChild(h.serializeNode(p.text(C,u)))})}}else e.someProp("transformPastedHTML",function(C){n=C(n)}),i=qv(n),x.webkit&&Kv(i);var d=i&&i.querySelector("[data-pm-slice]"),v=d&&/^(\d+) (\d+) (.*)/.exec(d.getAttribute("data-pm-slice"));if(!a){var g=e.someProp("clipboardParser")||e.someProp("domParser")||Me.fromSchema(e.state.schema);a=g.parseSlice(i,{preserveWhitespace:!!(c||v),context:o})}if(v)a=Uv(gu(a,+v[1],+v[2]),v[3]);else if(a=_.maxOpen(Wv(a.content,o),!0),a.openStart||a.openEnd){for(var b=0,y=0,M=a.content.firstChild;b<a.openStart&&!M.type.spec.isolating;b++,M=M.firstChild);for(var m=a.content.lastChild;y<a.openEnd&&!m.type.spec.isolating;y++,m=m.lastChild);a=gu(a,b,y)}return e.someProp("transformPasted",function(C){a=C(a)}),a}function Wv(e,t){if(e.childCount<2)return e;for(var n=function(i){var s=t.node(i),a=s.contentMatchAt(t.index(i)),c=void 0,l=[];if(e.forEach(function(u){if(!!l){var f=a.findWrapping(u.type),p;if(!f)return l=null;if(p=l.length&&c.length&&vu(f,c,u,l[l.length-1],0))l[l.length-1]=p;else{l.length&&(l[l.length-1]=mu(l[l.length-1],c.length));var h=du(u,f);l.push(h),a=a.matchType(h.type,h.attrs),c=f}}}),l)return{v:k.from(l)}},r=t.depth;r>=0;r--){var o=n(r);if(o)return o.v}return e}function du(e,t,n){n===void 0&&(n=0);for(var r=t.length-1;r>=n;r--)e=t[r].create(null,k.from(e));return e}function vu(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){var i=vu(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));var s=r.contentMatchAt(r.childCount);if(s.matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(k.from(du(n,e,o+1))))}}function mu(e,t){if(t==0)return e;var n=e.content.replaceChild(e.childCount-1,mu(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(k.empty,!0);return e.copy(n.append(r))}function Rs(e,t,n,r,o,i){var s=t<0?e.firstChild:e.lastChild,a=s.content;return o<r-1&&(a=Rs(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,e.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(k.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function gu(e,t,n){return t<e.openStart&&(e=new _(Rs(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new _(Rs(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}var yu={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},bu=null;function wu(){return bu||(bu=document.implementation.createHTMLDocument("title"))}function qv(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var n=wu().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e),o;if((o=r&&yu[r[1].toLowerCase()])&&(e=o.map(function(s){return"<"+s+">"}).join("")+e+o.map(function(s){return"</"+s+">"}).reverse().join("")),n.innerHTML=e,o)for(var i=0;i<o.length;i++)n=n.querySelector(o[i])||n;return n}function Kv(e){for(var t=e.querySelectorAll(x.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<t.length;n++){var r=t[n];r.childNodes.length==1&&r.textContent=="\xA0"&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}function Uv(e,t){if(!e.size)return e;var n=e.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return e}for(var o=e.content,i=e.openStart,s=e.openEnd,a=r.length-2;a>=0;a-=2){var c=n.nodes[r[a]];if(!c||c.hasRequiredAttrs())break;o=k.from(c.create(r[a+1],o)),i++,s++}return new _(o,i,s)}var Gv={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Bs=x.ie&&x.ie_version<=11,Ls=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Ls.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset};Ls.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var ce=function(t,n){var r=this;this.view=t,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver(function(o){for(var i=0;i<o.length;i++)r.queue.push(o[i]);x.ie&&x.ie_version<=11&&o.some(function(s){return s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length})?r.flushSoon():r.flush()}),this.currentSelection=new Ls,Bs&&(this.onCharData=function(o){r.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),r.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};ce.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(function(){t.flushingSoon=-1,t.flush()},20))};ce.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())};ce.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Gv),Bs&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()};ce.prototype.stop=function(){var t=this;if(this.observer){var n=this.observer.takeRecords();if(n.length){for(var r=0;r<n.length;r++)this.queue.push(n[r]);window.setTimeout(function(){return t.flush()},20)}this.observer.disconnect()}Bs&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()};ce.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)};ce.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)};ce.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout(function(){return t.suppressingSelectionUpdates=!1},50)};ce.prototype.onSelectionChange=function(){if(!!Dv(this.view)){if(this.suppressingSelectionUpdates)return hn(this.view);if(x.ie&&x.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&zo(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}};ce.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())};ce.prototype.ignoreSelectionChange=function(t){if(t.rangeCount==0)return!0;var n=t.getRangeAt(0).commonAncestorContainer,r=this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0};ce.prototype.flush=function(){if(!(!this.view.docView||this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var n=this.view.root.getSelection(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Es(this.view)&&!this.ignoreSelectionChange(n),o=-1,i=-1,s=!1,a=[];if(this.view.editable)for(var c=0;c<t.length;c++){var l=this.registerMutation(t[c],a);l&&(o=o<0?l.from:Math.min(l.from,o),i=i<0?l.to:Math.max(l.to,i),l.typeOver&&(s=!0))}if(x.gecko&&a.length>1){var u=a.filter(function(h){return h.nodeName=="BR"});if(u.length==2){var f=u[0],p=u[1];f.parentNode&&f.parentNode.parentNode==p.parentNode?p.remove():f.remove()}}(o>-1||r)&&(o>-1&&(this.view.docView.markDirty(o,i),Yv(this.view)),this.handleDOMChange(o,i,s,a),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(n)||hn(this.view),this.currentSelection.set(n))}};ce.prototype.registerMutation=function(t,n){if(n.indexOf(t.target)>-1)return null;var r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(var o=0;o<t.addedNodes.length;o++)n.push(t.addedNodes[o]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};var i=t.previousSibling,s=t.nextSibling;if(x.ie&&x.ie_version<=11&&t.addedNodes.length)for(var a=0;a<t.addedNodes.length;a++){var c=t.addedNodes[a],l=c.previousSibling,u=c.nextSibling;(!l||Array.prototype.indexOf.call(t.addedNodes,l)<0)&&(i=l),(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(s=u)}var f=i&&i.parentNode==t.target?ae(i)+1:0,p=r.localPosFromDOM(t.target,f,-1),h=s&&s.parentNode==t.target?ae(s):t.target.childNodes.length,d=r.localPosFromDOM(t.target,h,1);return{from:p,to:d}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var ku=!1;function Yv(e){ku||(ku=!0,getComputedStyle(e.dom).whiteSpace=="normal"&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))}var re={},Kt={};function Xv(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.lastIOSEnter=0,e.lastIOSEnterFallbackTimeout=null,e.lastAndroidDelete=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new ce(e,function(r,o,i,s){return Vv(e,r,o,i,s)}),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(r){var o=re[r];e.dom.addEventListener(r,e.eventHandlers[r]=function(i){Qv(e,i)&&!Fs(e,i)&&(e.editable||!(i.type in Kt))&&o(e,i)})};for(var n in re)t(n);x.safari&&e.dom.addEventListener("input",function(){return null}),zs(e)}function Bn(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function Zv(e){e.domObserver.stop();for(var t in e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout),clearTimeout(e.lastIOSEnterFallbackTimeout)}function zs(e){e.someProp("handleDOMEvents",function(t){for(var n in t)e.eventHandlers[n]||e.dom.addEventListener(n,e.eventHandlers[n]=function(r){return Fs(e,r)})})}function Fs(e,t){return e.someProp("handleDOMEvents",function(n){var r=n[t.type];return r?r(e,t)||t.defaultPrevented:!1})}function Qv(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function tm(e,t){!Fs(e,t)&&re[t.type]&&(e.editable||!(t.type in Kt))&&re[t.type](e,t)}Kt.keydown=function(e,t){if(e.shiftKey=t.keyCode==16||t.shiftKey,!Ou(e,t))if(t.keyCode!=229&&e.domObserver.forceFlush(),e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),x.ios&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){var n=Date.now();e.lastIOSEnter=n,e.lastIOSEnterFallbackTimeout=setTimeout(function(){e.lastIOSEnter==n&&(e.someProp("handleKeyDown",function(r){return r(e,ir(13,"Enter"))}),e.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",function(r){return r(e,t)})||zv(e,t)?t.preventDefault():Bn(e,"key")};Kt.keyup=function(e,t){t.keyCode==16&&(e.shiftKey=!1)};Kt.keypress=function(e,t){if(!(Ou(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||x.mac&&t.metaKey)){if(e.someProp("handleKeyPress",function(o){return o(e,t)})){t.preventDefault();return}var n=e.state.selection;if(!(n instanceof K)||!n.$from.sameParent(n.$to)){var r=String.fromCharCode(t.charCode);e.someProp("handleTextInput",function(o){return o(e,n.$from.pos,n.$to.pos,r)})||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}}};function $o(e){return{left:e.clientX,top:e.clientY}}function em(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}function $s(e,t,n,r,o){if(r==-1)return!1;for(var i=e.state.doc.resolve(r),s=function(l){if(e.someProp(t,function(u){return l>i.depth?u(e,n,i.nodeAfter,i.before(l),o,!0):u(e,n,i.node(l),i.before(l),o,!1)}))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function ar(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);n=="pointer"&&r.setMeta("pointer",!0),e.dispatch(r)}function nm(e,t){if(t==-1)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return r&&r.isAtom&&L.isSelectable(r)?(ar(e,new L(n),"pointer"),!0):!1}function rm(e,t){if(t==-1)return!1;var n=e.state.selection,r,o;n instanceof L&&(r=n.node);for(var i=e.state.doc.resolve(t),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(L.isSelectable(a)){r&&n.$from.depth>0&&s>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?o=i.before(n.$from.depth):o=i.before(s);break}}return o!=null?(ar(e,L.create(e.state.doc,o),"pointer"),!0):!1}function om(e,t,n,r,o){return $s(e,"handleClickOn",t,n,r)||e.someProp("handleClick",function(i){return i(e,t,r)})||(o?rm(e,n):nm(e,n))}function im(e,t,n,r){return $s(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",function(o){return o(e,t,r)})}function sm(e,t,n,r){return $s(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",function(o){return o(e,t,r)})||am(e,n,r)}function am(e,t,n){if(n.button!=0)return!1;var r=e.state.doc;if(t==-1)return r.inlineContent?(ar(e,K.create(r,0,r.content.size),"pointer"),!0):!1;for(var o=r.resolve(t),i=o.depth+1;i>0;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)ar(e,K.create(r,a+1,a+1+s.content.size),"pointer");else if(L.isSelectable(s))ar(e,L.create(r,a),"pointer");else continue;return!0}}function Vs(e){return Ho(e)}var Su=x.mac?"metaKey":"ctrlKey";re.mousedown=function(e,t){e.shiftKey=t.shiftKey;var n=Vs(e),r=Date.now(),o="singleClick";r-e.lastClick.time<500&&em(t,e.lastClick)&&!t[Su]&&(e.lastClick.type=="singleClick"?o="doubleClick":e.lastClick.type=="doubleClick"&&(o="tripleClick")),e.lastClick={time:r,x:t.clientX,y:t.clientY,type:o};var i=e.posAtCoords($o(t));!i||(o=="singleClick"?(e.mouseDown&&e.mouseDown.done(),e.mouseDown=new Vo(e,i,t,n)):(o=="doubleClick"?im:sm)(e,i.pos,i.inside,t)?t.preventDefault():Bn(e,"pointer"))};var Vo=function(t,n,r,o){var i=this;this.view=t,this.startDoc=t.state.doc,this.pos=n,this.event=r,this.flushed=o,this.selectNode=r[Su],this.allowDefault=r.shiftKey,this.delayedSelectionSync=!1;var s,a;if(n.inside>-1)s=t.state.doc.nodeAt(n.inside),a=n.inside;else{var c=t.state.doc.resolve(n.pos);s=c.parent,a=c.depth?c.before():0}this.mightDrag=null;var l=o?null:r.target,u=l?t.docView.nearestDesc(l,!0):null;this.target=u?u.dom:null;var f=t.state,p=f.selection;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||p instanceof L&&p.from<=a&&p.to>a)&&(this.mightDrag={node:s,pos:a,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&x.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){i.view.mouseDown==i&&i.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Bn(t,"pointer")};Vo.prototype.done=function(){var t=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(function(){return hn(t.view)}),this.view.mouseDown=null};Vo.prototype.up=function(t){if(this.done(),!!this.view.dom.contains(t.target.nodeType==3?t.target.parentNode:t.target)){var n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords($o(t))),this.allowDefault||!n?Bn(this.view,"pointer"):om(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||x.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||x.chrome&&!(this.view.state.selection instanceof K)&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(ar(this.view,z.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):Bn(this.view,"pointer")}};Vo.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),Bn(this.view,"pointer"),t.buttons==0&&this.done()};re.touchdown=function(e){Vs(e),Bn(e,"pointer")};re.contextmenu=function(e){return Vs(e)};function Ou(e,t){return e.composing?!0:x.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500?(e.compositionEndedAt=-2e8,!0):!1}var cm=x.android?5e3:-1;Kt.compositionstart=Kt.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(function(a){return a.type.spec.inclusive===!1})))e.markCursor=e.state.storedMarks||n.marks(),Ho(e,!0),e.markCursor=null;else if(Ho(e),x.gecko&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&o.nodeType==1&&i!=0;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(s.nodeType==3){r.collapse(s,s.nodeValue.length);break}else o=s,i=-1}e.composing=!0}xu(e,cm)};Kt.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,xu(e,20))};function xu(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout(function(){return Ho(e)},t))}function Mu(e){for(e.composing&&(e.composing=!1,e.compositionEndedAt=lm());e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty()}function lm(){var e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function Ho(e,t){if(e.domObserver.forceFlush(),Mu(e),t||e.docView.dirty){var n=Ql(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}function um(e,t){if(!!e.dom.parentNode){var n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(function(){n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}}var cr=x.ie&&x.ie_version<15||x.ios&&x.webkit_version<604;re.copy=Kt.cut=function(e,t){var n=e.state.selection,r=t.type=="cut";if(!n.empty){var o=cr?null:t.clipboardData,i=n.content(),s=pu(e,i),a=s.dom,c=s.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",c)):um(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}};function fm(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function pm(e,t){if(!!e.dom.parentNode){var n=e.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(function(){e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Hs(e,r.value,null,t):Hs(e,r.textContent,r.innerHTML,t)},50)}}function Hs(e,t,n,r){var o=hu(e,t,n,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",function(a){return a(e,r,o||_.empty)}))return!0;if(!o)return!1;var i=fm(o),s=i?e.state.tr.replaceSelectionWith(i,e.shiftKey):e.state.tr.replaceSelection(o);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Kt.paste=function(e,t){var n=cr?null:t.clipboardData;n&&Hs(e,n.getData("text/plain"),n.getData("text/html"),t)?t.preventDefault():pm(e,t)};var hm=function(t,n){this.slice=t,this.move=n},Cu=x.mac?"altKey":"ctrlKey";re.dragstart=function(e,t){var n=e.mouseDown;if(n&&n.done(),!!t.dataTransfer){var r=e.state.selection,o=r.empty?null:e.posAtCoords($o(t));if(!(o&&o.pos>=r.from&&o.pos<=(r instanceof L?r.to-1:r.to))){if(n&&n.mightDrag)e.dispatch(e.state.tr.setSelection(L.create(e.state.doc,n.mightDrag.pos)));else if(t.target&&t.target.nodeType==1){var i=e.docView.nearestDesc(t.target,!0);i&&i.node.type.spec.draggable&&i!=e.docView&&e.dispatch(e.state.tr.setSelection(L.create(e.state.doc,i.posBefore)))}}var s=e.state.selection.content(),a=pu(e,s),c=a.dom,l=a.text;t.dataTransfer.clearData(),t.dataTransfer.setData(cr?"Text":"text/html",c.innerHTML),t.dataTransfer.effectAllowed="copyMove",cr||t.dataTransfer.setData("text/plain",l),e.dragging=new hm(s,!t[Cu])}};re.dragend=function(e){var t=e.dragging;window.setTimeout(function(){e.dragging==t&&(e.dragging=null)},50)};Kt.dragover=Kt.dragenter=function(e,t){return t.preventDefault()};Kt.drop=function(e,t){var n=e.dragging;if(e.dragging=null,!!t.dataTransfer){var r=e.posAtCoords($o(t));if(!!r){var o=e.state.doc.resolve(r.pos);if(!!o){var i=n&&n.slice;i?e.someProp("transformPasted",function(d){i=d(i)}):i=hu(e,t.dataTransfer.getData(cr?"Text":"text/plain"),cr?null:t.dataTransfer.getData("text/html"),!1,o);var s=n&&!t[Cu];if(e.someProp("handleDrop",function(d){return d(e,t,i||_.empty,s)})){t.preventDefault();return}if(!!i){t.preventDefault();var a=i?ol(e.state.doc,o.pos,i):o.pos;a==null&&(a=o.pos);var c=e.state.tr;s&&c.deleteSelection();var l=c.mapping.map(a),u=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,f=c.doc;if(u?c.replaceRangeWith(l,l,i.content.firstChild):c.replaceRange(l,l,i),!c.doc.eq(f)){var p=c.doc.resolve(l);if(u&&L.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new L(p));else{var h=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach(function(d,v,g,b){return h=b}),c.setSelection(_s(e,p,c.doc.resolve(h)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}}}}}};re.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.root.getSelection())&&hn(e)},20))};re.blur=function(e,t){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.set({}),e.focused=!1)};re.beforeinput=function(e,t){if(x.chrome&&x.android&&t.inputType=="deleteContentBackward"){var n=e.domChangeCount;setTimeout(function(){if(e.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",function(i){return i(e,ir(8,"Backspace"))}))){var r=e.state.selection,o=r.$cursor;o&&o.pos>0&&e.dispatch(e.state.tr.delete(o.pos-1,o.pos).scrollIntoView())}},50)}};for(var Tu in Kt)re[Tu]=Kt[Tu];function jr(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}var Jr=function(t,n){this.spec=n||Ln,this.side=this.spec.side||0,this.toDOM=t};Jr.prototype.map=function(t,n,r,o){var i=t.mapResult(n.from+o,this.side<0?-1:1),s=i.pos,a=i.deleted;return a?null:new ht(s-r,s-r,this)};Jr.prototype.valid=function(){return!0};Jr.prototype.eq=function(t){return this==t||t instanceof Jr&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&jr(this.spec,t.spec))};var Te=function(t,n){this.spec=n||Ln,this.attrs=t};Te.prototype.map=function(t,n,r,o){var i=t.map(n.from+o,this.spec.inclusiveStart?-1:1)-r,s=t.map(n.to+o,this.spec.inclusiveEnd?1:-1)-r;return i>=s?null:new ht(i,s,this)};Te.prototype.valid=function(t,n){return n.from<n.to};Te.prototype.eq=function(t){return this==t||t instanceof Te&&jr(this.attrs,t.attrs)&&jr(this.spec,t.spec)};Te.is=function(t){return t.type instanceof Te};var Wr=function(t,n){this.spec=n||Ln,this.attrs=t};Wr.prototype.map=function(t,n,r,o){var i=t.mapResult(n.from+o,1);if(i.deleted)return null;var s=t.mapResult(n.to+o,-1);return s.deleted||s.pos<=i.pos?null:new ht(i.pos-r,s.pos-r,this)};Wr.prototype.valid=function(t,n){var r=t.content.findIndex(n.from),o=r.index,i=r.offset,s;return i==n.from&&!(s=t.child(o)).isText&&i+s.nodeSize==n.to};Wr.prototype.eq=function(t){return this==t||t instanceof Wr&&jr(this.attrs,t.attrs)&&jr(this.spec,t.spec)};var ht=function(t,n,r){this.from=t,this.to=n,this.type=r},js={spec:{configurable:!0},inline:{configurable:!0}};ht.prototype.copy=function(t,n){return new ht(t,n,this.type)};ht.prototype.eq=function(t,n){return n===void 0&&(n=0),this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to};ht.prototype.map=function(t,n,r){return this.type.map(t,this,n,r)};ht.widget=function(t,n,r){return new ht(t,t,new Jr(n,r))};ht.inline=function(t,n,r,o){return new ht(t,n,new Te(r,o))};ht.node=function(t,n,r,o){return new ht(t,n,new Wr(r,o))};js.spec.get=function(){return this.type.spec};js.inline.get=function(){return this.type instanceof Te};Object.defineProperties(ht.prototype,js);var jo=[],Ln={},Q=function(t,n){this.local=t&&t.length?t:jo,this.children=n&&n.length?n:jo};Q.create=function(t,n){return n.length?Jo(n,t,0,Ln):Tt};Q.prototype.find=function(t,n,r){var o=[];return this.findInner(t==null?0:t,n==null?1e9:n,o,0,r),o};Q.prototype.findInner=function(t,n,r,o,i){for(var s=0;s<this.local.length;s++){var a=this.local[s];a.from<=n&&a.to>=t&&(!i||i(a.spec))&&r.push(a.copy(a.from+o,a.to+o))}for(var c=0;c<this.children.length;c+=3)if(this.children[c]<n&&this.children[c+1]>t){var l=this.children[c]+1;this.children[c+2].findInner(t-l,n-l,r,o+l,i)}};Q.prototype.map=function(t,n,r){return this==Tt||t.maps.length==0?this:this.mapInner(t,n,0,0,r||Ln)};Q.prototype.mapInner=function(t,n,r,o,i){for(var s,a=0;a<this.local.length;a++){var c=this.local[a].map(t,r,o);c&&c.type.valid(n,c)?(s||(s=[])).push(c):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?dm(this.children,s,t,n,r,o,i):s?new Q(s.sort(zn)):Tt};Q.prototype.add=function(t,n){return n.length?this==Tt?Q.create(t,n):this.addInner(t,n,0):this};Q.prototype.addInner=function(t,n,r){var o=this,i,s=0;t.forEach(function(l,u){var f=u+r,p;if(!!(p=Eu(n,l,f))){for(i||(i=o.children.slice());s<i.length&&i[s]<u;)s+=3;i[s]==u?i[s+2]=i[s+2].addInner(l,p,f+1):i.splice(s,0,u,u+l.nodeSize,Jo(p,l,f+1,Ln)),s+=3}});for(var a=_u(s?Au(n):n,-r),c=0;c<a.length;c++)a[c].type.valid(t,a[c])||a.splice(c--,1);return new Q(a.length?this.local.concat(a).sort(zn):this.local,i||this.children)};Q.prototype.remove=function(t){return t.length==0||this==Tt?this:this.removeInner(t,0)};Q.prototype.removeInner=function(t,n){for(var r=this.children,o=this.local,i=0;i<r.length;i+=3){for(var s=void 0,a=r[i]+n,c=r[i+1]+n,l=0,u=void 0;l<t.length;l++)(u=t[l])&&u.from>a&&u.to<c&&(t[l]=null,(s||(s=[])).push(u));if(!!s){r==this.children&&(r=this.children.slice());var f=r[i+2].removeInner(s,a+1);f!=Tt?r[i+2]=f:(r.splice(i,3),i-=3)}}if(o.length){for(var p=0,h=void 0;p<t.length;p++)if(h=t[p])for(var d=0;d<o.length;d++)o[d].eq(h,n)&&(o==this.local&&(o=this.local.slice()),o.splice(d--,1))}return r==this.children&&o==this.local?this:o.length||r.length?new Q(o,r):Tt};Q.prototype.forChild=function(t,n){if(this==Tt)return this;if(n.isLeaf)return Q.empty;for(var r,o,i=0;i<this.children.length;i+=3)if(this.children[i]>=t){this.children[i]==t&&(r=this.children[i+2]);break}for(var s=t+1,a=s+n.content.size,c=0;c<this.local.length;c++){var l=this.local[c];if(l.from<a&&l.to>s&&l.type instanceof Te){var u=Math.max(s,l.from)-s,f=Math.min(a,l.to)-s;u<f&&(o||(o=[])).push(l.copy(u,f))}}if(o){var p=new Q(o.sort(zn));return r?new ge([p,r]):p}return r||Tt};Q.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof Q)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(var r=0;r<this.children.length;r+=3)if(this.children[r]!=t.children[r]||this.children[r+1]!=t.children[r+1]||!this.children[r+2].eq(t.children[r+2]))return!1;return!0};Q.prototype.locals=function(t){return Js(this.localsInner(t))};Q.prototype.localsInner=function(t){if(this==Tt)return jo;if(t.inlineContent||!this.local.some(Te.is))return this.local;for(var n=[],r=0;r<this.local.length;r++)this.local[r].type instanceof Te||n.push(this.local[r]);return n};var Tt=new Q;Q.empty=Tt;Q.removeOverlap=Js;var ge=function(t){this.members=t};ge.prototype.map=function(t,n){var r=this.members.map(function(o){return o.map(t,n,Ln)});return ge.from(r)};ge.prototype.forChild=function(t,n){if(n.isLeaf)return Q.empty;for(var r=[],o=0;o<this.members.length;o++){var i=this.members[o].forChild(t,n);i!=Tt&&(i instanceof ge?r=r.concat(i.members):r.push(i))}return ge.from(r)};ge.prototype.eq=function(t){if(!(t instanceof ge)||t.members.length!=this.members.length)return!1;for(var n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0};ge.prototype.locals=function(t){for(var n,r=!0,o=0;o<this.members.length;o++){var i=this.members[o].localsInner(t);if(!!i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(var s=0;s<i.length;s++)n.push(i[s])}}return n?Js(r?n:n.sort(zn)):jo};ge.from=function(t){switch(t.length){case 0:return Tt;case 1:return t[0];default:return new ge(t)}};function dm(e,t,n,r,o,i,s){for(var a=e.slice(),c=function(it,W,H,mt){for(var Z=0;Z<a.length;Z+=3){var Y=a[Z+1],gt=void 0;Y==-1||it>Y+i||(W>=a[Z]+i?a[Z+1]=-1:H>=o&&(gt=mt-H-(W-it))&&(a[Z]+=gt,a[Z+1]+=gt))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,f=0;f<a.length;f+=3)if(a[f+1]==-1){var p=n.map(e[f]+i),h=p-o;if(h<0||h>=r.content.size){u=!0;continue}var d=n.map(e[f+1]+i,-1),v=d-o,g=r.content.findIndex(h),b=g.index,y=g.offset,M=r.maybeChild(b);if(M&&y==h&&y+M.nodeSize==v){var m=a[f+2].mapInner(n,M,p+1,e[f]+i+1,s);m!=Tt?(a[f]=h,a[f+1]=v,a[f+2]=m):(a[f+1]=-2,u=!0)}else u=!0}if(u){var C=vm(a,e,t||[],n,o,i,s),O=Jo(C,r,0,s);t=O.local;for(var E=0;E<a.length;E+=3)a[E+1]<0&&(a.splice(E,3),E-=3);for(var P=0,D=0;P<O.children.length;P+=3){for(var F=O.children[P];D<a.length&&a[D]<F;)D+=3;a.splice(D,0,O.children[P],O.children[P+1],O.children[P+2])}}return new Q(t&&t.sort(zn),a)}function _u(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(new ht(o.from+t,o.to+t,o.type))}return n}function vm(e,t,n,r,o,i,s){function a(l,u){for(var f=0;f<l.local.length;f++){var p=l.local[f].map(r,o,u);p?n.push(p):s.onRemove&&s.onRemove(l.local[f].spec)}for(var h=0;h<l.children.length;h+=3)a(l.children[h+2],l.children[h]+u+1)}for(var c=0;c<e.length;c+=3)e[c+1]==-1&&a(e[c+2],t[c]+i+1);return n}function Eu(e,t,n){if(t.isLeaf)return null;for(var r=n+t.nodeSize,o=null,i=0,s=void 0;i<e.length;i++)(s=e[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),e[i]=null);return o}function Au(e){for(var t=[],n=0;n<e.length;n++)e[n]!=null&&t.push(e[n]);return t}function Jo(e,t,n,r){var o=[],i=!1;t.forEach(function(c,l){var u=Eu(e,c,l+n);if(u){i=!0;var f=Jo(u,c,n+l+1,r);f!=Tt&&o.push(l,l+c.nodeSize,f)}});for(var s=_u(i?Au(e):e,-n).sort(zn),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Q(s,o):Tt}function zn(e,t){return e.from-t.from||e.to-t.to}function Js(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var o=n+1;o<t.length;o++){var i=t[o];if(i.from==r.from){i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),Nu(t,o+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),Nu(t,o,r.copy(i.from,r.to)));break}}}return t}function Nu(e,t,n){for(;t<e.length&&zn(n,e[t])>0;)t++;e.splice(t,0,n)}function Ws(e){var t=[];return e.someProp("decorations",function(n){var r=n(e.state);r&&r!=Tt&&t.push(r)}),e.cursorWrapper&&t.push(Q.create(e.state.doc,[e.cursorWrapper.deco])),ge.from(t)}var dt=function(t,n){this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Bu),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Du(this),this.markCursor=null,this.cursorWrapper=null,Pu(this),this.nodeViews=Ru(this),this.docView=ql(this.state.doc,Iu(this),Ws(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,Xv(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},qs={props:{configurable:!0},root:{configurable:!0}};qs.props.get=function(){if(this._props.state!=this.state){var e=this._props;this._props={};for(var t in e)this._props[t]=e[t];this._props.state=this.state}return this._props};dt.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&zs(this),this._props=t,t.plugins&&(t.plugins.forEach(Bu),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)};dt.prototype.setProps=function(t){var n={};for(var r in this._props)n[r]=this._props[r];n.state=this.state;for(var o in t)n[o]=t[o];this.update(n)};dt.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)};dt.prototype.updateStateInner=function(t,n){var r=this,o=this.state,i=!1,s=!1;if(t.storedMarks&&this.composing&&(Mu(this),s=!0),this.state=t,n){var a=Ru(this);gm(a,this.nodeViews)&&(this.nodeViews=a,i=!0),zs(this)}this.editable=Du(this),Pu(this);var c=Ws(this),l=Iu(this),u=n?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",f=i||!this.docView.matchesNode(t.doc,l,c);(f||!t.selection.eq(o.selection))&&(s=!0);var p=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&uv(this);if(s){this.domObserver.stop();var h=f&&(x.ie||x.chrome)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&mm(o.selection,t.selection);if(f){var d=x.chrome?this.trackWrites=this.root.getSelection().focusNode:null;(i||!this.docView.update(t.doc,l,c,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=ql(t.doc,l,c,this.dom,this)),d&&!this.trackWrites&&(h=!0)}h||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&Rv(this))?hn(this,h):(ou(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),u=="reset")this.dom.scrollTop=0;else if(u=="to selection"){var v=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",function(g){return g(r)})||(t.selection instanceof L?Dl(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),v):Dl(this,this.coordsAtPos(t.selection.head,1),v))}else p&&fv(p)};dt.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()};dt.prototype.updatePluginViews=function(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var n=0;n<this.directPlugins.length;n++){var r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(var o=0;o<this.state.plugins.length;o++){var i=this.state.plugins[o];i.spec.view&&this.pluginViews.push(i.spec.view(this))}}else for(var s=0;s<this.pluginViews.length;s++){var a=this.pluginViews[s];a.update&&a.update(this,t)}};dt.prototype.someProp=function(t,n){var r=this._props&&this._props[t],o;if(r!=null&&(o=n?n(r):r))return o;for(var i=0;i<this.directPlugins.length;i++){var s=this.directPlugins[i].props[t];if(s!=null&&(o=n?n(s):s))return o}var a=this.state.plugins;if(a)for(var c=0;c<a.length;c++){var l=a[c].props[t];if(l!=null&&(o=n?n(l):l))return o}};dt.prototype.hasFocus=function(){return this.root.activeElement==this.dom};dt.prototype.focus=function(){this.domObserver.stop(),this.editable&&pv(this.dom),hn(this),this.domObserver.start()};qs.root.get=function(){var e=this._root;if(e==null){for(var t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return document.getSelection()}),this._root=t}return e||document};dt.prototype.posAtCoords=function(t){return gv(this,t)};dt.prototype.coordsAtPos=function(t,n){return n===void 0&&(n=1),Fl(this,t,n)};dt.prototype.domAtPos=function(t,n){return n===void 0&&(n=0),this.docView.domFromPos(t,n)};dt.prototype.nodeDOM=function(t){var n=this.docView.descAt(t);return n?n.nodeDOM:null};dt.prototype.posAtDOM=function(t,n,r){r===void 0&&(r=-1);var o=this.docView.posFromDOM(t,n,r);if(o==null)throw new RangeError("DOM position not inside the editor");return o};dt.prototype.endOfTextblock=function(t,n){return Sv(this,n||this.state,t)};dt.prototype.destroy=function(){!this.docView||(Zv(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Ws(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)};dt.prototype.dispatchEvent=function(t){return tm(this,t)};dt.prototype.dispatch=function(t){var n=this._props.dispatchTransaction;n?n.call(this,t):this.updateState(this.state.apply(t))};Object.defineProperties(dt.prototype,qs);function Iu(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),t.translate="no",e.someProp("attributes",function(n){if(typeof n=="function"&&(n=n(e.state)),n)for(var r in n)r=="class"&&(t.class+=" "+n[r]),r=="style"?t.style=(t.style?t.style+";":"")+n[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(n[r]))}),[ht.node(0,e.state.doc.content.size,t)]}function Pu(e){if(e.markCursor){var t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),e.cursorWrapper={dom:t,deco:ht.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Du(e){return!e.someProp("editable",function(t){return t(e.state)===!1})}function mm(e,t){var n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}function Ru(e){var t={};return e.someProp("nodeViews",function(n){for(var r in n)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=n[r])}),t}function gm(e,t){var n=0,r=0;for(var o in e){if(e[o]!=t[o])return!0;n++}for(var i in t)r++;return n!=r}function Bu(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var dn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},Wo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Lu=typeof navigator!="undefined"&&/Chrome\/(\d+)/.exec(navigator.userAgent),ym=typeof navigator!="undefined"&&/Apple Computer/.test(navigator.vendor),bm=typeof navigator!="undefined"&&/Gecko\/\d+/.test(navigator.userAgent),zu=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),wm=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),km=Lu&&(zu||+Lu[1]<57)||bm&&zu;for(var _t=0;_t<10;_t++)dn[48+_t]=dn[96+_t]=String(_t);for(var _t=1;_t<=24;_t++)dn[_t+111]="F"+_t;for(var _t=65;_t<=90;_t++)dn[_t]=String.fromCharCode(_t+32),Wo[_t]=String.fromCharCode(_t);for(var Ks in dn)Wo.hasOwnProperty(Ks)||(Wo[Ks]=dn[Ks]);function Sm(e){var t=km&&(e.ctrlKey||e.altKey||e.metaKey)||(ym||wm)&&e.shiftKey&&e.key&&e.key.length==1,n=!t&&e.key||(e.shiftKey?Wo:dn)[e.keyCode]||e.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}var Om=typeof navigator!="undefined"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function xm(e){var t=e.split(/-(?!$)/),n=t[t.length-1];n=="Space"&&(n=" ");for(var r,o,i,s,a=0;a<t.length-1;a++){var c=t[a];if(/^(cmd|meta|m)$/i.test(c))s=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))Om?s=!0:o=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(n="Alt-"+n),o&&(n="Ctrl-"+n),s&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function Mm(e){var t=Object.create(null);for(var n in e)t[xm(n)]=e[n];return t}function Us(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n!==!1&&t.shiftKey&&(e="Shift-"+e),e}function Cm(e){return new Ct({props:{handleKeyDown:Fu(e)}})}function Fu(e){var t=Mm(e);return function(n,r){var o=Sm(r),i=o.length==1&&o!=" ",s,a=t[Us(o,r,!i)];if(a&&a(n.state,n.dispatch,n))return!0;if(i&&(r.shiftKey||r.altKey||r.metaKey||o.charCodeAt(0)>127)&&(s=dn[r.keyCode])&&s!=o){var c=t[Us(s,r,!0)];if(c&&c(n.state,n.dispatch,n))return!0}else if(i&&r.shiftKey){var l=t[Us(o,r,!0)];if(l&&l(n.state,n.dispatch,n))return!0}return!1}}function Tm(e){return Object.prototype.toString.call(e).slice(8,-1)}function Gs(e){return Tm(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function qo(e,t){const n=S({},e);return Gs(e)&&Gs(t)&&Object.keys(t).forEach(r=>{Gs(t[r])?r in e?n[r]=qo(e[r],t[r]):Object.assign(n,{[r]:t[r]}):Object.assign(n,{[r]:t[r]})}),n}function $u(e){return typeof e=="function"}function $(e,t=void 0,...n){return $u(e)?t?e.bind(t)(...n):e(...n):e}function A(e,t,n){return e.config[t]===void 0&&e.parent?A(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind(Jt(S({},n),{parent:e.parent?A(e.parent,t,n):null})):e.config[t]}class kt{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=S(S({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=$(A(this,"addOptions",{name:this.name}))),this.storage=$(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new kt(t)}configure(t={}){const n=this.extend();return n.options=qo(this.options,t),n.storage=$(A(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new kt(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=t.defaultOptions?t.defaultOptions:n.parent.options,t.addOptions&&(n.options=$(A(n,"addOptions",{name:n.name}))),n.storage=$(A(n,"addStorage",{name:n.name,options:n.options})),n}}function Vu(e,t,n){const{from:r,to:o}=t,{blockSeparator:i=`

`,textSerializers:s={}}=n||{};let a="",c=!0;return e.nodesBetween(r,o,(l,u,f,p)=>{var h;const d=s==null?void 0:s[l.type.name];d?(l.isBlock&&!c&&(a+=i,c=!0),a+=d({node:l,pos:u,parent:f,index:p})):l.isText?(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,u)-u,o-u),c=!1):l.isBlock&&!c&&(a+=i,c=!0)}),a}function Hu(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const _m=kt.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Ct({key:new ne("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:o}=t,{from:i,to:s}=o,a=Hu(n);return Vu(r,{from:i,to:s},{textSerializers:a})}}})]}}),Em=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{e.isDestroyed||t.dom.blur()}),!0);var Am=Object.freeze({__proto__:null,blur:Em});const Nm=(e=!1)=>({commands:t})=>t.setContent("",e);var Im=Object.freeze({__proto__:null,clearContent:Nm});const Pm=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:o}=r;return o.forEach(i=>{e.doc.nodesBetween(i.$from.pos,i.$to.pos,(s,a)=>{if(s.type.isText)return;const c=t.doc.resolve(t.mapping.map(a)),l=t.doc.resolve(t.mapping.map(a+s.nodeSize)),u=c.blockRange(l);if(!u)return;const f=nr(u);if(s.type.isTextblock&&n){const{defaultType:p}=c.parent.contentMatchAt(c.index());t.setNodeMarkup(u.start,p)}(f||f===0)&&n&&t.lift(u,f)})}),!0};var Dm=Object.freeze({__proto__:null,clearNodes:Pm});const Rm=e=>t=>e(t);var Bm=Object.freeze({__proto__:null,command:Rm});const Lm=()=>({state:e,dispatch:t})=>Ml(e,t);var zm=Object.freeze({__proto__:null,createParagraphNear:Lm});function St(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}const Fm=e=>({tr:t,state:n,dispatch:r})=>{const o=St(e,n.schema),i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===o){if(r){const c=i.before(s),l=i.after(s);t.delete(c,l).scrollIntoView()}return!0}return!1};var $m=Object.freeze({__proto__:null,deleteNode:Fm});const Vm=e=>({tr:t,dispatch:n})=>{const{from:r,to:o}=e;return n&&t.delete(r,o),!0};var Hm=Object.freeze({__proto__:null,deleteRange:Vm});const jm=()=>({state:e,dispatch:t})=>fs(e,t);var Jm=Object.freeze({__proto__:null,deleteSelection:jm});const Wm=()=>({commands:e})=>e.keyboardShortcut("Enter");var qm=Object.freeze({__proto__:null,enter:Wm});const Km=()=>({state:e,dispatch:t})=>xl(e,t);var Um=Object.freeze({__proto__:null,exitCode:Km});function vn(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function Ys(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Ko(e,t,n={strict:!0}){const r=Object.keys(t);return r.length?r.every(o=>n.strict?t[o]===e[o]:Ys(t[o])?t[o].test(e[o]):t[o]===e[o]):!0}function Xs(e,t,n={}){return e.find(r=>r.type===t&&Ko(r.attrs,n))}function Gm(e,t,n={}){return!!Xs(e,t,n)}function ju(e,t,n={}){if(!e||!t)return;const r=e.parent.childAfter(e.parentOffset);if(!r.node)return;const o=Xs(r.node.marks,t,n);if(!o)return;let i=e.index(),s=e.start()+r.offset,a=i+1,c=s+r.node.nodeSize;for(Xs(r.node.marks,t,n);i>0&&o.isInSet(e.parent.child(i-1).marks);)i-=1,s-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&Gm(e.parent.child(a).marks,t,n);)c+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:c}}const Ym=(e,t={})=>({tr:n,state:r,dispatch:o})=>{const i=vn(e,r.schema),{doc:s,selection:a}=n,{$from:c,from:l,to:u}=a;if(o){const f=ju(c,i,t);if(f&&f.from<=l&&f.to>=u){const p=K.create(s,f.from,f.to);n.setSelection(p)}}return!0};var Xm=Object.freeze({__proto__:null,extendMarkRange:Ym});const Zm=e=>t=>{const n=typeof e=="function"?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1};var Qm=Object.freeze({__proto__:null,first:Zm});function Fn(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function tg(e){var t;return((t=e.constructor)===null||t===void 0?void 0:t.toString().substring(0,5))==="class"}function Zs(e){return e&&typeof e=="object"&&!Array.isArray(e)&&!tg(e)}function Ju(e){return Zs(e)&&e instanceof K}function eg(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function ng(e,t=null){if(!t)return null;if(t==="start"||t===!0)return{from:0,to:0};if(t==="end"){const{size:n}=e.doc.content;return{from:n,to:n}}return{from:t,to:t}}const rg=(e=null)=>({editor:t,view:n,tr:r,dispatch:o})=>{const i=()=>{eg()&&n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),t.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!Ju(t.state.selection))return i(),!0;const{from:s,to:a}=ng(t.state,e)||t.state.selection,{doc:c,storedMarks:l}=r,u=z.atStart(c).from,f=z.atEnd(c).to,p=Fn(s,u,f),h=Fn(a,u,f),d=K.create(c,p,h),v=t.state.selection.eq(d);return o&&(v||r.setSelection(d),v&&l&&r.setStoredMarks(l),i()),!0};var og=Object.freeze({__proto__:null,focus:rg});const ig=(e,t)=>n=>e.every((r,o)=>t(r,Jt(S({},n),{index:o})));var sg=Object.freeze({__proto__:null,forEach:ig});const ag=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t);var cg=Object.freeze({__proto__:null,insertContent:ag});function Wu(e){const t=`<body>${e}</body>`;return new window.DOMParser().parseFromString(t,"text/html").body}function Uo(e,t,n){if(n=S({slice:!0,parseOptions:{}},n),typeof e=="object"&&e!==null)try{return Array.isArray(e)?k.fromArray(e.map(r=>t.nodeFromJSON(r))):t.nodeFromJSON(e)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),Uo("",t,n)}if(typeof e=="string"){const r=Me.fromSchema(t);return n.slice?r.parseSlice(Wu(e),n.parseOptions).content:r.parse(Wu(e),n.parseOptions)}return Uo("",t,n)}function lg(e,t,n){const r=e.steps.length-1;if(r<t)return;const o=e.steps[r];if(!(o instanceof Ye||o instanceof ee))return;const i=e.mapping.maps[r];let s=0;i.forEach((a,c,l,u)=>{s===0&&(s=u)}),e.setSelection(z.near(e.doc.resolve(s),n))}const ug=(e,t,n)=>({tr:r,dispatch:o,editor:i})=>{if(o){n=S({parseOptions:{},updateSelection:!0},n);const s=Uo(t,i.schema,{parseOptions:S({preserveWhitespace:"full"},n.parseOptions)});if(s.toString()==="<>")return!0;const{from:a,to:c}=typeof e=="number"?{from:e,to:e}:e;r.replaceWith(a,c,s),n.updateSelection&&lg(r,r.steps.length-1,1)}return!0};var fg=Object.freeze({__proto__:null,insertContentAt:ug});const pg=()=>({state:e,dispatch:t})=>ml(e,t);var hg=Object.freeze({__proto__:null,joinBackward:pg});const dg=()=>({state:e,dispatch:t})=>bl(e,t);var vg=Object.freeze({__proto__:null,joinForward:dg});const mg=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1;function gg(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let r,o,i,s;for(let a=0;a<t.length-1;a+=1){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))s=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))mg?s=!0:o=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return r&&(n=`Alt-${n}`),o&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}const yg=e=>({editor:t,view:n,tr:r,dispatch:o})=>{const i=gg(e).split(/-(?!$)/),s=i.find(l=>!["Alt","Ctrl","Meta","Shift"].includes(l)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{n.someProp("handleKeyDown",l=>l(n,a))});return c==null||c.steps.forEach(l=>{const u=l.map(r.mapping);u&&o&&r.maybeStep(u)}),!0};var bg=Object.freeze({__proto__:null,keyboardShortcut:yg});function lr(e,t,n={}){const{from:r,to:o,empty:i}=e.selection,s=t?St(t,e.schema):null,a=[];e.doc.nodesBetween(r,o,(f,p)=>{if(f.isText)return;const h=Math.max(r,p),d=Math.min(o,p+f.nodeSize);a.push({node:f,from:h,to:d})});const c=o-r,l=a.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>Ko(f.node.attrs,n,{strict:!1}));return i?!!l.length:l.reduce((f,p)=>f+p.to-p.from,0)>=c}const wg=(e,t={})=>({state:n,dispatch:r})=>{const o=St(e,n.schema);return lr(n,o,t)?Sl(n,r):!1};var kg=Object.freeze({__proto__:null,lift:wg});const Sg=()=>({state:e,dispatch:t})=>Cl(e,t);var Og=Object.freeze({__proto__:null,liftEmptyBlock:Sg});const xg=e=>({state:t,dispatch:n})=>{const r=St(e,t.schema);return ev(r)(t,n)};var Mg=Object.freeze({__proto__:null,liftListItem:xg});const Cg=()=>({state:e,dispatch:t})=>Ol(e,t);var Tg=Object.freeze({__proto__:null,newlineInCode:Cg});function Go(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function qu(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((r,o)=>(n.includes(o)||(r[o]=e[o]),r),{})}const _g=(e,t)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=Go(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(i=St(e,r.schema)),a==="mark"&&(s=vn(e,r.schema)),o&&n.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(l,u)=>{i&&i===l.type&&n.setNodeMarkup(u,void 0,qu(l.attrs,t)),s&&l.marks.length&&l.marks.forEach(f=>{s===f.type&&n.addMark(u,u+l.nodeSize,s.create(qu(f.attrs,t)))})})}),!0):!1};var Eg=Object.freeze({__proto__:null,resetAttributes:_g});const Ag=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0);var Ng=Object.freeze({__proto__:null,scrollIntoView:Ag});const Ig=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size});var Pg=Object.freeze({__proto__:null,selectAll:Ig});const Dg=()=>({state:e,dispatch:t})=>gl(e,t);var Rg=Object.freeze({__proto__:null,selectNodeBackward:Dg});const Bg=()=>({state:e,dispatch:t})=>wl(e,t);var Lg=Object.freeze({__proto__:null,selectNodeForward:Bg});const zg=()=>({state:e,dispatch:t})=>Ud(e,t);var Fg=Object.freeze({__proto__:null,selectParentNode:zg});function Ku(e,t,n={}){return Uo(e,t,{slice:!1,parseOptions:n})}const $g=(e,t=!1,n={})=>({tr:r,editor:o,dispatch:i})=>{const{doc:s}=r,a=Ku(e,o.schema,n),c=K.create(s,0,s.content.size);return i&&r.setSelection(c).replaceSelectionWith(a,!1).setMeta("preventUpdate",!t),!0};var Vg=Object.freeze({__proto__:null,setContent:$g});function Uu(e,t){const n=vn(t,e.schema),{from:r,to:o,empty:i}=e.selection,s=[];i?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,o,c=>{s.push(...c.marks)});const a=s.find(c=>c.type.name===n.name);return a?S({},a.attrs):{}}const Hg=(e,t={})=>({tr:n,state:r,dispatch:o})=>{const{selection:i}=n,{empty:s,ranges:a}=i,c=vn(e,r.schema);if(o)if(s){const l=Uu(r,c);n.addStoredMark(c.create(S(S({},l),t)))}else a.forEach(l=>{const u=l.$from.pos,f=l.$to.pos;r.doc.nodesBetween(u,f,(p,h)=>{const d=Math.max(h,u),v=Math.min(h+p.nodeSize,f);p.marks.find(b=>b.type===c)?p.marks.forEach(b=>{c===b.type&&n.addMark(d,v,c.create(S(S({},b.attrs),t)))}):n.addMark(d,v,c.create(t))})});return!0};var jg=Object.freeze({__proto__:null,setMark:Hg});const Jg=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0);var Wg=Object.freeze({__proto__:null,setMeta:Jg});const qg=(e,t={})=>({state:n,dispatch:r})=>{const o=St(e,n.schema);return Xd(o,t)(n,r)};var Kg=Object.freeze({__proto__:null,setNode:qg});const Ug=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,o=z.atStart(r).from,i=z.atEnd(r).to,s=Fn(e,o,i),a=L.create(r,s);t.setSelection(a)}return!0};var Gg=Object.freeze({__proto__:null,setNodeSelection:Ug});const Yg=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:o,to:i}=typeof e=="number"?{from:e,to:e}:e,s=z.atStart(r).from,a=z.atEnd(r).to,c=Fn(o,s,a),l=Fn(i,s,a),u=K.create(r,c,l);t.setSelection(u)}return!0};var Xg=Object.freeze({__proto__:null,setTextSelection:Yg});const Zg=e=>({state:t,dispatch:n})=>{const r=St(e,t.schema);return ov(r)(t,n)};var Qg=Object.freeze({__proto__:null,sinkListItem:Zg});function Yo(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const o=e.find(i=>i.type===t&&i.name===r);return o?o.attribute.keepOnSplit:!1}))}function ty(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Gu(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(o=>t==null?void 0:t.includes(o.type.name));e.tr.ensureMarks(r)}}const ey=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:o})=>{const{selection:i,doc:s}=t,{$from:a,$to:c}=i,l=o.extensionManager.attributes,u=Yo(l,a.node().type.name,a.node().attrs);if(i instanceof L&&i.node.isBlock)return!a.parentOffset||!Xe(s,a.pos)?!1:(r&&(e&&Gu(n,o.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const f=c.parentOffset===c.parent.content.size;i instanceof K&&t.deleteSelection();const p=a.depth===0?void 0:ty(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=f&&p?[{type:p,attrs:u}]:void 0,d=Xe(t.doc,t.mapping.map(a.pos),1,h);if(!h&&!d&&Xe(t.doc,t.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(d=!0,h=p?[{type:p,attrs:u}]:void 0),d&&(t.split(t.mapping.map(a.pos),1,h),p&&!f&&!a.parentOffset&&a.parent.type!==p)){const v=t.mapping.map(a.before()),g=t.doc.resolve(v);a.node(-1).canReplaceWith(g.index(),g.index()+1,p)&&t.setNodeMarkup(t.mapping.map(a.before()),p)}e&&Gu(n,o.extensionManager.splittableMarks),t.scrollIntoView()}return!0};var ny=Object.freeze({__proto__:null,splitBlock:ey});const ry=e=>({tr:t,state:n,dispatch:r,editor:o})=>{var i;const s=St(e,n.schema),{$from:a,$to:c}=n.selection,l=n.selection.node;if(l&&l.isBlock||a.depth<2||!a.sameParent(c))return!1;const u=a.node(-1);if(u.type!==s)return!1;const f=o.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let g=k.empty;const b=a.index(-1)?1:a.index(-2)?2:3;for(let E=a.depth-b;E>=a.depth-3;E-=1)g=k.from(a.node(E).copy(g));const y=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,M=Yo(f,a.node().type.name,a.node().attrs),m=((i=s.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(M))||void 0;g=g.append(k.from(s.createAndFill(null,m)||void 0));const C=a.before(a.depth-(b-1));t.replace(C,a.after(-y),new _(g,4-b,0));let O=-1;t.doc.nodesBetween(C,t.doc.content.size,(E,P)=>{if(O>-1)return!1;E.isTextblock&&E.content.size===0&&(O=P+1)}),O>-1&&t.setSelection(K.near(t.doc.resolve(O))),t.scrollIntoView()}return!0}const p=c.pos===a.end()?u.contentMatchAt(0).defaultType:null,h=Yo(f,u.type.name,u.attrs),d=Yo(f,a.node().type.name,a.node().attrs);t.delete(a.pos,c.pos);const v=p?[{type:s,attrs:h},{type:p,attrs:d}]:[{type:s,attrs:h}];return Xe(t.doc,a.pos,2)?(r&&t.split(a.pos,2,v).scrollIntoView(),!0):!1};var oy=Object.freeze({__proto__:null,splitListItem:ry});function iy(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function sy(e){return t=>iy(t.$from,e)}function Xo(e){const t=e.filter(o=>o.type==="extension"),n=e.filter(o=>o.type==="node"),r=e.filter(o=>o.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}function Yu(e,t){const{nodeExtensions:n}=Xo(t),r=n.find(s=>s.name===e);if(!r)return!1;const o={name:r.name,options:r.options,storage:r.storage},i=$(A(r,"group",o));return typeof i!="string"?!1:i.split(" ").includes("list")}const ay=(e,t)=>({editor:n,tr:r,state:o,dispatch:i,chain:s,commands:a,can:c})=>{const{extensions:l}=n.extensionManager,u=St(e,o.schema),f=St(t,o.schema),{selection:p}=o,{$from:h,$to:d}=p,v=h.blockRange(d);if(!v)return!1;const g=sy(y=>Yu(y.type.name,l))(p);if(v.depth>=1&&g&&v.depth-g.depth<=1){if(g.node.type===u)return a.liftListItem(f);if(Yu(g.node.type.name,l)&&u.validContent(g.node.content)&&i)return r.setNodeMarkup(g.pos,u),!0}return c().wrapInList(u)?a.wrapInList(u):s().clearNodes().wrapInList(u).run()};var cy=Object.freeze({__proto__:null,toggleList:ay});function Qs(e,t,n={}){const{empty:r,ranges:o}=e.selection,i=t?vn(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(f=>i?i.name===f.type.name:!0).find(f=>Ko(f.attrs,n,{strict:!1}));let s=0;const a=[];if(o.forEach(({$from:f,$to:p})=>{const h=f.pos,d=p.pos;e.doc.nodesBetween(h,d,(v,g)=>{if(!v.isText&&!v.marks.length)return;const b=Math.max(h,g),y=Math.min(d,g+v.nodeSize);s+=y-b,a.push(...v.marks.map(m=>({mark:m,from:b,to:y})))})}),s===0)return!1;const c=a.filter(f=>i?i.name===f.mark.type.name:!0).filter(f=>Ko(f.mark.attrs,n,{strict:!1})).reduce((f,p)=>f+p.to-p.from,0),l=a.filter(f=>i?f.mark.type!==i&&f.mark.type.excludes(i):!0).reduce((f,p)=>f+p.to-p.from,0);return(c>0?c+l:c)>=s}const ly=(e,t={},n={})=>({state:r,commands:o})=>{const{extendEmptyMarkRange:i=!1}=n,s=vn(e,r.schema);return Qs(r,s,t)?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,t)};var uy=Object.freeze({__proto__:null,toggleMark:ly});const fy=(e,t,n={})=>({state:r,commands:o})=>{const i=St(e,r.schema),s=St(t,r.schema);return lr(r,i,n)?o.setNode(s):o.setNode(i,n)};var py=Object.freeze({__proto__:null,toggleNode:fy});const hy=(e,t={})=>({state:n,dispatch:r})=>{const o=St(e,n.schema);return lr(n,o,t)?Sl(n,r):_l(o,t)(n,r)};var dy=Object.freeze({__proto__:null,toggleWrap:hy});const vy=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const o=n[r];let i;if(o.spec.isInputRules&&(i=o.getState(e))){if(t){const s=e.tr,a=i.transform;for(let c=a.steps.length-1;c>=0;c-=1)s.step(a.steps[c].invert(a.docs[c]));if(i.text){const c=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,e.schema.text(i.text,c))}else s.delete(i.from,i.to)}return!0}}return!1};var my=Object.freeze({__proto__:null,undoInputRule:vy});const gy=()=>({tr:e,state:t,dispatch:n})=>{const{selection:r}=e,{empty:o,ranges:i}=r;return o||n&&Object.entries(t.schema.marks).forEach(([,s])=>{i.forEach(a=>{e.removeMark(a.$from.pos,a.$to.pos,s)})}),!0};var yy=Object.freeze({__proto__:null,unsetAllMarks:gy});const by=(e,t={})=>({tr:n,state:r,dispatch:o})=>{var i;const{extendEmptyMarkRange:s=!1}=t,{selection:a}=n,c=vn(e,r.schema),{$from:l,empty:u,ranges:f}=a;if(!o)return!0;if(u&&s){let{from:p,to:h}=a;const d=(i=l.marks().find(g=>g.type===c))===null||i===void 0?void 0:i.attrs,v=ju(l,c,d);v&&(p=v.from,h=v.to),n.removeMark(p,h,c)}else f.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,c)});return n.removeStoredMark(c),!0};var wy=Object.freeze({__proto__:null,unsetMark:by});const ky=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=Go(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(i=St(e,r.schema)),a==="mark"&&(s=vn(e,r.schema)),o&&n.selection.ranges.forEach(c=>{const l=c.$from.pos,u=c.$to.pos;r.doc.nodesBetween(l,u,(f,p)=>{i&&i===f.type&&n.setNodeMarkup(p,void 0,S(S({},f.attrs),t)),s&&f.marks.length&&f.marks.forEach(h=>{if(s===h.type){const d=Math.max(p,l),v=Math.min(p+f.nodeSize,u);n.addMark(d,v,s.create(S(S({},h.attrs),t)))}})})}),!0):!1};var Sy=Object.freeze({__proto__:null,updateAttributes:ky});const Oy=(e,t={})=>({state:n,dispatch:r})=>{const o=St(e,n.schema);return lr(n,o,t)?!1:_l(o,t)(n,r)};var xy=Object.freeze({__proto__:null,wrapIn:Oy});const My=(e,t={})=>({state:n,dispatch:r})=>{const o=St(e,n.schema);return Qd(o,t)(n,r)};var Cy=Object.freeze({__proto__:null,wrapInList:My});const Ty=kt.create({name:"commands",addCommands(){return S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S(S({},Am),Im),Dm),Bm),zm),$m),Hm),Jm),qm),Um),Xm),Qm),og),sg),cg),fg),hg),vg),bg),kg),Og),Mg),Tg),Eg),Ng),Pg),Rg),Lg),Fg),Vg),jg),Wg),Kg),Gg),Xg),Qg),ny),oy),cy),uy),py),dy),my),yy),wy),Sy),xy),Cy)}}),_y=kt.create({name:"editable",addProseMirrorPlugins(){return[new Ct({key:new ne("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ey=kt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new Ct({key:new ne("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Ay=kt.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:n})=>[()=>n.undoInputRule(),()=>n.deleteSelection(),()=>n.joinBackward(),()=>n.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:n})=>[()=>n.deleteSelection(),()=>n.joinForward(),()=>n.selectNodeForward()]);return{Enter:()=>this.editor.commands.first(({commands:n})=>[()=>n.newlineInCode(),()=>n.createParagraphNear(),()=>n.liftEmptyBlock(),()=>n.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()}}}),Ny=kt.create({name:"tabindex",addProseMirrorPlugins(){return[new Ct({key:new ne("tabindex"),props:{attributes:{tabindex:"0"}}})]}});var Iy=Object.freeze({__proto__:null,ClipboardTextSerializer:_m,Commands:Ty,Editable:_y,FocusEvents:Ey,Keymap:Ay,Tabindex:Ny});function Py(e,t){const n=St(t,e.schema),{from:r,to:o}=e.selection,i=[];e.doc.nodesBetween(r,o,a=>{i.push(a)});const s=i.reverse().find(a=>a.type.name===n.name);return s?S({},s.attrs):{}}function Dy(e,t){const n=Go(typeof t=="string"?t:t.name,e.schema);return n==="node"?Py(e,t):n==="mark"?Uu(e,t):{}}function Ry(e,t,n={}){if(!t)return lr(e,null,n)||Qs(e,null,n);const r=Go(t,e.schema);return r==="node"?lr(e,t,n):r==="mark"?Qs(e,t,n):!1}function By(e){(e==null?void 0:e.parentNode)&&e.parentNode.removeChild(e)}function Ly(e,t){const n=xt.fromSchema(t).serializeFragment(e),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}function zy(e,t){const n={from:0,to:e.content.size};return Vu(e,n,t)}function Fy(e){var t;const n=(t=e.type.createAndFill())===null||t===void 0?void 0:t.toJSON(),r=e.toJSON();return JSON.stringify(n)===JSON.stringify(r)}function $y(e){const t=document.querySelector("style[data-tiptap-style]");if(t!==null)return t;const n=document.createElement("style");return n.setAttribute("data-tiptap-style",""),n.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(n),n}function ta(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return Jt(S({},t),{schema:t.schema,plugins:t.plugins,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}})}class ea{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:r}=this,{view:o}=n,{tr:i}=r,s=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([a,c])=>[a,(...u)=>{const f=c(...u)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(i),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:r,editor:o,state:i}=this,{view:s}=o,a=[],c=!!t,l=t||i.tr,u=()=>(!c&&n&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(l),a.every(p=>p===!0)),f=Jt(S({},Object.fromEntries(Object.entries(r).map(([p,h])=>[p,(...v)=>{const g=this.buildProps(l,n),b=h(...v)(g);return a.push(b),f}]))),{run:u});return f}createCan(t){const{rawCommands:n,state:r}=this,o=void 0,i=t||r.tr,s=this.buildProps(i,o),a=Object.fromEntries(Object.entries(n).map(([c,l])=>[c,(...u)=>l(...u)(Jt(S({},s),{dispatch:o}))]));return Jt(S({},a),{chain:()=>this.createChain(i,o)})}buildProps(t,n=!0){const{rawCommands:r,editor:o,state:i}=this,{view:s}=o;i.storedMarks&&t.setStoredMarks(i.storedMarks);const a={tr:t,editor:o,view:s,state:ta({state:i,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([c,l])=>[c,(...u)=>l(...u)(a)]))}};return a}}class Zo{constructor(t){this.find=t.find,this.handler=t.handler}}const Vy=(e,t)=>{if(Ys(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[];return r.push(n.text),r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function na(e){var t;const{editor:n,from:r,to:o,text:i,rules:s,plugin:a}=e,{view:c}=n;if(c.composing)return!1;const l=c.state.doc.resolve(r);if(l.parent.type.spec.code||!!((t=l.nodeBefore||l.nodeAfter)===null||t===void 0?void 0:t.marks.find(h=>h.type.spec.code)))return!1;let u=!1;const f=500,p=l.parent.textBetween(Math.max(0,l.parentOffset-f),l.parentOffset,void 0,"\uFFFC")+i;return s.forEach(h=>{if(u)return;const d=Vy(p,h.find);if(!d)return;const v=c.state.tr,g=ta({state:c.state,transaction:v}),b={from:r-(d[0].length-i.length),to:o},{commands:y,chain:M,can:m}=new ea({editor:n,state:g});h.handler({state:g,range:b,match:d,commands:y,chain:M,can:m}),!!v.steps.length&&(v.setMeta(a,{transform:v,from:r,to:o,text:i}),c.dispatch(v),u=!0)}),u}function Hy(e){const{editor:t,rules:n}=e,r=new Ct({state:{init(){return null},apply(o,i){const s=o.getMeta(this);return s||(o.selectionSet||o.docChanged?null:i)}},props:{handleTextInput(o,i,s,a){return na({editor:t,from:i,to:s,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:o=>(setTimeout(()=>{const{$cursor:i}=o.state.selection;i&&na({editor:t,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(o,i){if(i.key!=="Enter")return!1;const{$cursor:s}=o.state.selection;return s?na({editor:t,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function jy(e){return typeof e=="number"}class Jy{constructor(t){this.find=t.find,this.handler=t.handler}}const Wy=(e,t)=>{if(Ys(t))return[...e.matchAll(t)];const n=t(e);return n?n.map(r=>{const o=[];return o.push(r.text),o.index=r.index,o.input=e,o.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(r.replaceWith)),o}):[]};function qy(e){const{editor:t,state:n,from:r,to:o,rules:i}=e,{commands:s,chain:a,can:c}=new ea({editor:t,state:n});n.doc.nodesBetween(r,o,(l,u)=>{if(!l.isTextblock||l.type.spec.code)return;const f=Math.max(r,u),p=Math.min(o,u+l.content.size),h=l.textBetween(f-u,p-u,void 0,"\uFFFC");i.forEach(d=>{Wy(h,d.find).forEach(g=>{if(g.index===void 0)return;const b=f+g.index+1,y=b+g[0].length,M={from:n.tr.mapping.map(b),to:n.tr.mapping.map(y)};d.handler({state:n,range:M,match:g,commands:s,chain:a,can:c})})})})}function Ky(e){const{editor:t,rules:n}=e;let r=!1;const o=new Ct({props:{handlePaste:(i,s)=>{var a;const c=(a=s.clipboardData)===null||a===void 0?void 0:a.getData("text/html");return r=!!(c==null?void 0:c.includes("data-pm-slice")),!1}},appendTransaction:(i,s,a)=>{const c=i[0];if(!c.getMeta("paste")||r)return;const{doc:l,before:u}=c,f=u.content.findDiffStart(l.content),p=u.content.findDiffEnd(l.content);if(!jy(f)||!p||f===p.b)return;const h=a.tr,d=ta({state:a,transaction:h});if(qy({editor:t,state:d,from:Math.max(f-1,0),to:p.b,rules:n,plugin:o}),!!h.steps.length)return h},isPasteRules:!0});return o}function Xu(e){const t=[],{nodeExtensions:n,markExtensions:r}=Xo(e),o=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return e.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},c=A(s,"addGlobalAttributes",a);if(!c)return;c().forEach(u=>{u.types.forEach(f=>{Object.entries(u.attributes).forEach(([p,h])=>{t.push({type:f,name:p,attribute:S(S({},i),h)})})})})}),o.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},c=A(s,"addAttributes",a);if(!c)return;const l=c();Object.entries(l).forEach(([u,f])=>{t.push({type:s.name,name:u,attribute:S(S({},i),f)})})}),t}function Et(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r=S({},t);return Object.entries(n).forEach(([o,i])=>{if(!r[o]){r[o]=i;return}o==="class"?r[o]=[r[o],i].join(" "):o==="style"?r[o]=[r[o],i].join("; "):r[o]=i}),r},{})}function ra(e,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>Et(n,r),{})}function Uy(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Gy(e){return typeof e!="string"?e:e.match(/^\d*(\.\d+)?$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function Zu(e,t){return e.style?e:Jt(S({},e),{getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(r===!1)return!1;const o=t.filter(i=>i.attribute.rendered).reduce((i,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(n):Gy(n.getAttribute(s.name));return Zs(a)&&console.warn(`[tiptap warn]: BREAKING CHANGE: "parseHTML" for your attribute "${s.name}" returns an object but should return the value itself. If this is expected you can ignore this message. This warning will be removed in one of the next releases. Further information: https://github.com/ueberdosis/tiptap/issues/1863`),a==null?i:Jt(S({},i),{[s.name]:a})},{});return S(S({},r),o)}})}function Qu(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&Uy(n)?!1:n!=null))}function Yy(e){var t;const n=Xu(e),{nodeExtensions:r,markExtensions:o}=Xo(e),i=(t=r.find(c=>A(c,"topNode")))===null||t===void 0?void 0:t.name,s=Object.fromEntries(r.map(c=>{const l=n.filter(g=>g.type===c.name),u={name:c.name,options:c.options,storage:c.storage},f=e.reduce((g,b)=>{const y=A(b,"extendNodeSchema",u);return S(S({},g),y?y(c):{})},{}),p=Qu(Jt(S({},f),{content:$(A(c,"content",u)),marks:$(A(c,"marks",u)),group:$(A(c,"group",u)),inline:$(A(c,"inline",u)),atom:$(A(c,"atom",u)),selectable:$(A(c,"selectable",u)),draggable:$(A(c,"draggable",u)),code:$(A(c,"code",u)),defining:$(A(c,"defining",u)),isolating:$(A(c,"isolating",u)),attrs:Object.fromEntries(l.map(g=>{var b;return[g.name,{default:(b=g==null?void 0:g.attribute)===null||b===void 0?void 0:b.default}]}))})),h=$(A(c,"parseHTML",u));h&&(p.parseDOM=h.map(g=>Zu(g,l)));const d=A(c,"renderHTML",u);d&&(p.toDOM=g=>d({node:g,HTMLAttributes:ra(g,l)}));const v=A(c,"renderText",u);return v&&(p.toText=v),[c.name,p]})),a=Object.fromEntries(o.map(c=>{const l=n.filter(v=>v.type===c.name),u={name:c.name,options:c.options,storage:c.storage},f=e.reduce((v,g)=>{const b=A(g,"extendMarkSchema",u);return S(S({},v),b?b(c):{})},{}),p=Qu(Jt(S({},f),{inclusive:$(A(c,"inclusive",u)),excludes:$(A(c,"excludes",u)),group:$(A(c,"group",u)),spanning:$(A(c,"spanning",u)),code:$(A(c,"code",u)),attrs:Object.fromEntries(l.map(v=>{var g;return[v.name,{default:(g=v==null?void 0:v.attribute)===null||g===void 0?void 0:g.default}]}))})),h=$(A(c,"parseHTML",u));h&&(p.parseDOM=h.map(v=>Zu(v,l)));const d=A(c,"renderHTML",u);return d&&(p.toDOM=v=>d({mark:v,HTMLAttributes:ra(v,l)})),[c.name,p]}));return new Pn({topNode:i,nodes:s,marks:a})}function oa(e,t){return t.nodes[e]||t.marks[e]||null}function Xy(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return[...new Set(t)]}class ur{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=ur.resolve(t),this.schema=Yy(this.extensions),this.extensions.forEach(r=>{var o;this.editor.extensionStorage[r.name]=r.storage;const i={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:oa(r.name,this.schema)};r.type==="mark"&&((o=$(A(r,"keepOnSplit",i)))!==null&&o!==void 0?o:!0)&&this.splittableMarks.push(r.name);const s=A(r,"onBeforeCreate",i);s&&this.editor.on("beforeCreate",s);const a=A(r,"onCreate",i);a&&this.editor.on("create",a);const c=A(r,"onUpdate",i);c&&this.editor.on("update",c);const l=A(r,"onSelectionUpdate",i);l&&this.editor.on("selectionUpdate",l);const u=A(r,"onTransaction",i);u&&this.editor.on("transaction",u);const f=A(r,"onFocus",i);f&&this.editor.on("focus",f);const p=A(r,"onBlur",i);p&&this.editor.on("blur",p);const h=A(r,"onDestroy",i);h&&this.editor.on("destroy",h)})}static resolve(t){const n=ur.sort(ur.flatten(t)),r=Xy(n.map(o=>o.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(o=>`'${o}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},o=A(n,"addExtensions",r);return o?[n,...this.flatten(o())]:n}).flat(10)}static sort(t){const n=100;return t.sort((r,o)=>{const i=A(r,"priority")||n,s=A(o,"priority")||n;return i>s?-1:i<s?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:oa(n.name,this.schema)},o=A(n,"addCommands",r);return o?S(S({},t),o()):t},{})}get plugins(){const{editor:t}=this,n=ur.sort([...this.extensions].reverse()),r=[],o=[],i=n.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:t,type:oa(s.name,this.schema)},c=[],l=A(s,"addKeyboardShortcuts",a);if(l){const h=Object.fromEntries(Object.entries(l()).map(([v,g])=>[v,()=>g({editor:t})])),d=Cm(h);c.push(d)}const u=A(s,"addInputRules",a);t.options.enableInputRules&&u&&r.push(...u());const f=A(s,"addPasteRules",a);t.options.enablePasteRules&&f&&o.push(...f());const p=A(s,"addProseMirrorPlugins",a);if(p){const h=p();c.push(...h)}return c}).flat();return[Hy({editor:t,rules:r}),Ky({editor:t,rules:o}),...i]}get attributes(){return Xu(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=Xo(this.extensions);return Object.fromEntries(n.filter(r=>!!A(r,"addNodeView")).map(r=>{const o=this.attributes.filter(c=>c.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:t,type:St(r.name,this.schema)},s=A(r,"addNodeView",i);if(!s)return[];const a=(c,l,u,f)=>{const p=ra(c,o);return s()({editor:t,node:c,getPos:u,decorations:f,HTMLAttributes:p,extension:r})};return[r.name,a]}))}}class Zy{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const r=this.callbacks[t];return r&&r.forEach(o=>o.apply(this,n)),this}off(t,n){const r=this.callbacks[t];return r&&(n?this.callbacks[t]=r.filter(o=>o!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}const Qy=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;class t0 extends Zy{constructor(t={}){super();this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=$y(Qy))}setOptions(t={}){this.options=S(S({},this.options),t),!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const r=$u(n)?n(t,this.state.plugins):[...this.state.plugins,t],o=this.state.reconfigure({plugins:r});this.view.updateState(o)}unregisterPlugin(t){if(this.isDestroyed)return;const n=typeof t=="string"?`${t}$`:t.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(o=>!o.key.startsWith(n))});this.view.updateState(r)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(Iy):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new ur(n,this)}createCommandManager(){this.commandManager=new ea({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){this.view=new dt(this.options.element,Jt(S({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:$t.create({doc:Ku(this.options.content,this.schema,this.options.parseOptions)})}));const t=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(t),this.createNodeViews();const n=this.view.dom;n.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const n=this.state.apply(t),r=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=t.getMeta("focus"),i=t.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:t}),i&&this.emit("blur",{editor:this,event:i.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Dy(this.state,t)}isActive(t,n){const r=typeof t=="string"?t:null,o=typeof t=="string"?n:t;return Ry(this.state,r,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ly(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:r={}}=t||{};return zy(this.state.doc,{blockSeparator:n,textSerializers:S(S({},r),Hu(this.schema))})}get isEmpty(){return Fy(this.state.doc)}getCharacterCount(){return this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners(),By(this.css)}get isDestroyed(){var t;return!((t=this.view)===null||t===void 0?void 0:t.docView)}}class Vt{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=S(S({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=$(A(this,"addOptions",{name:this.name}))),this.storage=$(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Vt(t)}configure(t={}){const n=this.extend();return n.options=qo(this.options,t),n.storage=$(A(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new Vt(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=t.defaultOptions?t.defaultOptions:n.parent.options,t.addOptions&&(n.options=$(A(n,"addOptions",{name:n.name}))),n.storage=$(A(n,"addStorage",{name:n.name,options:n.options})),n}}class mn{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=S(S({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=$(A(this,"addOptions",{name:this.name}))),this.storage=$(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new mn(t)}configure(t={}){const n=this.extend();return n.options=qo(this.options,t),n.storage=$(A(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new mn(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=t.defaultOptions?t.defaultOptions:n.parent.options,t.addOptions&&(n.options=$(A(n,"addOptions",{name:n.name}))),n.storage=$(A(n,"addStorage",{name:n.name,options:n.options})),n}}function e0(e){return new Zo({find:e.find,handler:({state:t,range:n,match:r})=>{const o=$(e.getAttributes,void 0,r)||{},{tr:i}=t,s=n.from;let a=n.to;if(r[1]){const c=r[0].lastIndexOf(r[1]);let l=s+c;l>a?l=a:a=l+r[1].length;const u=r[0][r[0].length-1];i.insertText(u,s+r[0].length-1),i.replaceWith(l,a,e.type.create(o))}else r[0]&&i.replaceWith(s,a,e.type.create(o))}})}function tf(e,t,n){const r=[];return n.doc.nodesBetween(e,t,(o,i)=>{r.push(...o.marks.map(s=>({from:i,to:i+o.nodeSize,mark:s})))}),r}function $n(e){return new Zo({find:e.find,handler:({state:t,range:n,match:r})=>{const o=$(e.getAttributes,void 0,r);if(o===!1||o===null)return;const{tr:i}=t,s=r[r.length-1],a=r[0];let c=n.to;if(s){const l=a.search(/\S/),u=n.from+a.indexOf(s),f=u+s.length;if(tf(n.from,n.to,t).filter(h=>h.mark.type.excluded.find(v=>v===e.type&&v!==h.mark.type)).filter(h=>h.to>u).length)return null;f<n.to&&i.delete(f,n.to),u>n.from&&i.delete(n.from+l,u),c=n.from+l+s.length,i.addMark(n.from+l,c,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function ia(e){return new Zo({find:e.find,handler:({state:t,range:n,match:r})=>{const o=t.doc.resolve(n.from),i=$(e.getAttributes,void 0,r)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,i)}})}function Qo(e){return new Zo({find:e.find,handler:({state:t,range:n,match:r})=>{const o=$(e.getAttributes,void 0,r)||{},i=t.tr.delete(n.from,n.to),a=i.doc.resolve(n.from).blockRange(),c=a&&es(a,e.type,o);if(!c)return null;i.wrap(a,c);const l=i.doc.resolve(n.from-1).nodeBefore;l&&l.type===e.type&&ns(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,l))&&i.join(n.from-1)}})}function Vn(e){return new Jy({find:e.find,handler:({state:t,range:n,match:r})=>{const o=$(e.getAttributes,void 0,r);if(o===!1||o===null)return;const{tr:i}=t,s=r[r.length-1],a=r[0];let c=n.to;if(s){const l=a.search(/\S/),u=n.from+a.indexOf(s),f=u+s.length;if(tf(n.from,n.to,t).filter(h=>h.mark.type.excluded.find(v=>v===e.type&&v!==h.mark.type)).filter(h=>h.to>u).length)return null;f<n.to&&i.delete(f,n.to),u>n.from&&i.delete(n.from+l,u),c=n.from+l+s.length,i.addMark(n.from+l,c,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function n0(e){return Zs(e)&&e instanceof L}function ef(e,t,n){const r=0,o=e.state.doc.content.size,i=Fn(t,r,o),s=Fn(n,r,o),a=e.coordsAtPos(i),c=e.coordsAtPos(s,-1),l=Math.min(a.top,c.top),u=Math.max(a.bottom,c.bottom),f=Math.min(a.left,c.left),p=Math.max(a.right,c.right),h=p-f,d=u-l,b={top:l,bottom:u,left:f,right:p,width:h,height:d,x:f,y:l};return Jt(S({},b),{toJSON:()=>b})}var le="top",ye="bottom",be="right",ue="left",sa="auto",qr=[le,ye,be,ue],fr="start",Kr="end",r0="clippingParents",nf="viewport",Ur="popper",o0="reference",rf=qr.reduce(function(e,t){return e.concat([t+"-"+fr,t+"-"+Kr])},[]),of=[].concat(qr,[sa]).reduce(function(e,t){return e.concat([t,t+"-"+fr,t+"-"+Kr])},[]),i0="beforeRead",s0="read",a0="afterRead",c0="beforeMain",l0="main",u0="afterMain",f0="beforeWrite",p0="write",h0="afterWrite",d0=[i0,s0,a0,c0,l0,u0,f0,p0,h0];function Fe(e){return e?(e.nodeName||"").toLowerCase():null}function _e(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Gr(e){var t=_e(e).Element;return e instanceof t||e instanceof Element}function we(e){var t=_e(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function sf(e){if(typeof ShadowRoot=="undefined")return!1;var t=_e(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function v0(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var r=t.styles[n]||{},o=t.attributes[n]||{},i=t.elements[n];!we(i)||!Fe(i)||(Object.assign(i.style,r),Object.keys(o).forEach(function(s){var a=o[s];a===!1?i.removeAttribute(s):i.setAttribute(s,a===!0?"":a)}))})}function m0(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(r){var o=t.elements[r],i=t.attributes[r]||{},s=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:n[r]),a=s.reduce(function(c,l){return c[l]="",c},{});!we(o)||!Fe(o)||(Object.assign(o.style,a),Object.keys(i).forEach(function(c){o.removeAttribute(c)}))})}}var af={name:"applyStyles",enabled:!0,phase:"write",fn:v0,effect:m0,requires:["computeStyles"]};function $e(e){return e.split("-")[0]}function pr(e,t){var n=e.getBoundingClientRect(),r=1,o=1;return{width:n.width/r,height:n.height/o,top:n.top/o,right:n.right/r,bottom:n.bottom/o,left:n.left/r,x:n.left/r,y:n.top/o}}function aa(e){var t=pr(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function cf(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&sf(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function tn(e){return _e(e).getComputedStyle(e)}function g0(e){return["table","td","th"].indexOf(Fe(e))>=0}function gn(e){return((Gr(e)?e.ownerDocument:e.document)||window.document).documentElement}function ti(e){return Fe(e)==="html"?e:e.assignedSlot||e.parentNode||(sf(e)?e.host:null)||gn(e)}function lf(e){return!we(e)||tn(e).position==="fixed"?null:e.offsetParent}function y0(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,n=navigator.userAgent.indexOf("Trident")!==-1;if(n&&we(e)){var r=tn(e);if(r.position==="fixed")return null}for(var o=ti(e);we(o)&&["html","body"].indexOf(Fe(o))<0;){var i=tn(o);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return o;o=o.parentNode}return null}function Yr(e){for(var t=_e(e),n=lf(e);n&&g0(n)&&tn(n).position==="static";)n=lf(n);return n&&(Fe(n)==="html"||Fe(n)==="body"&&tn(n).position==="static")?t:n||y0(e)||t}function ca(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}var yn=Math.max,Xr=Math.min,ei=Math.round;function ni(e,t,n){return yn(e,Xr(t,n))}function uf(){return{top:0,right:0,bottom:0,left:0}}function ff(e){return Object.assign({},uf(),e)}function pf(e,t){return t.reduce(function(n,r){return n[r]=e,n},{})}var b0=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,ff(typeof t!="number"?t:pf(t,qr))};function w0(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,s=n.modifiersData.popperOffsets,a=$e(n.placement),c=ca(a),l=[ue,be].indexOf(a)>=0,u=l?"height":"width";if(!(!i||!s)){var f=b0(o.padding,n),p=aa(i),h=c==="y"?le:ue,d=c==="y"?ye:be,v=n.rects.reference[u]+n.rects.reference[c]-s[c]-n.rects.popper[u],g=s[c]-n.rects.reference[c],b=Yr(i),y=b?c==="y"?b.clientHeight||0:b.clientWidth||0:0,M=v/2-g/2,m=f[h],C=y-p[u]-f[d],O=y/2-p[u]/2+M,E=ni(m,O,C),P=c;n.modifiersData[r]=(t={},t[P]=E,t.centerOffset=E-O,t)}}function k0(e){var t=e.state,n=e.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=t.elements.popper.querySelector(o),!o)||!cf(t.elements.popper,o)||(t.elements.arrow=o))}var S0={name:"arrow",enabled:!0,phase:"main",fn:w0,effect:k0,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function hr(e){return e.split("-")[1]}var O0={top:"auto",right:"auto",bottom:"auto",left:"auto"};function x0(e){var t=e.x,n=e.y,r=window,o=r.devicePixelRatio||1;return{x:ei(ei(t*o)/o)||0,y:ei(ei(n*o)/o)||0}}function hf(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.variation,s=e.offsets,a=e.position,c=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,f=u===!0?x0(s):typeof u=="function"?u(s):s,p=f.x,h=p===void 0?0:p,d=f.y,v=d===void 0?0:d,g=s.hasOwnProperty("x"),b=s.hasOwnProperty("y"),y=ue,M=le,m=window;if(l){var C=Yr(n),O="clientHeight",E="clientWidth";C===_e(n)&&(C=gn(n),tn(C).position!=="static"&&a==="absolute"&&(O="scrollHeight",E="scrollWidth")),C=C,(o===le||(o===ue||o===be)&&i===Kr)&&(M=ye,v-=C[O]-r.height,v*=c?1:-1),(o===ue||(o===le||o===ye)&&i===Kr)&&(y=be,h-=C[E]-r.width,h*=c?1:-1)}var P=Object.assign({position:a},l&&O0);if(c){var D;return Object.assign({},P,(D={},D[M]=b?"0":"",D[y]=g?"0":"",D.transform=(m.devicePixelRatio||1)<=1?"translate("+h+"px, "+v+"px)":"translate3d("+h+"px, "+v+"px, 0)",D))}return Object.assign({},P,(t={},t[M]=b?v+"px":"",t[y]=g?h+"px":"",t.transform="",t))}function M0(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=r===void 0?!0:r,i=n.adaptive,s=i===void 0?!0:i,a=n.roundOffsets,c=a===void 0?!0:a,l={placement:$e(t.placement),variation:hr(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,hf(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,hf(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var C0={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:M0,data:{}},ri={passive:!0};function T0(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=o===void 0?!0:o,s=r.resize,a=s===void 0?!0:s,c=_e(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&l.forEach(function(u){u.addEventListener("scroll",n.update,ri)}),a&&c.addEventListener("resize",n.update,ri),function(){i&&l.forEach(function(u){u.removeEventListener("scroll",n.update,ri)}),a&&c.removeEventListener("resize",n.update,ri)}}var _0={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:T0,data:{}},E0={left:"right",right:"left",bottom:"top",top:"bottom"};function oi(e){return e.replace(/left|right|bottom|top/g,function(t){return E0[t]})}var A0={start:"end",end:"start"};function df(e){return e.replace(/start|end/g,function(t){return A0[t]})}function la(e){var t=_e(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function ua(e){return pr(gn(e)).left+la(e).scrollLeft}function N0(e){var t=_e(e),n=gn(e),r=t.visualViewport,o=n.clientWidth,i=n.clientHeight,s=0,a=0;return r&&(o=r.width,i=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=r.offsetLeft,a=r.offsetTop)),{width:o,height:i,x:s+ua(e),y:a}}function I0(e){var t,n=gn(e),r=la(e),o=(t=e.ownerDocument)==null?void 0:t.body,i=yn(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),s=yn(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),a=-r.scrollLeft+ua(e),c=-r.scrollTop;return tn(o||n).direction==="rtl"&&(a+=yn(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:s,x:a,y:c}}function fa(e){var t=tn(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function vf(e){return["html","body","#document"].indexOf(Fe(e))>=0?e.ownerDocument.body:we(e)&&fa(e)?e:vf(ti(e))}function Zr(e,t){var n;t===void 0&&(t=[]);var r=vf(e),o=r===((n=e.ownerDocument)==null?void 0:n.body),i=_e(r),s=o?[i].concat(i.visualViewport||[],fa(r)?r:[]):r,a=t.concat(s);return o?a:a.concat(Zr(ti(s)))}function pa(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function P0(e){var t=pr(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function mf(e,t){return t===nf?pa(N0(e)):we(t)?P0(t):pa(I0(gn(e)))}function D0(e){var t=Zr(ti(e)),n=["absolute","fixed"].indexOf(tn(e).position)>=0,r=n&&we(e)?Yr(e):e;return Gr(r)?t.filter(function(o){return Gr(o)&&cf(o,r)&&Fe(o)!=="body"}):[]}function R0(e,t,n){var r=t==="clippingParents"?D0(e):[].concat(t),o=[].concat(r,[n]),i=o[0],s=o.reduce(function(a,c){var l=mf(e,c);return a.top=yn(l.top,a.top),a.right=Xr(l.right,a.right),a.bottom=Xr(l.bottom,a.bottom),a.left=yn(l.left,a.left),a},mf(e,i));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function gf(e){var t=e.reference,n=e.element,r=e.placement,o=r?$e(r):null,i=r?hr(r):null,s=t.x+t.width/2-n.width/2,a=t.y+t.height/2-n.height/2,c;switch(o){case le:c={x:s,y:t.y-n.height};break;case ye:c={x:s,y:t.y+t.height};break;case be:c={x:t.x+t.width,y:a};break;case ue:c={x:t.x-n.width,y:a};break;default:c={x:t.x,y:t.y}}var l=o?ca(o):null;if(l!=null){var u=l==="y"?"height":"width";switch(i){case fr:c[l]=c[l]-(t[u]/2-n[u]/2);break;case Kr:c[l]=c[l]+(t[u]/2-n[u]/2);break}}return c}function Qr(e,t){t===void 0&&(t={});var n=t,r=n.placement,o=r===void 0?e.placement:r,i=n.boundary,s=i===void 0?r0:i,a=n.rootBoundary,c=a===void 0?nf:a,l=n.elementContext,u=l===void 0?Ur:l,f=n.altBoundary,p=f===void 0?!1:f,h=n.padding,d=h===void 0?0:h,v=ff(typeof d!="number"?d:pf(d,qr)),g=u===Ur?o0:Ur,b=e.rects.popper,y=e.elements[p?g:u],M=R0(Gr(y)?y:y.contextElement||gn(e.elements.popper),s,c),m=pr(e.elements.reference),C=gf({reference:m,element:b,strategy:"absolute",placement:o}),O=pa(Object.assign({},b,C)),E=u===Ur?O:m,P={top:M.top-E.top+v.top,bottom:E.bottom-M.bottom+v.bottom,left:M.left-E.left+v.left,right:E.right-M.right+v.right},D=e.modifiersData.offset;if(u===Ur&&D){var F=D[o];Object.keys(P).forEach(function(it){var W=[be,ye].indexOf(it)>=0?1:-1,H=[le,ye].indexOf(it)>=0?"y":"x";P[it]+=F[H]*W})}return P}function B0(e,t){t===void 0&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,s=n.padding,a=n.flipVariations,c=n.allowedAutoPlacements,l=c===void 0?of:c,u=hr(r),f=u?a?rf:rf.filter(function(d){return hr(d)===u}):qr,p=f.filter(function(d){return l.indexOf(d)>=0});p.length===0&&(p=f);var h=p.reduce(function(d,v){return d[v]=Qr(e,{placement:v,boundary:o,rootBoundary:i,padding:s})[$e(v)],d},{});return Object.keys(h).sort(function(d,v){return h[d]-h[v]})}function L0(e){if($e(e)===sa)return[];var t=oi(e);return[df(e),t,df(t)]}function z0(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=o===void 0?!0:o,s=n.altAxis,a=s===void 0?!0:s,c=n.fallbackPlacements,l=n.padding,u=n.boundary,f=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,d=h===void 0?!0:h,v=n.allowedAutoPlacements,g=t.options.placement,b=$e(g),y=b===g,M=c||(y||!d?[oi(g)]:L0(g)),m=[g].concat(M).reduce(function(oe,Pt){return oe.concat($e(Pt)===sa?B0(t,{placement:Pt,boundary:u,rootBoundary:f,padding:l,flipVariations:d,allowedAutoPlacements:v}):Pt)},[]),C=t.rects.reference,O=t.rects.popper,E=new Map,P=!0,D=m[0],F=0;F<m.length;F++){var it=m[F],W=$e(it),H=hr(it)===fr,mt=[le,ye].indexOf(W)>=0,Z=mt?"width":"height",Y=Qr(t,{placement:it,boundary:u,rootBoundary:f,altBoundary:p,padding:l}),gt=mt?H?be:ue:H?ye:le;C[Z]>O[Z]&&(gt=oi(gt));var yt=oi(gt),Ne=[];if(i&&Ne.push(Y[W]<=0),a&&Ne.push(Y[gt]<=0,Y[yt]<=0),Ne.every(function(oe){return oe})){D=it,P=!1;break}E.set(it,Ne)}if(P)for(var Oe=d?3:1,Ie=function(Pt){var Pe=m.find(function(Mn){var ie=E.get(Mn);if(ie)return ie.slice(0,Pt).every(function(R){return R})});if(Pe)return D=Pe,"break"},Zt=Oe;Zt>0;Zt--){var qe=Ie(Zt);if(qe==="break")break}t.placement!==D&&(t.modifiersData[r]._skip=!0,t.placement=D,t.reset=!0)}}var F0={name:"flip",enabled:!0,phase:"main",fn:z0,requiresIfExists:["offset"],data:{_skip:!1}};function yf(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function bf(e){return[le,be,ye,ue].some(function(t){return e[t]>=0})}function $0(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,s=Qr(t,{elementContext:"reference"}),a=Qr(t,{altBoundary:!0}),c=yf(s,r),l=yf(a,o,i),u=bf(c),f=bf(l);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":f})}var V0={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:$0};function H0(e,t,n){var r=$e(e),o=[ue,le].indexOf(r)>=0?-1:1,i=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,s=i[0],a=i[1];return s=s||0,a=(a||0)*o,[ue,be].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function j0(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=o===void 0?[0,0]:o,s=of.reduce(function(u,f){return u[f]=H0(f,t.rects,i),u},{}),a=s[t.placement],c=a.x,l=a.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[r]=s}var J0={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:j0};function W0(e){var t=e.state,n=e.name;t.modifiersData[n]=gf({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var q0={name:"popperOffsets",enabled:!0,phase:"read",fn:W0,data:{}};function K0(e){return e==="x"?"y":"x"}function U0(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,i=o===void 0?!0:o,s=n.altAxis,a=s===void 0?!1:s,c=n.boundary,l=n.rootBoundary,u=n.altBoundary,f=n.padding,p=n.tether,h=p===void 0?!0:p,d=n.tetherOffset,v=d===void 0?0:d,g=Qr(t,{boundary:c,rootBoundary:l,padding:f,altBoundary:u}),b=$e(t.placement),y=hr(t.placement),M=!y,m=ca(b),C=K0(m),O=t.modifiersData.popperOffsets,E=t.rects.reference,P=t.rects.popper,D=typeof v=="function"?v(Object.assign({},t.rects,{placement:t.placement})):v,F={x:0,y:0};if(!!O){if(i||a){var it=m==="y"?le:ue,W=m==="y"?ye:be,H=m==="y"?"height":"width",mt=O[m],Z=O[m]+g[it],Y=O[m]-g[W],gt=h?-P[H]/2:0,yt=y===fr?E[H]:P[H],Ne=y===fr?-P[H]:-E[H],Oe=t.elements.arrow,Ie=h&&Oe?aa(Oe):{width:0,height:0},Zt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:uf(),qe=Zt[it],oe=Zt[W],Pt=ni(0,E[H],Ie[H]),Pe=M?E[H]/2-gt-Pt-qe-D:yt-Pt-qe-D,Mn=M?-E[H]/2+gt+Pt+oe+D:Ne+Pt+oe+D,ie=t.elements.arrow&&Yr(t.elements.arrow),R=ie?m==="y"?ie.clientTop||0:ie.clientLeft||0:0,tt=t.modifiersData.offset?t.modifiersData.offset[t.placement][m]:0,wt=O[m]+Pe-tt-R,bt=O[m]+Mn-tt;if(i){var Qt=ni(h?Xr(Z,wt):Z,mt,h?yn(Y,bt):Y);O[m]=Qt,F[m]=Qt-mt}if(a){var Un=m==="x"?le:ue,bo=m==="x"?ye:be,Cn=O[C],kr=Cn+g[Un],Sr=Cn-g[bo],Or=ni(h?Xr(kr,wt):kr,Cn,h?yn(Sr,bt):Sr);O[C]=Or,F[C]=Or-Cn}}t.modifiersData[r]=F}}var G0={name:"preventOverflow",enabled:!0,phase:"main",fn:U0,requiresIfExists:["offset"]};function Y0(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function X0(e){return e===_e(e)||!we(e)?la(e):Y0(e)}function Z0(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return n!==1||r!==1}function Q0(e,t,n){n===void 0&&(n=!1);var r=we(t);we(t)&&Z0(t);var o=gn(t),i=pr(e),s={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(r||!r&&!n)&&((Fe(t)!=="body"||fa(o))&&(s=X0(t)),we(t)?(a=pr(t),a.x+=t.clientLeft,a.y+=t.clientTop):o&&(a.x=ua(o))),{x:i.left+s.scrollLeft-a.x,y:i.top+s.scrollTop-a.y,width:i.width,height:i.height}}function tb(e){var t=new Map,n=new Set,r=[];e.forEach(function(i){t.set(i.name,i)});function o(i){n.add(i.name);var s=[].concat(i.requires||[],i.requiresIfExists||[]);s.forEach(function(a){if(!n.has(a)){var c=t.get(a);c&&o(c)}}),r.push(i)}return e.forEach(function(i){n.has(i.name)||o(i)}),r}function eb(e){var t=tb(e);return d0.reduce(function(n,r){return n.concat(t.filter(function(o){return o.phase===r}))},[])}function nb(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function rb(e){var t=e.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(t).map(function(n){return t[n]})}var wf={placement:"bottom",modifiers:[],strategy:"absolute"};function kf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function ob(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,r=n===void 0?[]:n,o=t.defaultOptions,i=o===void 0?wf:o;return function(a,c,l){l===void 0&&(l=i);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},wf,i),modifiersData:{},elements:{reference:a,popper:c},attributes:{},styles:{}},f=[],p=!1,h={state:u,setOptions:function(b){var y=typeof b=="function"?b(u.options):b;v(),u.options=Object.assign({},i,u.options,y),u.scrollParents={reference:Gr(a)?Zr(a):a.contextElement?Zr(a.contextElement):[],popper:Zr(c)};var M=eb(rb([].concat(r,u.options.modifiers)));return u.orderedModifiers=M.filter(function(m){return m.enabled}),d(),h.update()},forceUpdate:function(){if(!p){var b=u.elements,y=b.reference,M=b.popper;if(!!kf(y,M)){u.rects={reference:Q0(y,Yr(M),u.options.strategy==="fixed"),popper:aa(M)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(F){return u.modifiersData[F.name]=Object.assign({},F.data)});for(var m=0;m<u.orderedModifiers.length;m++){if(u.reset===!0){u.reset=!1,m=-1;continue}var C=u.orderedModifiers[m],O=C.fn,E=C.options,P=E===void 0?{}:E,D=C.name;typeof O=="function"&&(u=O({state:u,options:P,name:D,instance:h})||u)}}}},update:nb(function(){return new Promise(function(g){h.forceUpdate(),g(u)})}),destroy:function(){v(),p=!0}};if(!kf(a,c))return h;h.setOptions(l).then(function(g){!p&&l.onFirstUpdate&&l.onFirstUpdate(g)});function d(){u.orderedModifiers.forEach(function(g){var b=g.name,y=g.options,M=y===void 0?{}:y,m=g.effect;if(typeof m=="function"){var C=m({state:u,name:b,instance:h,options:M}),O=function(){};f.push(C||O)}})}function v(){f.forEach(function(g){return g()}),f=[]}return h}}var ib=[_0,q0,C0,af,J0,F0,G0,S0,V0],sb=ob({defaultModifiers:ib}),ab="tippy-box",Sf="tippy-content",cb="tippy-backdrop",Of="tippy-arrow",xf="tippy-svg-arrow",Hn={passive:!0,capture:!0},Mf=function(){return document.body};function ha(e,t,n){if(Array.isArray(e)){var r=e[t];return r==null?Array.isArray(n)?n[t]:n:r}return e}function da(e,t){var n={}.toString.call(e);return n.indexOf("[object")===0&&n.indexOf(t+"]")>-1}function Cf(e,t){return typeof e=="function"?e.apply(void 0,t):e}function Tf(e,t){if(t===0)return e;var n;return function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)}}function lb(e){return e.split(/\s+/).filter(Boolean)}function to(e){return[].concat(e)}function _f(e,t){e.indexOf(t)===-1&&e.push(t)}function ub(e){return e.filter(function(t,n){return e.indexOf(t)===n})}function fb(e){return e.split("-")[0]}function ii(e){return[].slice.call(e)}function Ef(e){return Object.keys(e).reduce(function(t,n){return e[n]!==void 0&&(t[n]=e[n]),t},{})}function eo(){return document.createElement("div")}function si(e){return["Element","Fragment"].some(function(t){return da(e,t)})}function pb(e){return da(e,"NodeList")}function hb(e){return da(e,"MouseEvent")}function db(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function vb(e){return si(e)?[e]:pb(e)?ii(e):Array.isArray(e)?e:ii(document.querySelectorAll(e))}function va(e,t){e.forEach(function(n){n&&(n.style.transitionDuration=t+"ms")})}function Af(e,t){e.forEach(function(n){n&&n.setAttribute("data-state",t)})}function mb(e){var t,n=to(e),r=n[0];return(r==null||(t=r.ownerDocument)==null?void 0:t.body)?r.ownerDocument:document}function gb(e,t){var n=t.clientX,r=t.clientY;return e.every(function(o){var i=o.popperRect,s=o.popperState,a=o.props,c=a.interactiveBorder,l=fb(s.placement),u=s.modifiersData.offset;if(!u)return!0;var f=l==="bottom"?u.top.y:0,p=l==="top"?u.bottom.y:0,h=l==="right"?u.left.x:0,d=l==="left"?u.right.x:0,v=i.top-r+f>c,g=r-i.bottom-p>c,b=i.left-n+h>c,y=n-i.right-d>c;return v||g||b||y})}function ma(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(o){e[r](o,n)})}function Nf(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=(r=n.getRootNode==null?void 0:n.getRootNode())==null?void 0:r.host}return!1}var Ve={isTouch:!1},If=0;function yb(){Ve.isTouch||(Ve.isTouch=!0,window.performance&&document.addEventListener("mousemove",Pf))}function Pf(){var e=performance.now();e-If<20&&(Ve.isTouch=!1,document.removeEventListener("mousemove",Pf)),If=e}function bb(){var e=document.activeElement;if(db(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function wb(){document.addEventListener("touchstart",yb,Hn),window.addEventListener("blur",bb)}var kb=typeof window!="undefined"&&typeof document!="undefined",Sb=kb?!!window.msCrypto:!1,Ob={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},xb={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Ee=Object.assign({appendTo:Mf,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Ob,{},xb),Mb=Object.keys(Ee),Cb=function(t){var n=Object.keys(t);n.forEach(function(r){Ee[r]=t[r]})};function Df(e){var t=e.plugins||[],n=t.reduce(function(r,o){var i=o.name,s=o.defaultValue;if(i){var a;r[i]=e[i]!==void 0?e[i]:(a=Ee[i])!=null?a:s}return r},{});return Object.assign({},e,{},n)}function Tb(e,t){var n=t?Object.keys(Df(Object.assign({},Ee,{plugins:t}))):Mb,r=n.reduce(function(o,i){var s=(e.getAttribute("data-tippy-"+i)||"").trim();if(!s)return o;if(i==="content")o[i]=s;else try{o[i]=JSON.parse(s)}catch{o[i]=s}return o},{});return r}function Rf(e,t){var n=Object.assign({},t,{content:Cf(t.content,[e])},t.ignoreAttributes?{}:Tb(e,t.plugins));return n.aria=Object.assign({},Ee.aria,{},n.aria),n.aria={expanded:n.aria.expanded==="auto"?t.interactive:n.aria.expanded,content:n.aria.content==="auto"?t.interactive?null:"describedby":n.aria.content},n}var _b=function(){return"innerHTML"};function ga(e,t){e[_b()]=t}function Bf(e){var t=eo();return e===!0?t.className=Of:(t.className=xf,si(e)?t.appendChild(e):ga(t,e)),t}function Lf(e,t){si(t.content)?(ga(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?ga(e,t.content):e.textContent=t.content)}function ya(e){var t=e.firstElementChild,n=ii(t.children);return{box:t,content:n.find(function(r){return r.classList.contains(Sf)}),arrow:n.find(function(r){return r.classList.contains(Of)||r.classList.contains(xf)}),backdrop:n.find(function(r){return r.classList.contains(cb)})}}function zf(e){var t=eo(),n=eo();n.className=ab,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=eo();r.className=Sf,r.setAttribute("data-state","hidden"),Lf(r,e.props),t.appendChild(n),n.appendChild(r),o(e.props,e.props);function o(i,s){var a=ya(t),c=a.box,l=a.content,u=a.arrow;s.theme?c.setAttribute("data-theme",s.theme):c.removeAttribute("data-theme"),typeof s.animation=="string"?c.setAttribute("data-animation",s.animation):c.removeAttribute("data-animation"),s.inertia?c.setAttribute("data-inertia",""):c.removeAttribute("data-inertia"),c.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?c.setAttribute("role",s.role):c.removeAttribute("role"),(i.content!==s.content||i.allowHTML!==s.allowHTML)&&Lf(l,e.props),s.arrow?u?i.arrow!==s.arrow&&(c.removeChild(u),c.appendChild(Bf(s.arrow))):c.appendChild(Bf(s.arrow)):u&&c.removeChild(u)}return{popper:t,onUpdate:o}}zf.$$tippy=!0;var Eb=1,ai=[],ba=[];function Ab(e,t){var n=Rf(e,Object.assign({},Ee,{},Df(Ef(t)))),r,o,i,s=!1,a=!1,c=!1,l=!1,u,f,p,h=[],d=Tf(Un,n.interactiveDebounce),v,g=Eb++,b=null,y=ub(n.plugins),M={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},m={id:g,reference:e,popper:eo(),popperInstance:b,props:n,state:M,plugins:y,clearDelayTimeouts:yh,setProps:bh,setContent:wh,show:kh,hide:Sh,hideWithInteractivity:Oh,enable:mh,disable:gh,unmount:xh,destroy:Mh};if(!n.render)return m;var C=n.render(m),O=C.popper,E=C.onUpdate;O.setAttribute("data-tippy-root",""),O.id="tippy-"+m.id,m.popper=O,e._tippy=m,O._tippy=m;var P=y.map(function(w){return w.fn(m)}),D=e.hasAttribute("aria-expanded");return wt(),Oe(),gt(),yt("onCreate",[m]),n.showOnCreate&&ac(),O.addEventListener("mouseenter",function(){m.props.interactive&&m.state.isVisible&&m.clearDelayTimeouts()}),O.addEventListener("mouseleave",function(w){m.props.interactive&&m.props.trigger.indexOf("mouseenter")>=0&&(mt().addEventListener("mousemove",d),d(w))}),m;function F(){var w=m.props.touch;return Array.isArray(w)?w:[w,0]}function it(){return F()[0]==="hold"}function W(){var w;return!!((w=m.props.render)==null?void 0:w.$$tippy)}function H(){return v||e}function mt(){var w=H().parentNode;return w?mb(w):document}function Z(){return ya(O)}function Y(w){return m.state.isMounted&&!m.state.isVisible||Ve.isTouch||u&&u.type==="focus"?0:ha(m.props.delay,w?0:1,Ee.delay)}function gt(){O.style.pointerEvents=m.props.interactive&&m.state.isVisible?"":"none",O.style.zIndex=""+m.props.zIndex}function yt(w,N,B){if(B===void 0&&(B=!0),P.forEach(function(X){X[w]&&X[w].apply(void 0,N)}),B){var et;(et=m.props)[w].apply(et,N)}}function Ne(){var w=m.props.aria;if(!!w.content){var N="aria-"+w.content,B=O.id,et=to(m.props.triggerTarget||e);et.forEach(function(X){var jt=X.getAttribute(N);if(m.state.isVisible)X.setAttribute(N,jt?jt+" "+B:B);else{var de=jt&&jt.replace(B,"").trim();de?X.setAttribute(N,de):X.removeAttribute(N)}})}}function Oe(){if(!(D||!m.props.aria.expanded)){var w=to(m.props.triggerTarget||e);w.forEach(function(N){m.props.interactive?N.setAttribute("aria-expanded",m.state.isVisible&&N===H()?"true":"false"):N.removeAttribute("aria-expanded")})}}function Ie(){mt().removeEventListener("mousemove",d),ai=ai.filter(function(w){return w!==d})}function Zt(w){if(!(Ve.isTouch&&(c||w.type==="mousedown"))){var N=w.composedPath&&w.composedPath()[0]||w.target;if(!(m.props.interactive&&Nf(O,N))){if(Nf(H(),N)){if(Ve.isTouch||m.state.isVisible&&m.props.trigger.indexOf("click")>=0)return}else yt("onClickOutside",[m,w]);m.props.hideOnClick===!0&&(m.clearDelayTimeouts(),m.hide(),a=!0,setTimeout(function(){a=!1}),m.state.isMounted||Pe())}}}function qe(){c=!0}function oe(){c=!1}function Pt(){var w=mt();w.addEventListener("mousedown",Zt,!0),w.addEventListener("touchend",Zt,Hn),w.addEventListener("touchstart",oe,Hn),w.addEventListener("touchmove",qe,Hn)}function Pe(){var w=mt();w.removeEventListener("mousedown",Zt,!0),w.removeEventListener("touchend",Zt,Hn),w.removeEventListener("touchstart",oe,Hn),w.removeEventListener("touchmove",qe,Hn)}function Mn(w,N){R(w,function(){!m.state.isVisible&&O.parentNode&&O.parentNode.contains(O)&&N()})}function ie(w,N){R(w,N)}function R(w,N){var B=Z().box;function et(X){X.target===B&&(ma(B,"remove",et),N())}if(w===0)return N();ma(B,"remove",f),ma(B,"add",et),f=et}function tt(w,N,B){B===void 0&&(B=!1);var et=to(m.props.triggerTarget||e);et.forEach(function(X){X.addEventListener(w,N,B),h.push({node:X,eventType:w,handler:N,options:B})})}function wt(){it()&&(tt("touchstart",Qt,{passive:!0}),tt("touchend",bo,{passive:!0})),lb(m.props.trigger).forEach(function(w){if(w!=="manual")switch(tt(w,Qt),w){case"mouseenter":tt("mouseleave",bo);break;case"focus":tt(Sb?"focusout":"blur",Cn);break;case"focusin":tt("focusout",Cn);break}})}function bt(){h.forEach(function(w){var N=w.node,B=w.eventType,et=w.handler,X=w.options;N.removeEventListener(B,et,X)}),h=[]}function Qt(w){var N,B=!1;if(!(!m.state.isEnabled||kr(w)||a)){var et=((N=u)==null?void 0:N.type)==="focus";u=w,v=w.currentTarget,Oe(),!m.state.isVisible&&hb(w)&&ai.forEach(function(X){return X(w)}),w.type==="click"&&(m.props.trigger.indexOf("mouseenter")<0||s)&&m.props.hideOnClick!==!1&&m.state.isVisible?B=!0:ac(w),w.type==="click"&&(s=!B),B&&!et&&wo(w)}}function Un(w){var N=w.target,B=H().contains(N)||O.contains(N);if(!(w.type==="mousemove"&&B)){var et=Pi().concat(O).map(function(X){var jt,de=X._tippy,Gn=(jt=de.popperInstance)==null?void 0:jt.state;return Gn?{popperRect:X.getBoundingClientRect(),popperState:Gn,props:n}:null}).filter(Boolean);gb(et,w)&&(Ie(),wo(w))}}function bo(w){var N=kr(w)||m.props.trigger.indexOf("click")>=0&&s;if(!N){if(m.props.interactive){m.hideWithInteractivity(w);return}wo(w)}}function Cn(w){m.props.trigger.indexOf("focusin")<0&&w.target!==H()||m.props.interactive&&w.relatedTarget&&O.contains(w.relatedTarget)||wo(w)}function kr(w){return Ve.isTouch?it()!==w.type.indexOf("touch")>=0:!1}function Sr(){Or();var w=m.props,N=w.popperOptions,B=w.placement,et=w.offset,X=w.getReferenceClientRect,jt=w.moveTransition,de=W()?ya(O).arrow:null,Gn=X?{getBoundingClientRect:X,contextElement:X.contextElement||H()}:e,cc={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(ko){var Yn=ko.state;if(W()){var Ch=Z(),Ri=Ch.box;["placement","reference-hidden","escaped"].forEach(function(So){So==="placement"?Ri.setAttribute("data-placement",Yn.placement):Yn.attributes.popper["data-popper-"+So]?Ri.setAttribute("data-"+So,""):Ri.removeAttribute("data-"+So)}),Yn.attributes.popper={}}}},Tn=[{name:"offset",options:{offset:et}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!jt}},cc];W()&&de&&Tn.push({name:"arrow",options:{element:de,padding:3}}),Tn.push.apply(Tn,(N==null?void 0:N.modifiers)||[]),m.popperInstance=sb(Gn,O,Object.assign({},N,{placement:B,onFirstUpdate:p,modifiers:Tn}))}function Or(){m.popperInstance&&(m.popperInstance.destroy(),m.popperInstance=null)}function vh(){var w=m.props.appendTo,N,B=H();m.props.interactive&&w===Mf||w==="parent"?N=B.parentNode:N=Cf(w,[B]),N.contains(O)||N.appendChild(O),Sr()}function Pi(){return ii(O.querySelectorAll("[data-tippy-root]"))}function ac(w){m.clearDelayTimeouts(),w&&yt("onTrigger",[m,w]),Pt();var N=Y(!0),B=F(),et=B[0],X=B[1];Ve.isTouch&&et==="hold"&&X&&(N=X),N?r=setTimeout(function(){m.show()},N):m.show()}function wo(w){if(m.clearDelayTimeouts(),yt("onUntrigger",[m,w]),!m.state.isVisible){Pe();return}if(!(m.props.trigger.indexOf("mouseenter")>=0&&m.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(w.type)>=0&&s)){var N=Y(!1);N?o=setTimeout(function(){m.state.isVisible&&m.hide()},N):i=requestAnimationFrame(function(){m.hide()})}}function mh(){m.state.isEnabled=!0}function gh(){m.hide(),m.state.isEnabled=!1}function yh(){clearTimeout(r),clearTimeout(o),cancelAnimationFrame(i)}function bh(w){if(!m.state.isDestroyed){yt("onBeforeUpdate",[m,w]),bt();var N=m.props,B=Rf(e,Object.assign({},N,{},Ef(w),{ignoreAttributes:!0}));m.props=B,wt(),N.interactiveDebounce!==B.interactiveDebounce&&(Ie(),d=Tf(Un,B.interactiveDebounce)),N.triggerTarget&&!B.triggerTarget?to(N.triggerTarget).forEach(function(et){et.removeAttribute("aria-expanded")}):B.triggerTarget&&e.removeAttribute("aria-expanded"),Oe(),gt(),E&&E(N,B),m.popperInstance&&(Sr(),Pi().forEach(function(et){requestAnimationFrame(et._tippy.popperInstance.forceUpdate)})),yt("onAfterUpdate",[m,w])}}function wh(w){m.setProps({content:w})}function kh(){var w=m.state.isVisible,N=m.state.isDestroyed,B=!m.state.isEnabled,et=Ve.isTouch&&!m.props.touch,X=ha(m.props.duration,0,Ee.duration);if(!(w||N||B||et)&&!H().hasAttribute("disabled")&&(yt("onShow",[m],!1),m.props.onShow(m)!==!1)){if(m.state.isVisible=!0,W()&&(O.style.visibility="visible"),gt(),Pt(),m.state.isMounted||(O.style.transition="none"),W()){var jt=Z(),de=jt.box,Gn=jt.content;va([de,Gn],0)}p=function(){var Tn;if(!(!m.state.isVisible||l)){if(l=!0,O.offsetHeight,O.style.transition=m.props.moveTransition,W()&&m.props.animation){var Di=Z(),ko=Di.box,Yn=Di.content;va([ko,Yn],X),Af([ko,Yn],"visible")}Ne(),Oe(),_f(ba,m),(Tn=m.popperInstance)==null||Tn.forceUpdate(),m.state.isMounted=!0,yt("onMount",[m]),m.props.animation&&W()&&ie(X,function(){m.state.isShown=!0,yt("onShown",[m])})}},vh()}}function Sh(){var w=!m.state.isVisible,N=m.state.isDestroyed,B=!m.state.isEnabled,et=ha(m.props.duration,1,Ee.duration);if(!(w||N||B)&&(yt("onHide",[m],!1),m.props.onHide(m)!==!1)){if(m.state.isVisible=!1,m.state.isShown=!1,l=!1,s=!1,W()&&(O.style.visibility="hidden"),Ie(),Pe(),gt(),W()){var X=Z(),jt=X.box,de=X.content;m.props.animation&&(va([jt,de],et),Af([jt,de],"hidden"))}Ne(),Oe(),m.props.animation?W()&&Mn(et,m.unmount):m.unmount()}}function Oh(w){mt().addEventListener("mousemove",d),_f(ai,d),d(w)}function xh(){m.state.isVisible&&m.hide(),!!m.state.isMounted&&(Or(),Pi().forEach(function(w){w._tippy.unmount()}),O.parentNode&&O.parentNode.removeChild(O),ba=ba.filter(function(w){return w!==m}),m.state.isMounted=!1,yt("onHidden",[m]))}function Mh(){m.state.isDestroyed||(m.clearDelayTimeouts(),m.unmount(),bt(),delete e._tippy,m.state.isDestroyed=!0,yt("onDestroy",[m]))}}function dr(e,t){t===void 0&&(t={});var n=Ee.plugins.concat(t.plugins||[]);wb();var r=Object.assign({},t,{plugins:n}),o=vb(e),i=o.reduce(function(s,a){var c=a&&Ab(a,r);return c&&s.push(c),s},[]);return si(e)?i[0]:i}dr.defaultProps=Ee;dr.setDefaultProps=Cb;dr.currentInput=Ve;Object.assign({},af,{effect:function(t){var n=t.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});dr.setDefaultProps({render:zf});class Nb{constructor({editor:t,element:n,view:r,tippyOptions:o={},shouldShow:i}){this.preventHide=!1,this.shouldShow=({state:s,from:a,to:c})=>{const{doc:l,selection:u}=s,{empty:f}=u,p=!l.textBetween(a,c).length&&Ju(s.selection);return!(f||p)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:s})=>{var a;if(this.preventHide){this.preventHide=!1;return}(s==null?void 0:s.relatedTarget)&&((a=this.element.parentNode)===null||a===void 0?void 0:a.contains(s.relatedTarget))||this.hide()},this.editor=t,this.element=n,this.view=r,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=o,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=dr(t,S({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle"},this.tippyOptions)))}update(t,n){var r,o;const{state:i,composing:s}=t,{doc:a,selection:c}=i,l=n&&n.doc.eq(a)&&n.selection.eq(c);if(s||l)return;this.createTooltip();const{ranges:u}=c,f=Math.min(...u.map(d=>d.$from.pos)),p=Math.max(...u.map(d=>d.$to.pos));if(!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:t,state:i,oldState:n,from:f,to:p}))){this.hide();return}(o=this.tippy)===null||o===void 0||o.setProps({getReferenceClientRect:()=>{if(n0(i.selection)){const d=t.nodeDOM(f);if(d)return d.getBoundingClientRect()}return ef(t,f,p)}}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t;(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const Ff=e=>new Ct({key:typeof e.pluginKey=="string"?new ne(e.pluginKey):e.pluginKey,view:t=>new Nb(S({view:t},e))});kt.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[Ff({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});class Ib{constructor({editor:t,element:n,view:r,tippyOptions:o={},shouldShow:i}){this.preventHide=!1,this.shouldShow=({state:s})=>{const{selection:a}=s,{$anchor:c,empty:l}=a,u=c.depth===1,f=c.parent.isTextblock&&!c.parent.type.spec.code&&!c.parent.textContent;return!(!l||!u||!f)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:s})=>{var a;if(this.preventHide){this.preventHide=!1;return}(s==null?void 0:s.relatedTarget)&&((a=this.element.parentNode)===null||a===void 0?void 0:a.contains(s.relatedTarget))||this.hide()},this.editor=t,this.element=n,this.view=r,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=o,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=dr(t,S({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle"},this.tippyOptions)))}update(t,n){var r,o;const{state:i,composing:s}=t,{doc:a,selection:c}=i,{from:l,to:u}=c,f=n&&n.doc.eq(a)&&n.selection.eq(c);if(s||f)return;if(this.createTooltip(),!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:t,state:i,oldState:n}))){this.hide();return}(o=this.tippy)===null||o===void 0||o.setProps({getReferenceClientRect:()=>ef(t,l,u)}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t;(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const $f=e=>new Ct({key:typeof e.pluginKey=="string"?new ne(e.pluginKey):e.pluginKey,view:t=>new Ib(S({view:t},e))});kt.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[$f({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});Dt({name:"BubbleMenu",props:{pluginKey:{type:null,default:"bubbleMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=Rt(null);return xr(()=>{const{pluginKey:r,editor:o,tippyOptions:i,shouldShow:s}=e;o.registerPlugin(Ff({pluginKey:r,editor:o,element:n.value,tippyOptions:i,shouldShow:s}))}),xo(()=>{const{pluginKey:r,editor:o}=e;o.unregisterPlugin(r)}),()=>{var r;return _n("div",{ref:n},(r=t.default)===null||r===void 0?void 0:r.call(t))}}});function Vf(e){return Nh((t,n)=>({get(){return t(),e},set(r){e=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class Pb extends t0{constructor(t={}){super(t);return this.vueRenderers=En(new Map),this.contentComponent=null,this.reactiveState=Vf(this.view.state),this.reactiveExtensionStorage=Vf(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),Ih(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,n){super.registerPlugin(t,n),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const Db=Dt({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(e){const t=Rt(),n=Mo();return Ah(()=>{const r=e.editor;r&&r.options.element&&t.value&&hc(()=>{if(!t.value||!r.options.element.firstChild)return;const o=De(t.value);t.value.append(...r.options.element.childNodes),r.contentComponent=n.ctx._,r.setOptions({element:o}),r.createNodeViews()})}),xo(()=>{const r=e.editor;if(!r||(r.isDestroyed||r.view.setProps({nodeViews:{}}),r.contentComponent=null,!r.options.element.firstChild))return;const o=document.createElement("div");o.append(...r.options.element.childNodes),r.setOptions({element:o})}),{rootEl:t}},render(){const e=[];return this.editor&&this.editor.vueRenderers.forEach(t=>{const n=_n(dc,{to:t.teleportElement,key:t.id},_n(t.component,S({ref:t.id},t.props)));e.push(n)}),_n("div",{ref:t=>{this.rootEl=t}},...e)}});Dt({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=Rt(null);return xr(()=>{const{pluginKey:r,editor:o,tippyOptions:i,shouldShow:s}=e;o.registerPlugin($f({pluginKey:r,editor:o,element:n.value,tippyOptions:i,shouldShow:s}))}),xo(()=>{const{pluginKey:r,editor:o}=e;o.unregisterPlugin(r)}),()=>{var r;return _n("div",{ref:n},(r=t.default)===null||r===void 0?void 0:r.call(t))}}});Dt({props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var e,t;return _n(this.as,{class:this.decorationClasses.value,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}});Dt({props:{as:{type:String,default:"div"}},render(){return _n(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}});const Rb=/^\s*>\s$/,Bb=Vt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block*",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn("blockquote"),toggleBlockquote:()=>({commands:e})=>e.toggleWrap("blockquote"),unsetBlockquote:()=>({commands:e})=>e.lift("blockquote")}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Qo({find:Rb,type:this.type})]}}),Lb=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,zb=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Fb=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,$b=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Vb=mn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark("bold"),toggleBold:()=>({commands:e})=>e.toggleMark("bold"),unsetBold:()=>({commands:e})=>e.unsetMark("bold")}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold()}},addInputRules(){return[$n({find:Lb,type:this.type}),$n({find:Fb,type:this.type})]},addPasteRules(){return[Vn({find:zb,type:this.type}),Vn({find:$b,type:this.type})]}}),Hb=/^\s*([-+*])\s$/,jb=Vt.create({name:"bulletList",addOptions(){return{HTMLAttributes:{}}},group:"block list",content:"listItem+",parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e})=>e.toggleList("bulletList","listItem")}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[Qo({find:Hb,type:this.type})]}}),Jb=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Wb=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,qb=mn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark("code"),toggleCode:()=>({commands:e})=>e.toggleMark("code"),unsetCode:()=>({commands:e})=>e.unsetMark("code")}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[$n({find:Jb,type:this.type})]},addPasteRules(){return[Vn({find:Wb,type:this.type})]}}),Kb=/^```(?<language>[a-z]*)?[\s\n]$/,Ub=/^~~~(?<language>[a-z]*)?[\s\n]$/,Gb=Vt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,i=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return i||null},renderHTML:e=>e.language?{class:this.options.languageClassPrefix+e.language}:null}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({HTMLAttributes:e}){return["pre",this.options.HTMLAttributes,["code",e,0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode("codeBlock",e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode("codeBlock","paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1}}},addInputRules(){return[ia({find:Kb,type:this.type,getAttributes:({groups:e})=>e}),ia({find:Ub,type:this.type,getAttributes:({groups:e})=>e})]},addProseMirrorPlugins(){return[new Ct({key:new ne("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=o==null?void 0:o.mode;if(!n||!i)return!1;const{tr:s}=e.state;return s.replaceSelectionWith(this.type.create({language:i})),s.setSelection(K.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.insertText(n.replace(/\r\n?/g,`
`)),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),Yb=Vt.create({name:"doc",topNode:!0,content:"block+"});function Xb(e){return e===void 0&&(e={}),new Ct({view:function(n){return new He(n,e)}})}var He=function(t,n){var r=this;this.editorView=t,this.width=n.width||1,this.color=n.color||"black",this.class=n.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map(function(o){var i=function(s){return r[o](s)};return t.dom.addEventListener(o,i),{name:o,handler:i}})};He.prototype.destroy=function(){var t=this;this.handlers.forEach(function(n){var r=n.name,o=n.handler;return t.editorView.dom.removeEventListener(r,o)})};He.prototype.update=function(t,n){this.cursorPos!=null&&n.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())};He.prototype.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())};He.prototype.updateOverlay=function(){var t=this.editorView.state.doc.resolve(this.cursorPos),n;if(!t.parent.inlineContent){var r=t.nodeBefore,o=t.nodeAfter;if(r||o){var i=this.editorView.nodeDOM(this.cursorPos-(r?r.nodeSize:0)).getBoundingClientRect(),s=r?i.bottom:i.top;r&&o&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:i.left,right:i.right,top:s-this.width/2,bottom:s+this.width/2}}}if(!n){var a=this.editorView.coordsAtPos(this.cursorPos);n={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}var c=this.editorView.dom.offsetParent;this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color);var l,u;if(!c||c==document.body&&getComputedStyle(c).position=="static")l=-pageXOffset,u=-pageYOffset;else{var f=c.getBoundingClientRect();l=f.left-c.scrollLeft,u=f.top-c.scrollTop}this.element.style.left=n.left-l+"px",this.element.style.top=n.top-u+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"};He.prototype.scheduleRemoval=function(t){var n=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){return n.setCursor(null)},t)};He.prototype.dragover=function(t){if(!!this.editorView.editable){var n=this.editorView.posAtCoords({left:t.clientX,top:t.clientY});if(n){var r=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(r=ol(this.editorView.state.doc,r,this.editorView.dragging.slice),r==null))return this.setCursor(null);this.setCursor(r),this.scheduleRemoval(5e3)}}};He.prototype.dragend=function(){this.scheduleRemoval(20)};He.prototype.drop=function(){this.scheduleRemoval(20)};He.prototype.dragleave=function(t){(t.target==this.editorView.dom||!this.editorView.dom.contains(t.relatedTarget))&&this.setCursor(null)};const Zb=kt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:null}},addProseMirrorPlugins(){return[Xb(this.options)]}});var Ae=function(e){function t(n){e.call(this,n,n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(r,o){var i=r.resolve(o.map(this.head));return t.valid(i)?new t(i):e.near(i)},t.prototype.content=function(){return _.empty},t.prototype.eq=function(r){return r instanceof t&&r.head==this.head},t.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},t.fromJSON=function(r,o){if(typeof o.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(r.resolve(o.pos))},t.prototype.getBookmark=function(){return new ci(this.anchor)},t.valid=function(r){var o=r.parent;if(o.isTextblock||!Qb(r)||!tw(r))return!1;var i=o.type.spec.allowGapCursor;if(i!=null)return i;var s=o.contentMatchAt(r.index()).defaultType;return s&&s.isTextblock},t.findFrom=function(r,o,i){t:for(;;){if(!i&&t.valid(r))return r;for(var s=r.pos,a=null,c=r.depth;;c--){var l=r.node(c);if(o>0?r.indexAfter(c)<l.childCount:r.index(c)>0){a=l.child(o>0?r.indexAfter(c):r.index(c)-1);break}else if(c==0)return null;s+=o;var u=r.doc.resolve(s);if(t.valid(u))return u}for(;;){var f=o>0?a.firstChild:a.lastChild;if(!f){if(a.isAtom&&!a.isText&&!L.isSelectable(a)){r=r.doc.resolve(s+a.nodeSize*o),i=!1;continue t}break}a=f,s+=o;var p=r.doc.resolve(s);if(t.valid(p))return p}return null}},t}(z);Ae.prototype.visible=!1;z.jsonID("gapcursor",Ae);var ci=function(t){this.pos=t};ci.prototype.map=function(t){return new ci(t.map(this.pos))};ci.prototype.resolve=function(t){var n=t.resolve(this.pos);return Ae.valid(n)?new Ae(n):z.near(n)};function Qb(e){for(var t=e.depth;t>=0;t--){var n=e.index(t);if(n!=0)for(var r=e.node(t).child(n-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function tw(e){for(var t=e.depth;t>=0;t--){var n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(o.childCount==0&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}var ew=function(){return new Ct({props:{decorations:ow,createSelectionBetween:function(t,n,r){if(n.pos==r.pos&&Ae.valid(r))return new Ae(r)},handleClick:rw,handleKeyDown:nw}})},nw=Fu({ArrowLeft:li("horiz",-1),ArrowRight:li("horiz",1),ArrowUp:li("vert",-1),ArrowDown:li("vert",1)});function li(e,t){var n=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(r,o,i){var s=r.selection,a=t>0?s.$to:s.$from,c=s.empty;if(s instanceof K){if(!i.endOfTextblock(n)||a.depth==0)return!1;c=!1,a=r.doc.resolve(t>0?a.after():a.before())}var l=Ae.findFrom(a,t,c);return l?(o&&o(r.tr.setSelection(new Ae(l))),!0):!1}}function rw(e,t,n){if(!e.editable)return!1;var r=e.state.doc.resolve(t);if(!Ae.valid(r))return!1;var o=e.posAtCoords({left:n.clientX,top:n.clientY}),i=o.inside;return i>-1&&L.isSelectable(e.state.doc.nodeAt(i))?!1:(e.dispatch(e.state.tr.setSelection(new Ae(r))),!0)}function ow(e){if(!(e.selection instanceof Ae))return null;var t=document.createElement("div");return t.className="ProseMirror-gapcursor",Q.create(e.doc,[ht.widget(e.selection.head,t,{key:"gapcursor"})])}const iw=kt.create({name:"gapCursor",addProseMirrorPlugins(){return[ew()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=$(A(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),sw=Vt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",Et(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{keepMarks:o}=this.options,{splittableMarks:i}=r.extensionManager,s=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();return t().insertContent({type:this.name}).command(({tr:a,dispatch:c})=>{if(c&&s&&o){const l=s.filter(u=>i.includes(u.type.name));a.ensureMarks(l)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),aw=Vt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Et(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode("heading",e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode("heading","paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>Jt(S({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>ia({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var ui=200,At=function(){};At.prototype.append=function(t){return t.length?(t=At.from(t),!this.length&&t||t.length<ui&&this.leafAppend(t)||this.length<ui&&t.leafPrepend(this)||this.appendInner(t)):this};At.prototype.prepend=function(t){return t.length?At.from(t).append(this):this};At.prototype.appendInner=function(t){return new cw(this,t)};At.prototype.slice=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=this.length),t>=n?At.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,n))};At.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};At.prototype.forEach=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(t,n,r,0):this.forEachInvertedInner(t,n,r,0)};At.prototype.map=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var o=[];return this.forEach(function(i,s){return o.push(t(i,s))},n,r),o};At.from=function(t){return t instanceof At?t:t&&t.length?new Hf(t):At.empty};var Hf=function(e){function t(r){e.call(this),this.values=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(o,i){return o==0&&i==this.length?this:new t(this.values.slice(o,i))},t.prototype.getInner=function(o){return this.values[o]},t.prototype.forEachInner=function(o,i,s,a){for(var c=i;c<s;c++)if(o(this.values[c],a+c)===!1)return!1},t.prototype.forEachInvertedInner=function(o,i,s,a){for(var c=i-1;c>=s;c--)if(o(this.values[c],a+c)===!1)return!1},t.prototype.leafAppend=function(o){if(this.length+o.length<=ui)return new t(this.values.concat(o.flatten()))},t.prototype.leafPrepend=function(o){if(this.length+o.length<=ui)return new t(o.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(At);At.empty=new Hf([]);var cw=function(e){function t(n,r){e.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,o,i,s){var a=this.left.length;if(o<a&&this.left.forEachInner(r,o,Math.min(i,a),s)===!1||i>a&&this.right.forEachInner(r,Math.max(o-a,0),Math.min(this.length,i)-a,s+a)===!1)return!1},t.prototype.forEachInvertedInner=function(r,o,i,s){var a=this.left.length;if(o>a&&this.right.forEachInvertedInner(r,o-a,Math.max(i,a)-a,s+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(o,a),i,s)===!1)return!1},t.prototype.sliceInner=function(r,o){if(r==0&&o==this.length)return this;var i=this.left.length;return o<=i?this.left.slice(r,o):r>=i?this.right.slice(r-i,o-i):this.left.slice(r,i).append(this.right.slice(0,o-i))},t.prototype.leafAppend=function(r){var o=this.right.leafAppend(r);if(o)return new t(this.left,o)},t.prototype.leafPrepend=function(r){var o=this.left.leafPrepend(r);if(o)return new t(o,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t}(At),jf=At,lw=500,Nt=function(t,n){this.items=t,this.eventCount=n};Nt.prototype.popEvent=function(t,n){var r=this;if(this.eventCount==0)return null;for(var o=this.items.length;;o--){var i=this.items.get(o-1);if(i.selection){--o;break}}var s,a;n&&(s=this.remapping(o,this.items.length),a=s.maps.length);var c=t.tr,l,u,f=[],p=[];return this.items.forEach(function(h,d){if(!h.step){s||(s=r.remapping(o,d+1),a=s.maps.length),a--,p.push(h);return}if(s){p.push(new je(h.map));var v=h.step.map(s.slice(a)),g;v&&c.maybeStep(v).doc&&(g=c.mapping.maps[c.mapping.maps.length-1],f.push(new je(g,null,null,f.length+p.length))),a--,g&&s.appendMap(g,a)}else c.maybeStep(h.step);if(h.selection)return l=s?h.selection.map(s.slice(a)):h.selection,u=new Nt(r.items.slice(0,o).append(p.reverse().concat(f)),r.eventCount-1),!1},this.items.length,0),{remaining:u,transform:c,selection:l}};Nt.prototype.addTransform=function(t,n,r,o){for(var i=[],s=this.eventCount,a=this.items,c=!o&&a.length?a.get(a.length-1):null,l=0;l<t.steps.length;l++){var u=t.steps[l].invert(t.docs[l]),f=new je(t.mapping.maps[l],u,n),p=void 0;(p=c&&c.merge(f))&&(f=p,l?i.pop():a=a.slice(0,a.length-1)),i.push(f),n&&(s++,n=null),o||(c=f)}var h=s-r.depth;return h>fw&&(a=uw(a,h),s-=h),new Nt(a.append(i),s)};Nt.prototype.remapping=function(t,n){var r=new zt;return this.items.forEach(function(o,i){var s=o.mirrorOffset!=null&&i-o.mirrorOffset>=t?r.maps.length-o.mirrorOffset:null;r.appendMap(o.map,s)},t,n),r};Nt.prototype.addMaps=function(t){return this.eventCount==0?this:new Nt(this.items.append(t.map(function(n){return new je(n)})),this.eventCount)};Nt.prototype.rebased=function(t,n){if(!this.eventCount)return this;var r=[],o=Math.max(0,this.items.length-n),i=t.mapping,s=t.steps.length,a=this.eventCount;this.items.forEach(function(h){h.selection&&a--},o);var c=n;this.items.forEach(function(h){var d=i.getMirror(--c);if(d!=null){s=Math.min(s,d);var v=i.maps[d];if(h.step){var g=t.steps[d].invert(t.docs[d]),b=h.selection&&h.selection.map(i.slice(c+1,d));b&&a++,r.push(new je(v,g,b))}else r.push(new je(v))}},o);for(var l=[],u=n;u<s;u++)l.push(new je(i.maps[u]));var f=this.items.slice(0,o).append(l).append(r),p=new Nt(f,a);return p.emptyItemCount()>lw&&(p=p.compress(this.items.length-r.length)),p};Nt.prototype.emptyItemCount=function(){var t=0;return this.items.forEach(function(n){n.step||t++}),t};Nt.prototype.compress=function(t){t===void 0&&(t=this.items.length);var n=this.remapping(0,t),r=n.maps.length,o=[],i=0;return this.items.forEach(function(s,a){if(a>=t)o.push(s),s.selection&&i++;else if(s.step){var c=s.step.map(n.slice(r)),l=c&&c.getMap();if(r--,l&&n.appendMap(l,r),c){var u=s.selection&&s.selection.map(n.slice(r));u&&i++;var f=new je(l.invert(),c,u),p,h=o.length-1;(p=o.length&&o[h].merge(f))?o[h]=p:o.push(f)}}else s.map&&r--},this.items.length,0),new Nt(jf.from(o.reverse()),i)};Nt.empty=new Nt(jf.empty,0);function uw(e,t){var n;return e.forEach(function(r,o){if(r.selection&&t--==0)return n=o,!1}),e.slice(n)}var je=function(t,n,r,o){this.map=t,this.step=n,this.selection=r,this.mirrorOffset=o};je.prototype.merge=function(t){if(this.step&&t.step&&!t.selection){var n=t.step.merge(this.step);if(n)return new je(n.getMap().invert(),n,this.selection)}};var bn=function(t,n,r,o){this.done=t,this.undone=n,this.prevRanges=r,this.prevTime=o},fw=20;function pw(e,t,n,r){var o=n.getMeta(wn),i;if(o)return o.historyState;n.getMeta(dw)&&(e=new bn(e.done,e.undone,null,0));var s=n.getMeta("appendedTransaction");if(n.steps.length==0)return e;if(s&&s.getMeta(wn))return s.getMeta(wn).redo?new bn(e.done.addTransform(n,null,r,fi(t)),e.undone,Jf(n.mapping.maps[n.steps.length-1]),e.prevTime):new bn(e.done,e.undone.addTransform(n,null,r,fi(t)),null,e.prevTime);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){var a=e.prevTime==0||!s&&(e.prevTime<(n.time||0)-r.newGroupDelay||!hw(n,e.prevRanges)),c=s?wa(e.prevRanges,n.mapping):Jf(n.mapping.maps[n.steps.length-1]);return new bn(e.done.addTransform(n,a?t.selection.getBookmark():null,r,fi(t)),Nt.empty,c,n.time)}else return(i=n.getMeta("rebased"))?new bn(e.done.rebased(n,i),e.undone.rebased(n,i),wa(e.prevRanges,n.mapping),e.prevTime):new bn(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),wa(e.prevRanges,n.mapping),e.prevTime)}function hw(e,t){if(!t)return!1;if(!e.docChanged)return!0;var n=!1;return e.mapping.maps[0].forEach(function(r,o){for(var i=0;i<t.length;i+=2)r<=t[i+1]&&o>=t[i]&&(n=!0)}),n}function Jf(e){var t=[];return e.forEach(function(n,r,o,i){return t.push(o,i)}),t}function wa(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;r+=2){var o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}function Wf(e,t,n,r){var o=fi(t),i=wn.get(t).spec.config,s=(r?e.undone:e.done).popEvent(t,o);if(!!s){var a=s.selection.resolve(s.transform.doc),c=(r?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),i,o),l=new bn(r?c:s.remaining,r?s.remaining:c,null,0);n(s.transform.setSelection(a).setMeta(wn,{redo:r,historyState:l}).scrollIntoView())}}var ka=!1,qf=null;function fi(e){var t=e.plugins;if(qf!=t){ka=!1,qf=t;for(var n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){ka=!0;break}}return ka}var wn=new ne("history"),dw=new ne("closeHistory");function vw(e){return e={depth:e&&e.depth||100,newGroupDelay:e&&e.newGroupDelay||500},new Ct({key:wn,state:{init:function(){return new bn(Nt.empty,Nt.empty,null,0)},apply:function(n,r,o){return pw(r,o,n,e)}},config:e,props:{handleDOMEvents:{beforeinput:function(n,r){var o=r.inputType=="historyUndo"?Kf(n.state,n.dispatch):r.inputType=="historyRedo"?Uf(n.state,n.dispatch):!1;return o&&r.preventDefault(),o}}}})}function Kf(e,t){var n=wn.getState(e);return!n||n.done.eventCount==0?!1:(t&&Wf(n,e,t,!1),!0)}function Uf(e,t){var n=wn.getState(e);return!n||n.undone.eventCount==0?!1:(t&&Wf(n,e,t,!0),!0)}const mw=kt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Kf(e,t),redo:()=>({state:e,dispatch:t})=>Uf(e,t)}},addProseMirrorPlugins(){return[vw(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}}),gw=Vt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",Et(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e})=>e().command(({tr:t,dispatch:n})=>{const{selection:r}=t,{empty:o,$anchor:i}=r,s=i.parent.isTextblock&&!i.parent.type.spec.code&&!i.parent.textContent;if(!o||!s||!n)return!0;const a=i.before(),c=i.start();return t.deleteRange(a,c),t.setSelection(K.create(t.doc,a)),!0}).insertContent({type:this.name}).command(({tr:t,dispatch:n})=>{var r;if(n){const{parent:o,pos:i}=t.selection.$from,s=i+1;if(!t.doc.nodeAt(s)){const c=(r=o.type.contentMatch.defaultType)===null||r===void 0?void 0:r.create();c&&(t.insert(s,c),t.setSelection(K.create(t.doc,s)))}t.scrollIntoView()}return!0}).run()}},addInputRules(){return[e0({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),yw=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,bw=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,ww=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,kw=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Sw=mn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark("italic"),toggleItalic:()=>({commands:e})=>e.toggleMark("italic"),unsetItalic:()=>({commands:e})=>e.unsetMark("italic")}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[$n({find:yw,type:this.type}),$n({find:ww,type:this.type})]},addPasteRules(){return[Vn({find:bw,type:this.type}),Vn({find:kw,type:this.type})]}}),Ow=Vt.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",Et(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem("listItem"),Tab:()=>this.editor.commands.sinkListItem("listItem"),"Shift-Tab":()=>this.editor.commands.liftListItem("listItem")}}}),xw=/^(\d+)\.\s$/,Mw=Vt.create({name:"orderedList",addOptions(){return{HTMLAttributes:{}}},group:"block list",content:"listItem+",addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const r=e,{start:t}=r,n=pc(r,["start"]);return t===1?["ol",Et(this.options.HTMLAttributes,n),0]:["ol",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e})=>e.toggleList("orderedList","listItem")}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Qo({find:xw,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]})]}}),Cw=Vt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode("paragraph")}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Tw=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,_w=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Ew=mn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark("strike"),toggleStrike:()=>({commands:e})=>e.toggleMark("strike"),unsetStrike:()=>({commands:e})=>e.unsetMark("strike")}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[$n({find:Tw,type:this.type})]},addPasteRules(){return[Vn({find:_w,type:this.type})]}}),Aw=Vt.create({name:"text",group:"inline"}),Nw=kt.create({name:"starterKit",addExtensions(){var e,t,n,r,o,i,s,a,c,l,u,f,p,h,d,v,g,b;const y=[];return this.options.blockquote!==!1&&y.push(Bb.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bold!==!1&&y.push(Vb.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.bulletList!==!1&&y.push(jb.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&y.push(qb.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&y.push(Gb.configure((o=this.options)===null||o===void 0?void 0:o.codeBlock)),this.options.document!==!1&&y.push(Yb.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&y.push(Zb.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&y.push(iw.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&y.push(sw.configure((c=this.options)===null||c===void 0?void 0:c.hardBreak)),this.options.heading!==!1&&y.push(aw.configure((l=this.options)===null||l===void 0?void 0:l.heading)),this.options.history!==!1&&y.push(mw.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&y.push(gw.configure((f=this.options)===null||f===void 0?void 0:f.horizontalRule)),this.options.italic!==!1&&y.push(Sw.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&y.push(Ow.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&y.push(Mw.configure((d=this.options)===null||d===void 0?void 0:d.orderedList)),this.options.paragraph!==!1&&y.push(Cw.configure((v=this.options)===null||v===void 0?void 0:v.paragraph)),this.options.strike!==!1&&y.push(Ew.configure((g=this.options)===null||g===void 0?void 0:g.strike)),this.options.text!==!1&&y.push(Aw.configure((b=this.options)===null||b===void 0?void 0:b.text)),y}}),Iw=(e,t)=>{let n=0,r=0;for(;n<e.length&&n<t.length&&e[n]===t[n];)n++;if(n!==e.length||n!==t.length)for(;r+n<e.length&&r+n<t.length&&e[e.length-r-1]===t[t.length-r-1];)r++;return{index:n,remove:e.length-n-r,insert:t.slice(n,t.length-r)}},Pw=Iw,vt=new ne("y-sync"),jn=new ne("y-undo"),pi=new ne("yjs-cursor"),hi=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&t.sv.get(e.id.client)>e.id.clock&&!Kh(t.ds,e.id),Dw=[{light:"#ecd44433",dark:"#ecd444"}],Rw=(e,t,n)=>{if(!e.has(n)){if(e.size<t.length){const r=ed();e.forEach(o=>r.add(o)),t=t.filter(o=>!r.has(o))}e.set(n,Zh(t))}return e.get(n)},Bw=(e,{colors:t=Dw,colorMapping:n=new Map,permanentUserData:r=null}={})=>{let o=!1;const i=new Ct({props:{editable:s=>{const a=vt.getState(s);return a.snapshot==null&&a.prevSnapshot==null}},key:vt,state:{init:(s,a)=>({type:e,doc:e.doc,binding:null,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,colors:t,colorMapping:n,permanentUserData:r}),apply:(s,a)=>{const c=s.getMeta(vt);if(c!==void 0){a=Object.assign({},a);for(const l in c)a[l]=c[l]}return a.isChangeOrigin=c!==void 0&&!!c.isChangeOrigin,a.binding!==null&&c!==void 0&&(c.snapshot!=null||c.prevSnapshot!=null)&&setTimeout(()=>{c.restore==null?a.binding._renderSnapshot(c.snapshot,c.prevSnapshot,a):(a.binding._renderSnapshot(c.snapshot,c.snapshot,a),delete a.restore,delete a.snapshot,delete a.prevSnapshot,a.binding._prosemirrorChanged(a.binding.prosemirrorView.state.doc))},0),a}},view:s=>{const a=new zw(e,s);return setTimeout(()=>{a._forceRerender(),s.dispatch(s.state.tr.setMeta(vt,{binding:a}))},0),{update:()=>{const c=i.getState(s.state);c.snapshot==null&&c.prevSnapshot==null&&(o||s.state.doc.content.findDiffStart(s.state.doc.type.createAndFill().content)!==null)&&(o=!0,a._prosemirrorChanged(s.state.doc))},destroy:()=>{a.destroy()}}}});return i},Lw=(e,t,n)=>{if(t!==null&&t.anchor!==null&&t.head!==null){const r=oo(n.doc,n.type,t.anchor,n.mapping),o=oo(n.doc,n.type,t.head,n.mapping);r!==null&&o!==null&&(e=e.setSelection(K.create(e.doc,r,o)))}},Sa=(e,t)=>({anchor:gi(t.selection.anchor,e.type,e.mapping),head:gi(t.selection.head,e.type,e.mapping)});class zw{constructor(t,n){this.type=t,this.prosemirrorView=n,this.mux=jh(),this.mapping=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=t.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{this.beforeTransactionSelection===null&&(this.beforeTransactionSelection=Sa(this,n.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),t.observeDeep(this._observeFunction),this._domSelectionInView=null}_isLocalCursorInView(){return this.prosemirrorView.hasFocus()?(Jh&&this._domSelectionInView===null&&(setTimeout(()=>{this._domSelectionInView=null},0),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView):!1}_isDomSelectionInView(){const t=this.prosemirrorView._root.getSelection(),n=this.prosemirrorView._root.createRange();n.setStart(t.anchorNode,t.anchorOffset),n.setEnd(t.focusNode,t.focusOffset),n.getClientRects().length===0&&n.startContainer&&n.collapsed&&n.selectNodeContents(n.startContainer);const o=n.getBoundingClientRect(),i=Wh.documentElement;return o.bottom>=0&&o.right>=0&&o.left<=(window.innerWidth||i.clientWidth||0)&&o.top<=(window.innerHeight||i.clientHeight||0)}renderSnapshot(t,n){n||(n=Yh(Xh(),new Map)),this.prosemirrorView.dispatch(this.prosemirrorView.state.tr.setMeta(vt,{snapshot:t,prevSnapshot:n}))}unrenderSnapshot(){this.mapping=new Map,this.mux(()=>{const t=this.type.toArray().map(r=>di(r,this.prosemirrorView.state.schema,this.mapping)).filter(r=>r!==null),n=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new _(new k(t),0,0));n.setMeta(vt,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(n)})}_forceRerender(){this.mapping=new Map,this.mux(()=>{const t=this.type.toArray().map(r=>di(r,this.prosemirrorView.state.schema,this.mapping)).filter(r=>r!==null),n=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new _(new k(t),0,0));this.prosemirrorView.dispatch(n)})}_renderSnapshot(t,n,r){t||(t=qh(this.doc)),this.mapping=new Map,this.mux(()=>{this.doc.transact(o=>{const i=r.permanentUserData;i&&i.dss.forEach(l=>{Oc(o,l,u=>{})});const s=(l,u)=>{const f=l==="added"?i.getUserByClientId(u.client):i.getUserByDeletedId(u);return{user:f,type:l,color:Rw(r.colorMapping,r.colors,f)}},a=xc(this.type,new Mc(n.ds,t.sv)).map(l=>!l._item.deleted||hi(l._item,t)||hi(l._item,n)?di(l,this.prosemirrorView.state.schema,new Map,t,n,s):null).filter(l=>l!==null),c=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new _(new k(a),0,0));this.prosemirrorView.dispatch(c)},vt)})}_typeChanged(t,n){const r=vt.getState(this.prosemirrorView.state);if(t.length===0||r.snapshot!=null||r.prevSnapshot!=null){this.renderSnapshot(r.snapshot,r.prevSnapshot);return}this.mux(()=>{const o=(a,c)=>this.mapping.delete(c);Oc(n,n.deleteSet,a=>a.constructor===Cc&&this.mapping.delete(a.content.type)),n.changed.forEach(o),n.changedParentTypes.forEach(o);const i=this.type.toArray().map(a=>Gf(a,this.prosemirrorView.state.schema,this.mapping)).filter(a=>a!==null);let s=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new _(new k(i),0,0));Lw(s,this.beforeTransactionSelection,this),s=s.setMeta(vt,{isChangeOrigin:!0}),this.beforeTransactionSelection!==null&&this._isLocalCursorInView()&&s.scrollIntoView(),this.prosemirrorView.dispatch(s)})}_prosemirrorChanged(t){this.mux(()=>{this.doc.transact(()=>{Ma(this.doc,this.type,t,this.mapping),this.beforeTransactionSelection=Sa(this,this.prosemirrorView.state)},vt)})}destroy(){this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions)}}const Gf=(e,t,n,r,o,i)=>{const s=n.get(e);if(s===void 0){if(e instanceof Ue)return di(e,t,n,r,o,i);throw Uh()}return s},di=(e,t,n,r,o,i)=>{const s=[],a=c=>{if(c.constructor===Ue){const l=Gf(c,t,n,r,o,i);l!==null&&s.push(l)}else{const l=Fw(c,t,n,r,o,i);l!==null&&l.forEach(u=>{u!==null&&s.push(u)})}};r===void 0||o===void 0?e.toArray().forEach(a):xc(e,new Mc(o.ds,r.sv)).forEach(a);try{const c=e.getAttributes(r);r!==void 0&&(hi(e._item,r)?hi(e._item,o)||(c.ychange=i?i("added",e._item.id):{type:"added"}):c.ychange=i?i("removed",e._item.id):{type:"removed"});const l=t.node(e.nodeName,c,s);return n.set(e,l),l}catch{return e.doc.transact(l=>{e._item.delete(l)},vt),n.delete(e),null}},Fw=(e,t,n,r,o,i)=>{const s=[],a=e.toDelta(r,o,i);try{for(let c=0;c<a.length;c++){const l=a[c],u=[];for(const f in l.attributes)u.push(t.mark(f,l.attributes[f]));s.push(t.text(l.insert,u))}}catch{return e.doc.transact(l=>{e._item.delete(l)},vt),null}return s},$w=(e,t)=>{const n=new on,r=e.map(o=>({insert:o.text,attributes:Zf(o.marks)}));return n.applyDelta(r),t.set(n,e),n},Vw=(e,t)=>{const n=new Ue(e.type.name);for(const r in e.attrs){const o=e.attrs[r];o!==null&&r!=="ychange"&&n.setAttribute(r,o)}return n.insert(0,vi(e).map(r=>Oa(r,t))),t.set(n,e),n},Oa=(e,t)=>e instanceof Array?$w(e,t):Vw(e,t),xa=(e,t)=>{const n=Object.keys(e).filter(o=>e[o]!==null);let r=n.length===Object.keys(t).filter(o=>t[o]!==null).length;for(let o=0;o<n.length&&r;o++){const i=n[o],s=e[i],a=t[i];r=i==="ychange"||s===a||typeof s=="object"&&typeof a=="object"&&xa(s,a)}return r},vi=e=>{const t=e.content.content,n=[];for(let r=0;r<t.length;r++){const o=t[r];if(o.isText){const i=[];for(let s=t[r];r<t.length&&s.isText;s=t[++r])i.push(s);r--,n.push(i)}else n.push(o)}return n},Yf=(e,t)=>{const n=e.toDelta();return n.length===t.length&&n.every((r,o)=>r.insert===t[o].text&&Gh(r.attributes||{}).length===t[o].marks.length&&t[o].marks.every(i=>xa(r.attributes[i.type.name]||{},i.attrs)))},no=(e,t)=>{if(e instanceof Ue&&!(t instanceof Array)&&Ca(e,t)){const n=vi(t);return e._length===n.length&&xa(e.getAttributes(),t.attrs)&&e.toArray().every((r,o)=>no(r,n[o]))}return e instanceof on&&t instanceof Array&&Yf(e,t)},mi=(e,t)=>e===t||e instanceof Array&&t instanceof Array&&e.length===t.length&&e.every((n,r)=>t[r]===n),Xf=(e,t,n)=>{const r=e.toArray(),o=vi(t),i=o.length,s=r.length,a=Mr(s,i);let c=0,l=0,u=!1;for(;c<a;c++){const f=r[c],p=o[c];if(mi(n.get(f),p))u=!0;else if(!no(f,p))break}for(;c+l<a;l++){const f=r[s-l-1],p=o[i-l-1];if(mi(n.get(f),p))u=!0;else if(!no(f,p))break}return{equalityFactor:c+l,foundMappedChild:u}},Hw=e=>{let t="",n=e._start;const r={};for(;n!==null;)n.deleted||(n.countable&&n.content instanceof Qh?t+=n.content.str:n.content instanceof td&&(r[n.content.key]=null)),n=n.right;return{str:t,nAttrs:r}},jw=(e,t,n)=>{n.set(e,t);const{nAttrs:r,str:o}=Hw(e),i=t.map(l=>({insert:l.text,attributes:Object.assign({},r,Zf(l.marks))})),{insert:s,remove:a,index:c}=Pw(o,i.map(l=>l.insert).join(""));e.delete(c,a),e.insert(c,s),e.applyDelta(i.map(l=>({retain:l.insert.length,attributes:l.attributes})))},Zf=e=>{const t={};return e.forEach(n=>{n.type.name!=="ychange"&&(t[n.type.name]=n.attrs)}),t},Ma=(e,t,n,r)=>{if(t instanceof Ue&&t.nodeName!==n.type.name)throw new Error("node name mismatch!");if(r.set(t,n),t instanceof Ue){const f=t.getAttributes(),p=n.attrs;for(const h in p)p[h]!==null?f[h]!==p[h]&&h!=="ychange"&&t.setAttribute(h,p[h]):t.removeAttribute(h);for(const h in f)p[h]===void 0&&t.removeAttribute(h)}const o=vi(n),i=o.length,s=t.toArray(),a=s.length,c=Mr(i,a);let l=0,u=0;for(;l<c;l++){const f=s[l],p=o[l];if(!mi(r.get(f),p))if(no(f,p))r.set(f,p);else break}for(;u+l+1<c;u++){const f=s[a-u-1],p=o[i-u-1];if(!mi(r.get(f),p))if(no(f,p))r.set(f,p);else break}e.transact(()=>{for(;a-l-u>0&&i-l-u>0;){const p=s[l],h=o[l],d=s[a-u-1],v=o[i-u-1];if(p instanceof on&&h instanceof Array)Yf(p,h)||jw(p,h,r),l+=1;else{let g=p instanceof Ue&&Ca(p,h),b=d instanceof Ue&&Ca(d,v);if(g&&b){const y=Xf(p,h,r),M=Xf(d,v,r);y.foundMappedChild&&!M.foundMappedChild?b=!1:!y.foundMappedChild&&M.foundMappedChild||y.equalityFactor<M.equalityFactor?g=!1:b=!1}g?(Ma(e,p,h,r),l+=1):b?(Ma(e,d,v,r),u+=1):(t.delete(l,1),t.insert(l,[Oa(h,r)]),l+=1)}}const f=a-l-u;if(f>0&&t.delete(l,f),l+u<i){const p=[];for(let h=l;h<i-u;h++)p.push(Oa(o[h],r));t.insert(l,p)}},vt)},Ca=(e,t)=>!(t instanceof Array)&&e.nodeName===t.type.name;let ro=null;const Jw=()=>{const e=ro;ro=null,e.forEach((t,n)=>{const r=n.state.tr;t.forEach((o,i)=>{r.setMeta(i,o)}),n.dispatch(r)})},Ww=(e,t,n)=>{ro||(ro=new Map,hd(0,Jw)),sd(ro,e,ad).set(t,n)},gi=(e,t,n)=>{if(e===0)return Fi(t,0);let r=t._first===null?null:t._first.content.type;for(;r!==null&&t!==r;){if(r.constructor===on){if(r._length>=e)return Fi(r,e);if(e-=r._length,r._item!==null&&r._item.next!==null)r=r._item.next.content.type;else{do r=r._item===null?null:r._item.parent,e--;while(r!==t&&r!==null&&r._item!==null&&r._item.next===null);r!==null&&r!==t&&(r=r._item===null?null:r._item.next.content.type)}}else{const o=(n.get(r)||{nodeSize:0}).nodeSize;if(r._first!==null&&e<o)r=r._first.content.type,e--;else{if(e===1&&r._length===0&&o>1)return new $i(r._item===null?null:r._item.id,r._item===null?Vi(r):null,null);if(e-=o,r._item!==null&&r._item.next!==null)r=r._item.next.content.type;else{if(e===0)return r=r._item===null?r:r._item.parent,new $i(r._item===null?null:r._item.id,r._item===null?Vi(r):null,null);do r=r._item.parent,e--;while(r!==t&&r._item.next===null);r!==t&&(r=r._item.next.content.type)}}}if(r===null)throw nd();if(e===0&&r.constructor!==on&&r!==t)return qw(r._item.parent,r._item)}return Fi(t,t._length)},qw=(e,t)=>{let n=null,r=null;return e._item===null?r=Vi(e):n=rd(e._item.id.client,e._item.id.clock),new $i(n,r,t.id)},oo=(e,t,n,r)=>{const o=od(n,e);if(o===null||o.type!==t&&!id(t,o.type._item))return null;let i=o.type,s=0;if(i.constructor===on)s=o.index;else if(i._item===null||!i._item.deleted){let a=i._first,c=0;for(;c<i._length&&c<o.index&&a!==null;){if(!a.deleted){const l=a.content.type;c++,l.constructor===on?s+=l._length:s+=r.get(l).nodeSize}a=a.right}s+=1}for(;i!==t&&i._item!==null;){const a=i._item.parent;if(a._item===null||!a._item.deleted){s+=1;let c=a._first;for(;c!==null;){const l=c.content.type;if(l===i)break;c.deleted||(l.constructor===on?s+=l._length:s+=r.get(l).nodeSize),c=c.right}}i=a}return s-1},Kw=e=>{const t=document.createElement("span");t.classList.add("ProseMirror-yjs-cursor"),t.setAttribute("style",`border-color: ${e.color}`);const n=document.createElement("div");return n.setAttribute("style",`background-color: ${e.color}`),n.insertBefore(document.createTextNode(e.name),null),t.insertBefore(n,null),t},Qf=(e,t,n)=>{const r=vt.getState(e),o=r.doc,i=[];return r.snapshot!=null||r.prevSnapshot!=null||r.binding===null?Q.create(e.doc,[]):(t.getStates().forEach((s,a)=>{if(a!==o.clientID&&s.cursor!=null){const c=s.user||{};c.color==null&&(c.color="#ffa500"),c.name==null&&(c.name=`User: ${a}`);let l=oo(o,r.type,Cr(s.cursor.anchor),r.binding.mapping),u=oo(o,r.type,Cr(s.cursor.head),r.binding.mapping);if(l!==null&&u!==null){const f=Tc(e.doc.content.size-1,0);l=Mr(l,f),u=Mr(u,f),i.push(ht.widget(u,()=>n(c),{key:a+"",side:10}));const p=Mr(l,u),h=Tc(l,u);i.push(ht.inline(p,h,{style:`background-color: ${c.color}70`},{inclusiveEnd:!0,inclusiveStart:!1}))}}}),Q.create(e.doc,i))},Uw=(e,{cursorBuilder:t=Kw,getSelection:n=o=>o.selection}={},r="cursor")=>new Ct({key:pi,state:{init(o,i){return Qf(i,e,t)},apply(o,i,s,a){const c=vt.getState(a),l=o.getMeta(pi);return c&&c.isChangeOrigin||l&&l.awarenessUpdated?Qf(a,e,t):i.map(o.mapping,o.doc)}},props:{decorations:o=>pi.getState(o)},view:o=>{const i=()=>{o.docView&&Ww(o,pi,{awarenessUpdated:!0})},s=()=>{const a=vt.getState(o.state),c=e.getLocalState()||{};if(o.hasFocus()&&a.binding!==null){const l=n(o.state),u=gi(l.anchor,a.type,a.binding.mapping),f=gi(l.head,a.type,a.binding.mapping);(c.cursor==null||!_c(Cr(c.cursor.anchor),u)||!_c(Cr(c.cursor.head),f))&&e.setLocalStateField(r,{anchor:u,head:f})}else c.cursor!=null&&oo(a.doc,a.type,Cr(c.cursor.anchor),a.binding.mapping)!==null&&e.setLocalStateField(r,null)};return e.on("change",i),o.dom.addEventListener("focusin",s),o.dom.addEventListener("focusout",s),{update:s,destroy:()=>{o.dom.removeEventListener("focusin",s),o.dom.removeEventListener("focusout",s),e.off("change",i),e.setLocalStateField(r,null)}}}}),Gw=e=>{const t=jn.getState(e).undoManager;if(t!=null)return t.undo(),!0},Yw=e=>{const t=jn.getState(e).undoManager;if(t!=null)return t.redo(),!0},Xw=({protectedNodes:e=new Set(["paragraph"]),trackedOrigins:t=[]}={})=>new Ct({key:jn,state:{init:(n,r)=>{const o=vt.getState(r),i=new cd(o.type,{trackedOrigins:new Set([vt].concat(t)),deleteFilter:s=>!(s instanceof Cc)||!(s.content instanceof ld)||!(s.content.type instanceof ud||s.content.type instanceof Ue&&e.has(s.content.type.nodeName))||s.content.type._length===0});return{undoManager:i,prevSel:null,hasUndoOps:i.undoStack.length>0,hasRedoOps:i.redoStack.length>0}},apply:(n,r,o,i)=>{const s=vt.getState(i).binding,a=r.undoManager,c=a.undoStack.length>0,l=a.redoStack.length>0;return s?{undoManager:a,prevSel:Sa(s,o),hasUndoOps:c,hasRedoOps:l}:c!==r.hasUndoOps||l!==r.hasRedoOps?Object.assign({},r,{hasUndoOps:a.undoStack.length>0,hasRedoOps:a.redoStack.length>0}):r}},view:n=>{const r=vt.getState(n.state),o=jn.getState(n.state).undoManager;return o.on("stack-item-added",({stackItem:i})=>{const s=r.binding;s&&i.meta.set(s,jn.getState(n.state).prevSel)}),o.on("stack-item-popped",({stackItem:i})=>{const s=r.binding;s&&(s.beforeTransactionSelection=i.meta.get(s)||s.beforeTransactionSelection)}),{destroy:()=>{o.destroy()}}}});kt.create({name:"collaboration",priority:1e3,addOptions(){return{document:null,field:"default",fragment:null}},onCreate(){this.editor.extensionManager.extensions.find(e=>e.name==="history")&&console.warn('[tiptap warn]: "@tiptap/extension-collaboration" comes with its own history support and is not compatible with "@tiptap/extension-history".')},addCommands(){return{undo:()=>({tr:e,state:t,dispatch:n})=>(e.setMeta("preventDispatch",!0),jn.getState(t).undoManager.undoStack.length===0?!1:n?Gw(t):!0),redo:()=>({tr:e,state:t,dispatch:n})=>(e.setMeta("preventDispatch",!0),jn.getState(t).undoManager.redoStack.length===0?!1:n?Yw(t):!0)}},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo()}},addProseMirrorPlugins(){const e=this.options.fragment?this.options.fragment:this.options.document.getXmlFragment(this.options.field);return[Bw(e),Xw()]}});const tp=e=>Array.from(e.entries()).map(([t,n])=>S({clientId:t},n.user)),ep=()=>null;kt.create({name:"collaborationCursor",addOptions(){return{provider:null,user:{name:null,color:null},render:e=>{const t=document.createElement("span");t.classList.add("collaboration-cursor__caret"),t.setAttribute("style",`border-color: ${e.color}`);const n=document.createElement("div");return n.classList.add("collaboration-cursor__label"),n.setAttribute("style",`background-color: ${e.color}`),n.insertBefore(document.createTextNode(e.name),null),t.insertBefore(n,null),t},onUpdate:ep}},onCreate(){this.options.onUpdate!==ep&&console.warn('[tiptap warn]: DEPRECATED: The "onUpdate" option is deprecated. Please use `editor.storage.collaborationCursor.users` instead. Read more: https://tiptap.dev/api/extensions/collaboration-cursor')},addStorage(){return{users:[]}},addCommands(){return{updateUser:e=>()=>(this.options.user=e,this.options.provider.awareness.setLocalStateField("user",this.options.user),!0),user:e=>({editor:t})=>(console.warn('[tiptap warn]: DEPRECATED: The "user" command is deprecated. Please use "updateUser" instead. Read more: https://tiptap.dev/api/extensions/collaboration-cursor'),t.commands.updateUser(e))}},addProseMirrorPlugins(){return[Uw((()=>(this.options.provider.awareness.setLocalStateField("user",this.options.user),this.storage.users=tp(this.options.provider.awareness.states),this.options.provider.awareness.on("update",()=>{this.storage.users=tp(this.options.provider.awareness.states)}),this.options.provider.awareness))(),{cursorBuilder:this.options.render})]}});const Zw=Vt.create({name:"taskList",addOptions(){return{HTMLAttributes:{}}},group:"block list",content:"taskItem+",parseHTML(){return[{tag:'ul[data-type="taskList"]',priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",Et(this.options.HTMLAttributes,e,{"data-type":"taskList"}),0]},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList("taskList","taskItem")}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),Qw=/^\s*(\[([ |x])\])\s$/,t1=Vt.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{}}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>e.getAttribute("data-checked")==="true",renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:'li[data-type="taskItem"]',priority:51}]},renderHTML({HTMLAttributes:e}){return["li",Et(this.options.HTMLAttributes,e,{"data-type":"taskItem"}),0]},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem("taskItem"),"Shift-Tab":()=>this.editor.commands.liftListItem("taskItem")};return this.options.nested?Jt(S({},e),{Tab:()=>this.editor.commands.sinkListItem("taskItem")}):e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:n,editor:r})=>{const o=document.createElement("li"),i=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),c=document.createElement("div");return i.contentEditable="false",a.type="checkbox",a.addEventListener("change",l=>{if(!r.isEditable){a.checked=!a.checked;return}const{checked:u}=l.target;r.isEditable&&typeof n=="function"&&r.chain().focus().command(({tr:f})=>(f.setNodeMarkup(n(),void 0,{checked:u}),!0)).run()}),Object.entries(this.options.HTMLAttributes).forEach(([l,u])=>{o.setAttribute(l,u)}),o.dataset.checked=e.attrs.checked,e.attrs.checked&&a.setAttribute("checked","checked"),i.append(a,s),o.append(i,c),Object.entries(t).forEach(([l,u])=>{o.setAttribute(l,u)}),{dom:o,contentDOM:c,update:l=>l.type!==this.type?!1:(o.dataset.checked=l.attrs.checked,l.attrs.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked"),!0)}}},addInputRules(){return[Qo({find:Qw,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),e1=/(?:^|\s)((?:==)((?:[^~]+))(?:==))$/,n1=/(?:^|\s)((?:==)((?:[^~]+))(?:==))/g,r1=mn.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",Et(this.options.HTMLAttributes,e),0]},addCommands(){return{setHighlight:e=>({commands:t})=>t.setMark("highlight",e),toggleHighlight:e=>({commands:t})=>t.toggleMark("highlight",e),unsetHighlight:()=>({commands:e})=>e.unsetMark("highlight")}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[$n({find:e1,type:this.type})]},addPasteRules(){return[Vn({find:n1,type:this.type})]}});function np(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var o=e.child(r),i=t.child(r);if(o==i){n+=o.nodeSize;continue}if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=np(o.content,i.content,n+1);if(a!=null)return a}n+=o.nodeSize}}function rp(e,t,n,r){for(var o=e.childCount,i=t.childCount;;){if(o==0||i==0)return o==i?null:{a:n,b:r};var s=e.child(--o),a=t.child(--i),c=s.nodeSize;if(s==a){n-=c,r-=c;continue}if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var l=0,u=Math.min(s.text.length,a.text.length);l<u&&s.text[s.text.length-l-1]==a.text[a.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=rp(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}}var T=function(t,n){if(this.content=t,this.size=n||0,n==null)for(var r=0;r<t.length;r++)this.size+=t[r].nodeSize},yi={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};T.prototype.nodesBetween=function(t,n,r,o,i){o===void 0&&(o=0);for(var s=0,a=0;a<n;s++){var c=this.content[s],l=a+c.nodeSize;if(l>t&&r(c,o+a,i,s)!==!1&&c.content.size){var u=a+1;c.nodesBetween(Math.max(0,t-u),Math.min(c.content.size,n-u),r,o+u)}a=l}};T.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)};T.prototype.textBetween=function(t,n,r,o){var i="",s=!0;return this.nodesBetween(t,n,function(a,c){a.isText?(i+=a.text.slice(Math.max(t,c)-c,n-c),s=!r):a.isLeaf&&o?(i+=typeof o=="function"?o(a):o,s=!r):!s&&a.isBlock&&(i+=r,s=!0)},0),i};T.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var n=this.lastChild,r=t.firstChild,o=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(o[o.length-1]=n.withText(n.text+r.text),i=1);i<t.content.length;i++)o.push(t.content[i]);return new T(o,this.size+t.size)};T.prototype.cut=function(t,n){if(n==null&&(n=this.size),t==0&&n==this.size)return this;var r=[],o=0;if(n>t)for(var i=0,s=0;s<n;i++){var a=this.content[i],c=s+a.nodeSize;c>t&&((s<t||c>n)&&(a.isText?a=a.cut(Math.max(0,t-s),Math.min(a.text.length,n-s)):a=a.cut(Math.max(0,t-s-1),Math.min(a.content.size,n-s-1))),r.push(a),o+=a.nodeSize),s=c}return new T(r,o)};T.prototype.cutByIndex=function(t,n){return t==n?T.empty:t==0&&n==this.content.length?this:new T(this.content.slice(t,n))};T.prototype.replaceChild=function(t,n){var r=this.content[t];if(r==n)return this;var o=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return o[t]=n,new T(o,i)};T.prototype.addToStart=function(t){return new T([t].concat(this.content),this.size+t.nodeSize)};T.prototype.addToEnd=function(t){return new T(this.content.concat(t),this.size+t.nodeSize)};T.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var n=0;n<this.content.length;n++)if(!this.content[n].eq(t.content[n]))return!1;return!0};yi.firstChild.get=function(){return this.content.length?this.content[0]:null};yi.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null};yi.childCount.get=function(){return this.content.length};T.prototype.child=function(t){var n=this.content[t];if(!n)throw new RangeError("Index "+t+" out of range for "+this);return n};T.prototype.maybeChild=function(t){return this.content[t]};T.prototype.forEach=function(t){for(var n=0,r=0;n<this.content.length;n++){var o=this.content[n];t(o,r,n),r+=o.nodeSize}};T.prototype.findDiffStart=function(t,n){return n===void 0&&(n=0),np(this,t,n)};T.prototype.findDiffEnd=function(t,n,r){return n===void 0&&(n=this.size),r===void 0&&(r=t.size),rp(this,t,n,r)};T.prototype.findIndex=function(t,n){if(n===void 0&&(n=-1),t==0)return bi(0,t);if(t==this.size)return bi(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var r=0,o=0;;r++){var i=this.child(r),s=o+i.nodeSize;if(s>=t)return s==t||n>0?bi(r+1,s):bi(r,o);o=s}};T.prototype.toString=function(){return"<"+this.toStringInner()+">"};T.prototype.toStringInner=function(){return this.content.join(", ")};T.prototype.toJSON=function(){return this.content.length?this.content.map(function(t){return t.toJSON()}):null};T.fromJSON=function(t,n){if(!n)return T.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new T(n.map(t.nodeFromJSON))};T.fromArray=function(t){if(!t.length)return T.empty;for(var n,r=0,o=0;o<t.length;o++){var i=t[o];r+=i.nodeSize,o&&i.isText&&t[o-1].sameMarkup(i)?(n||(n=t.slice(0,o)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new T(n||t,r)};T.from=function(t){if(!t)return T.empty;if(t instanceof T)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new T([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))};Object.defineProperties(T.prototype,yi);var Ta={index:0,offset:0};function bi(e,t){return Ta.index=e,Ta.offset=t,Ta}T.empty=new T([],0);function wi(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!wi(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!wi(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}var U=function(t,n){this.type=t,this.attrs=n};U.prototype.addToSet=function(t){for(var n,r=!1,o=0;o<t.length;o++){var i=t[o];if(this.eq(i))return t;if(this.type.excludes(i.type))n||(n=t.slice(0,o));else{if(i.type.excludes(this.type))return t;!r&&i.type.rank>this.type.rank&&(n||(n=t.slice(0,o)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=t.slice()),r||n.push(this),n};U.prototype.removeFromSet=function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return t.slice(0,n).concat(t.slice(n+1));return t};U.prototype.isInSet=function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return!0;return!1};U.prototype.eq=function(t){return this==t||this.type==t.type&&wi(this.attrs,t.attrs)};U.prototype.toJSON=function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return t};U.fromJSON=function(t,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");var r=t.marks[n.type];if(!r)throw new RangeError("There is no mark type "+n.type+" in this schema");return r.create(n.attrs)};U.sameSet=function(t,n){if(t==n)return!0;if(t.length!=n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].eq(n[r]))return!1;return!0};U.setFrom=function(t){if(!t||t.length==0)return U.none;if(t instanceof U)return[t];var n=t.slice();return n.sort(function(r,o){return r.type.rank-o.type.rank}),n};U.none=[];function Je(e){var t=Error.call(this,e);return t.__proto__=Je.prototype,t}Je.prototype=Object.create(Error.prototype);Je.prototype.constructor=Je;Je.prototype.name="ReplaceError";var I=function(t,n,r){this.content=t,this.openStart=n,this.openEnd=r},op={size:{configurable:!0}};op.size.get=function(){return this.content.size-this.openStart-this.openEnd};I.prototype.insertAt=function(t,n){var r=sp(this.content,t+this.openStart,n,null);return r&&new I(r,this.openStart,this.openEnd)};I.prototype.removeBetween=function(t,n){return new I(ip(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)};I.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd};I.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"};I.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t};I.fromJSON=function(t,n){if(!n)return I.empty;var r=n.openStart||0,o=n.openEnd||0;if(typeof r!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new I(T.fromJSON(t,n.content),r,o)};I.maxOpen=function(t,n){n===void 0&&(n=!0);for(var r=0,o=0,i=t.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(var s=t.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)o++;return new I(t,r,o)};Object.defineProperties(I.prototype,op);function ip(e,t,n){var r=e.findIndex(t),o=r.index,i=r.offset,s=e.maybeChild(o),a=e.findIndex(n),c=a.index,l=a.offset;if(i==t||s.isText){if(l!=n&&!e.child(c).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return e.replaceChild(o,s.copy(ip(s.content,t-i-1,n-i-1)))}function sp(e,t,n,r){var o=e.findIndex(t),i=o.index,s=o.offset,a=e.maybeChild(i);if(s==t||a.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));var c=sp(a.content,t-s-1,n);return c&&e.replaceChild(i,a.copy(c))}I.empty=new I(T.empty,0,0);function o1(e,t,n){if(n.openStart>e.depth)throw new Je("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new Je("Inconsistent open depths");return ap(e,t,n,0)}function ap(e,t,n,r){var o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){var s=ap(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&e.depth==r&&t.depth==r){var a=e.parent,c=a.content;return Wn(a,c.cut(0,e.parentOffset).append(n.content).append(c.cut(t.parentOffset)))}else{var l=i1(n,e),u=l.start,f=l.end;return Wn(i,lp(e,u,f,t,r))}else return Wn(i,ki(e,t,r))}function cp(e,t){if(!t.type.compatibleContent(e.type))throw new Je("Cannot join "+t.type.name+" onto "+e.type.name)}function _a(e,t,n){var r=e.node(n);return cp(r,t.node(n)),r}function Jn(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function io(e,t,n,r){var o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(Jn(e.nodeAfter,r),i++));for(var a=i;a<s;a++)Jn(o.child(a),r);t&&t.depth==n&&t.textOffset&&Jn(t.nodeBefore,r)}function Wn(e,t){if(!e.type.validContent(t))throw new Je("Invalid content for node "+e.type.name);return e.copy(t)}function lp(e,t,n,r,o){var i=e.depth>o&&_a(e,t,o+1),s=r.depth>o&&_a(n,r,o+1),a=[];return io(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(cp(i,s),Jn(Wn(i,lp(e,t,n,r,o+1)),a)):(i&&Jn(Wn(i,ki(e,t,o+1)),a),io(t,n,o,a),s&&Jn(Wn(s,ki(n,r,o+1)),a)),io(r,null,o,a),new T(a)}function ki(e,t,n){var r=[];if(io(null,e,n,r),e.depth>n){var o=_a(e,t,n+1);Jn(Wn(o,ki(e,t,n+1)),r)}return io(t,null,n,r),new T(r)}function i1(e,t){for(var n=t.depth-e.openStart,r=t.node(n),o=r.copy(e.content),i=n-1;i>=0;i--)o=t.node(i).copy(T.from(o));return{start:o.resolveNoCache(e.openStart+n),end:o.resolveNoCache(o.content.size-e.openEnd-n)}}var at=function(t,n,r){this.pos=t,this.path=n,this.depth=n.length/3-1,this.parentOffset=r},vr={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};at.prototype.resolveDepth=function(t){return t==null?this.depth:t<0?this.depth+t:t};vr.parent.get=function(){return this.node(this.depth)};vr.doc.get=function(){return this.node(0)};at.prototype.node=function(t){return this.path[this.resolveDepth(t)*3]};at.prototype.index=function(t){return this.path[this.resolveDepth(t)*3+1]};at.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)};at.prototype.start=function(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1};at.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size};at.prototype.before=function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]};at.prototype.after=function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize};vr.textOffset.get=function(){return this.pos-this.path[this.path.length-1]};vr.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r};vr.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)};at.prototype.posAtIndex=function(t,n){n=this.resolveDepth(n);for(var r=this.path[n*3],o=n==0?0:this.path[n*3-1]+1,i=0;i<t;i++)o+=r.child(i).nodeSize;return o};at.prototype.marks=function(){var t=this.parent,n=this.index();if(t.content.size==0)return U.none;if(this.textOffset)return t.child(n).marks;var r=t.maybeChild(n-1),o=t.maybeChild(n);if(!r){var i=r;r=o,o=i}for(var s=r.marks,a=0;a<s.length;a++)s[a].type.spec.inclusive===!1&&(!o||!s[a].isInSet(o.marks))&&(s=s[a--].removeFromSet(s));return s};at.prototype.marksAcross=function(t){var n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;for(var r=n.marks,o=t.parent.maybeChild(t.index()),i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!o||!r[i].isInSet(o.marks))&&(r=r[i--].removeFromSet(r));return r};at.prototype.sharedDepth=function(t){for(var n=this.depth;n>0;n--)if(this.start(n)<=t&&this.end(n)>=t)return n;return 0};at.prototype.blockRange=function(t,n){if(t===void 0&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!n||n(this.node(r))))return new up(this,t,r)};at.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset};at.prototype.max=function(t){return t.pos>this.pos?t:this};at.prototype.min=function(t){return t.pos<this.pos?t:this};at.prototype.toString=function(){for(var t="",n=1;n<=this.depth;n++)t+=(t?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return t+":"+this.parentOffset};at.resolve=function(t,n){if(!(n>=0&&n<=t.content.size))throw new RangeError("Position "+n+" out of range");for(var r=[],o=0,i=n,s=t;;){var a=s.content.findIndex(i),c=a.index,l=a.offset,u=i-l;if(r.push(s,c,o+l),!u||(s=s.child(c),s.isText))break;i=u-1,o+=l+1}return new at(n,r,i)};at.resolveCached=function(t,n){for(var r=0;r<Ea.length;r++){var o=Ea[r];if(o.pos==n&&o.doc==t)return o}var i=Ea[Aa]=at.resolve(t,n);return Aa=(Aa+1)%s1,i};Object.defineProperties(at.prototype,vr);var Ea=[],Aa=0,s1=12,up=function(t,n,r){this.$from=t,this.$to=n,this.depth=r},mr={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};mr.start.get=function(){return this.$from.before(this.depth+1)};mr.end.get=function(){return this.$to.after(this.depth+1)};mr.parent.get=function(){return this.$from.node(this.depth)};mr.startIndex.get=function(){return this.$from.index(this.depth)};mr.endIndex.get=function(){return this.$to.indexAfter(this.depth)};Object.defineProperties(up.prototype,mr);var a1=Object.create(null),G=function(t,n,r,o){this.type=t,this.attrs=n,this.content=r||T.empty,this.marks=o||U.none},fe={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};fe.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size};fe.childCount.get=function(){return this.content.childCount};G.prototype.child=function(t){return this.content.child(t)};G.prototype.maybeChild=function(t){return this.content.maybeChild(t)};G.prototype.forEach=function(t){this.content.forEach(t)};G.prototype.nodesBetween=function(t,n,r,o){o===void 0&&(o=0),this.content.nodesBetween(t,n,r,o,this)};G.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)};fe.textContent.get=function(){return this.textBetween(0,this.content.size,"")};G.prototype.textBetween=function(t,n,r,o){return this.content.textBetween(t,n,r,o)};fe.firstChild.get=function(){return this.content.firstChild};fe.lastChild.get=function(){return this.content.lastChild};G.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)};G.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)};G.prototype.hasMarkup=function(t,n,r){return this.type==t&&wi(this.attrs,n||t.defaultAttrs||a1)&&U.sameSet(this.marks,r||U.none)};G.prototype.copy=function(t){return t===void 0&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)};G.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)};G.prototype.cut=function(t,n){return t==0&&n==this.content.size?this:this.copy(this.content.cut(t,n))};G.prototype.slice=function(t,n,r){if(n===void 0&&(n=this.content.size),r===void 0&&(r=!1),t==n)return I.empty;var o=this.resolve(t),i=this.resolve(n),s=r?0:o.sharedDepth(n),a=o.start(s),c=o.node(s),l=c.content.cut(o.pos-a,i.pos-a);return new I(l,o.depth-s,i.depth-s)};G.prototype.replace=function(t,n,r){return o1(this.resolve(t),this.resolve(n),r)};G.prototype.nodeAt=function(t){for(var n=this;;){var r=n.content.findIndex(t),o=r.index,i=r.offset;if(n=n.maybeChild(o),!n)return null;if(i==t||n.isText)return n;t-=i+1}};G.prototype.childAfter=function(t){var n=this.content.findIndex(t),r=n.index,o=n.offset;return{node:this.content.maybeChild(r),index:r,offset:o}};G.prototype.childBefore=function(t){if(t==0)return{node:null,index:0,offset:0};var n=this.content.findIndex(t),r=n.index,o=n.offset;if(o<t)return{node:this.content.child(r),index:r,offset:o};var i=this.content.child(r-1);return{node:i,index:r-1,offset:o-i.nodeSize}};G.prototype.resolve=function(t){return at.resolveCached(this,t)};G.prototype.resolveNoCache=function(t){return at.resolve(this,t)};G.prototype.rangeHasMark=function(t,n,r){var o=!1;return n>t&&this.nodesBetween(t,n,function(i){return r.isInSet(i.marks)&&(o=!0),!o}),o};fe.isBlock.get=function(){return this.type.isBlock};fe.isTextblock.get=function(){return this.type.isTextblock};fe.inlineContent.get=function(){return this.type.inlineContent};fe.isInline.get=function(){return this.type.isInline};fe.isText.get=function(){return this.type.isText};fe.isLeaf.get=function(){return this.type.isLeaf};fe.isAtom.get=function(){return this.type.isAtom};G.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),c1(this.marks,t)};G.prototype.contentMatchAt=function(t){var n=this.type.contentMatch.matchFragment(this.content,0,t);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n};G.prototype.canReplace=function(t,n,r,o,i){r===void 0&&(r=T.empty),o===void 0&&(o=0),i===void 0&&(i=r.childCount);var s=this.contentMatchAt(t).matchFragment(r,o,i),a=s&&s.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(var c=o;c<i;c++)if(!this.type.allowsMarks(r.child(c).marks))return!1;return!0};G.prototype.canReplaceWith=function(t,n,r,o){if(o&&!this.type.allowsMarks(o))return!1;var i=this.contentMatchAt(t).matchType(r),s=i&&i.matchFragment(this.content,n);return s?s.validEnd:!1};G.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)};G.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var t=U.none,n=0;n<this.marks.length;n++)t=this.marks[n].addToSet(t);if(!U.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map(function(r){return r.type.name}));this.content.forEach(function(r){return r.check()})};G.prototype.toJSON=function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(function(r){return r.toJSON()})),t};G.fromJSON=function(t,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");var r=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(t.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(n.text,r)}var o=T.fromJSON(t,n.content);return t.nodeType(n.type).create(n.attrs,o,r)};Object.defineProperties(G.prototype,fe);function c1(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var Ut=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},Si={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Ut.parse=function(t,n){var r=new Oi(t,n);if(r.next==null)return Ut.empty;var o=pp(r);r.next&&r.err("Unexpected trailing text");var i=v1(d1(o));return m1(i,r),i};Ut.prototype.matchType=function(t){for(var n=0;n<this.next.length;n+=2)if(this.next[n]==t)return this.next[n+1];return null};Ut.prototype.matchFragment=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=t.childCount);for(var o=this,i=n;o&&i<r;i++)o=o.matchType(t.child(i).type);return o};Si.inlineContent.get=function(){var e=this.next[0];return e?e.isInline:!1};Si.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}};Ut.prototype.compatible=function(t){for(var n=0;n<this.next.length;n+=2)for(var r=0;r<t.next.length;r+=2)if(this.next[n]==t.next[r])return!0;return!1};Ut.prototype.fillBefore=function(t,n,r){n===void 0&&(n=!1),r===void 0&&(r=0);var o=[this];function i(s,a){var c=s.matchFragment(t,r);if(c&&(!n||c.validEnd))return T.from(a.map(function(h){return h.createAndFill()}));for(var l=0;l<s.next.length;l+=2){var u=s.next[l],f=s.next[l+1];if(!(u.isText||u.hasRequiredAttrs())&&o.indexOf(f)==-1){o.push(f);var p=i(f,a.concat(u));if(p)return p}}}return i(this,[])};Ut.prototype.findWrapping=function(t){for(var n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];var r=this.computeWrapping(t);return this.wrapCache.push(t,r),r};Ut.prototype.computeWrapping=function(t){for(var n=Object.create(null),r=[{match:this,type:null,via:null}];r.length;){var o=r.shift(),i=o.match;if(i.matchType(t)){for(var s=[],a=o;a.type;a=a.via)s.push(a.type);return s.reverse()}for(var c=0;c<i.next.length;c+=2){var l=i.next[c];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!o.type||i.next[c+1].validEnd)&&(r.push({match:l.contentMatch,type:l,via:o}),n[l.name]=!0)}}};Si.edgeCount.get=function(){return this.next.length>>1};Ut.prototype.edge=function(t){var n=t<<1;if(n>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[n],next:this.next[n+1]}};Ut.prototype.toString=function(){var t=[];function n(r){t.push(r);for(var o=1;o<r.next.length;o+=2)t.indexOf(r.next[o])==-1&&n(r.next[o])}return n(this),t.map(function(r,o){for(var i=o+(r.validEnd?"*":" ")+" ",s=0;s<r.next.length;s+=2)i+=(s?", ":"")+r.next[s].name+"->"+t.indexOf(r.next[s+1]);return i}).join(`
`)};Object.defineProperties(Ut.prototype,Si);Ut.empty=new Ut(!0);var Oi=function(t,n){this.string=t,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()},fp={next:{configurable:!0}};fp.next.get=function(){return this.tokens[this.pos]};Oi.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)};Oi.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")};Object.defineProperties(Oi.prototype,fp);function pp(e){var t=[];do t.push(l1(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function l1(e){var t=[];do t.push(u1(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function u1(e){for(var t=h1(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=f1(e,t);else break;return t}function hp(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function f1(e,t){var n=hp(e),r=n;return e.eat(",")&&(e.next!="}"?r=hp(e):r=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function p1(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(t)>-1&&o.push(s)}return o.length==0&&e.err("No node type or group '"+t+"' found"),o}function h1(e){if(e.eat("(")){var t=pp(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{var n=p1(e,e.next).map(function(r){return e.inline==null?e.inline=r.isInline:e.inline!=r.isInline&&e.err("Mixing inline and block content"),{type:"name",value:r}});return e.pos++,n.length==1?n[0]:{type:"choice",exprs:n}}}function d1(e){var t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(s,a,c){var l={term:c,to:a};return t[s].push(l),l}function o(s,a){s.forEach(function(c){return c.to=a})}function i(s,a){if(s.type=="choice")return s.exprs.reduce(function(b,y){return b.concat(i(y,a))},[]);if(s.type=="seq")for(var c=0;;c++){var l=i(s.exprs[c],a);if(c==s.exprs.length-1)return l;o(l,a=n())}else if(s.type=="star"){var u=n();return r(a,u),o(i(s.expr,u),u),[r(u)]}else if(s.type=="plus"){var f=n();return o(i(s.expr,a),f),o(i(s.expr,f),f),[r(f)]}else{if(s.type=="opt")return[r(a)].concat(i(s.expr,a));if(s.type=="range"){for(var p=a,h=0;h<s.min;h++){var d=n();o(i(s.expr,p),d),p=d}if(s.max==-1)o(i(s.expr,p),p);else for(var v=s.min;v<s.max;v++){var g=n();r(p,g),o(i(s.expr,p),g),p=g}return[r(p)]}else if(s.type=="name")return[r(a,null,s.value)]}}}function dp(e,t){return t-e}function vp(e,t){var n=[];return r(t),n.sort(dp);function r(o){var i=e[o];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(o);for(var s=0;s<i.length;s++){var a=i[s],c=a.term,l=a.to;!c&&n.indexOf(l)==-1&&r(l)}}}function v1(e){var t=Object.create(null);return n(vp(e,0));function n(r){var o=[];r.forEach(function(c){e[c].forEach(function(l){var u=l.term,f=l.to;if(!!u){var p=o.indexOf(u),h=p>-1&&o[p+1];vp(e,f).forEach(function(d){h||o.push(u,h=[]),h.indexOf(d)==-1&&h.push(d)})}})});for(var i=t[r.join(",")]=new Ut(r.indexOf(e.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(dp);i.next.push(o[s],t[a.join(",")]||n(a))}return i}}function m1(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),i&&!(c.isText||c.hasRequiredAttrs())&&(i=!1),r.indexOf(l)==-1&&r.push(l)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function mp(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function gp(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(o===void 0){var i=e[r];if(i.hasDefault)o=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=o}return n}function yp(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new bp(e[n]);return t}var pe=function(t,n,r){this.name=t,this.schema=n,this.spec=r,this.groups=r.group?r.group.split(" "):[],this.attrs=yp(r.attrs),this.defaultAttrs=mp(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"},so={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};so.isInline.get=function(){return!this.isBlock};so.isTextblock.get=function(){return this.isBlock&&this.inlineContent};so.isLeaf.get=function(){return this.contentMatch==Ut.empty};so.isAtom.get=function(){return this.isLeaf||this.spec.atom};pe.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1};pe.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)};pe.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:gp(this.attrs,t)};pe.prototype.create=function(t,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new G(this,this.computeAttrs(t),T.from(n),U.setFrom(r))};pe.prototype.createChecked=function(t,n,r){if(n=T.from(n),!this.validContent(n))throw new RangeError("Invalid content for node "+this.name);return new G(this,this.computeAttrs(t),n,U.setFrom(r))};pe.prototype.createAndFill=function(t,n,r){if(t=this.computeAttrs(t),n=T.from(n),n.size){var o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}var i=this.contentMatch.matchFragment(n).fillBefore(T.empty,!0);return i?new G(this,t,n.append(i),U.setFrom(r)):null};pe.prototype.validContent=function(t){var n=this.contentMatch.matchFragment(t);if(!n||!n.validEnd)return!1;for(var r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0};pe.prototype.allowsMarkType=function(t){return this.markSet==null||this.markSet.indexOf(t)>-1};pe.prototype.allowsMarks=function(t){if(this.markSet==null)return!0;for(var n=0;n<t.length;n++)if(!this.allowsMarkType(t[n].type))return!1;return!0};pe.prototype.allowedMarks=function(t){if(this.markSet==null)return t;for(var n,r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?n&&n.push(t[r]):n||(n=t.slice(0,r));return n?n.length?n:U.empty:t};pe.compile=function(t,n){var r=Object.create(null);t.forEach(function(s,a){return r[s]=new pe(s,n,a)});var o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(var i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r};Object.defineProperties(pe.prototype,so);var bp=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},wp={isRequired:{configurable:!0}};wp.isRequired.get=function(){return!this.hasDefault};Object.defineProperties(bp.prototype,wp);var qn=function(t,n,r,o){this.name=t,this.schema=r,this.spec=o,this.attrs=yp(o.attrs),this.rank=n,this.excluded=null;var i=mp(this.attrs);this.instance=i&&new U(this,i)};qn.prototype.create=function(t){return!t&&this.instance?this.instance:new U(this,gp(this.attrs,t))};qn.compile=function(t,n){var r=Object.create(null),o=0;return t.forEach(function(i,s){return r[i]=new qn(i,o++,n,s)}),r};qn.prototype.removeFromSet=function(t){for(var n=0;n<t.length;n++)t[n].type==this&&(t=t.slice(0,n).concat(t.slice(n+1)),n--);return t};qn.prototype.isInSet=function(t){for(var n=0;n<t.length;n++)if(t[n].type==this)return t[n]};qn.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var Na={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},g1={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},kp={ol:!0,ul:!0},Ia=1,Pa=2,ao=4;function Sp(e){return(e?Ia:0)|(e==="full"?Pa:0)}var en=function(t,n,r,o,i,s,a){this.type=t,this.attrs=n,this.solid=i,this.match=s||(a&ao?null:t.contentMatch),this.options=a,this.content=[],this.marks=r,this.activeMarks=U.none,this.pendingMarks=o,this.stashMarks=[]};en.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var n=this.type.contentMatch.fillBefore(T.from(t));if(n)this.match=this.type.contentMatch.matchFragment(n);else{var r=this.type.contentMatch,o;return(o=r.findWrapping(t.type))?(this.match=r,o):null}}return this.match.findWrapping(t.type)};en.prototype.finish=function(t){if(!(this.options&Ia)){var n=this.content[this.content.length-1],r;n&&n.isText&&(r=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-r[0].length)))}var o=T.from(this.content);return!t&&this.match&&(o=o.append(this.match.fillBefore(T.empty,!0))),this.type?this.type.create(this.attrs,o,this.marks):o};en.prototype.popFromStashMark=function(t){for(var n=this.stashMarks.length-1;n>=0;n--)if(t.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]};en.prototype.applyPending=function(t){for(var n=0,r=this.pendingMarks;n<r.length;n++){var o=r[n];(this.type?this.type.allowsMarkType(o.type):w1(o.type,t))&&!o.isInSet(this.activeMarks)&&(this.activeMarks=o.addToSet(this.activeMarks),this.pendingMarks=o.removeFromSet(this.pendingMarks))}};en.prototype.inlineContext=function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!Na.hasOwnProperty(t.parentNode.nodeName.toLowerCase())};var ct=function(t,n,r){this.parser=t,this.options=n,this.isOpen=r;var o=n.topNode,i,s=Sp(n.preserveWhitespace)|(r?ao:0);o?i=new en(o.type,o.attrs,U.none,U.none,!0,n.topMatch||o.type.contentMatch,s):r?i=new en(null,null,U.none,U.none,!0,null,s):i=new en(t.schema.topNodeType,null,U.none,U.none,!0,null,s),this.nodes=[i],this.open=0,this.find=n.findPositions,this.needsBlock=!1},Da={top:{configurable:!0},currentPos:{configurable:!0}};Da.top.get=function(){return this.nodes[this.open]};ct.prototype.addDOM=function(t){if(t.nodeType==3)this.addTextNode(t);else if(t.nodeType==1){var n=t.getAttribute("style"),r=n?this.readStyles(b1(n)):null,o=this.top;if(r!=null)for(var i=0;i<r.length;i++)this.addPendingMark(r[i]);if(this.addElement(t),r!=null)for(var s=0;s<r.length;s++)this.removePendingMark(r[s],o)}};ct.prototype.addTextNode=function(t){var n=t.nodeValue,r=this.top;if(r.options&Pa||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(r.options&Ia)r.options&Pa?n=n.replace(/\r\n?/g,`
`):n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){var o=r.content[r.content.length-1],i=t.previousSibling;(!o||i&&i.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(t)}else this.findInside(t)};ct.prototype.addElement=function(t,n){var r=t.nodeName.toLowerCase(),o;kp.hasOwnProperty(r)&&this.parser.normalizeLists&&y1(t);var i=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(o=this.parser.matchTag(t,this,n));if(i?i.ignore:g1.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(t=i.skip);var s,a=this.top,c=this.needsBlock;if(Na.hasOwnProperty(r))s=!0,a.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t);return}this.addAll(t),s&&this.sync(a),this.needsBlock=c}else this.addElementByRule(t,i,i.consuming===!1?o:null)};ct.prototype.leafFallback=function(t){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`))};ct.prototype.ignoreFallback=function(t){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))};ct.prototype.readStyles=function(t){var n=U.none;t:for(var r=0;r<t.length;r+=2)for(var o=null;;){var i=this.parser.matchStyle(t[r],t[r+1],this,o);if(!i)continue t;if(i.ignore)return null;if(n=this.parser.schema.marks[i.mark].create(i.attrs).addToSet(n),i.consuming===!1)o=i;else break}return n};ct.prototype.addElementByRule=function(t,n,r){var o=this,i,s,a,c;n.node?(s=this.parser.schema.nodes[n.node],s.isLeaf?this.insertNode(s.create(n.attrs))||this.leafFallback(t):i=this.enter(s,n.attrs,n.preserveWhitespace)):(a=this.parser.schema.marks[n.mark],c=a.create(n.attrs),this.addPendingMark(c));var l=this.top;if(s&&s.isLeaf)this.findInside(t);else if(r)this.addElement(t,r);else if(n.getContent)this.findInside(t),n.getContent(t,this.parser.schema).forEach(function(f){return o.insertNode(f)});else{var u=n.contentElement;typeof u=="string"?u=t.querySelector(u):typeof u=="function"&&(u=u(t)),u||(u=t),this.findAround(t,u,!0),this.addAll(u,i)}i&&(this.sync(l),this.open--),c&&this.removePendingMark(c,l)};ct.prototype.addAll=function(t,n,r,o){for(var i=r||0,s=r?t.childNodes[r]:t.firstChild,a=o==null?null:t.childNodes[o];s!=a;s=s.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(s),n&&Na.hasOwnProperty(s.nodeName.toLowerCase())&&this.sync(n);this.findAtPoint(t,i)};ct.prototype.findPlace=function(t){for(var n,r,o=this.open;o>=0;o--){var i=this.nodes[o],s=i.findWrapping(t);if(s&&(!n||n.length>s.length)&&(n=s,r=i,!s.length)||i.solid)break}if(!n)return!1;this.sync(r);for(var a=0;a<n.length;a++)this.enterInner(n[a],null,!1);return!0};ct.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(t)){this.closeExtra();var r=this.top;r.applyPending(t.type),r.match&&(r.match=r.match.matchType(t.type));for(var o=r.activeMarks,i=0;i<t.marks.length;i++)(!r.type||r.type.allowsMarkType(t.marks[i].type))&&(o=t.marks[i].addToSet(o));return r.content.push(t.mark(o)),!0}return!1};ct.prototype.enter=function(t,n,r){var o=this.findPlace(t.create(n));return o&&this.enterInner(t,n,!0,r),o};ct.prototype.enterInner=function(t,n,r,o){this.closeExtra();var i=this.top;i.applyPending(t),i.match=i.match&&i.match.matchType(t,n);var s=o==null?i.options&~ao:Sp(o);i.options&ao&&i.content.length==0&&(s|=ao),this.nodes.push(new en(t,n,i.activeMarks,i.pendingMarks,r,null,s)),this.open++};ct.prototype.closeExtra=function(t){var n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(t));this.nodes.length=this.open+1}};ct.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)};ct.prototype.sync=function(t){for(var n=this.open;n>=0;n--)if(this.nodes[n]==t){this.open=n;return}};Da.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e};ct.prototype.findAtPoint=function(t,n){if(this.find)for(var r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)};ct.prototype.findInside=function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].pos==null&&t.nodeType==1&&t.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)};ct.prototype.findAround=function(t,n,r){if(t!=n&&this.find){for(var o=0;o<this.find.length;o++)if(this.find[o].pos==null&&t.nodeType==1&&t.contains(this.find[o].node)){var i=n.compareDocumentPosition(this.find[o].node);i&(r?2:4)&&(this.find[o].pos=this.currentPos)}}};ct.prototype.findInText=function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&(this.find[n].pos=this.currentPos-(t.nodeValue.length-this.find[n].offset))};ct.prototype.matchesContext=function(t){var n=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var r=t.split("/"),o=this.options.context,i=!this.isOpen&&(!o||o.parent.type==this.nodes[0].type),s=-(o?o.depth+1:0)+(i?0:1),a=function(c,l){for(;c>=0;c--){var u=r[c];if(u==""){if(c==r.length-1||c==0)continue;for(;l>=s;l--)if(a(c-1,l))return!0;return!1}else{var f=l>0||l==0&&i?n.nodes[l].type:o&&l>=s?o.node(l-s).type:null;if(!f||f.name!=u&&f.groups.indexOf(u)==-1)return!1;l--}}return!0};return a(r.length-1,this.open)};ct.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var n=t.depth;n>=0;n--){var r=t.node(n).contentMatchAt(t.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(var o in this.parser.schema.nodes){var i=this.parser.schema.nodes[o];if(i.isTextblock&&i.defaultAttrs)return i}};ct.prototype.addPendingMark=function(t){var n=k1(t,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)};ct.prototype.removePendingMark=function(t,n){for(var r=this.open;r>=0;r--){var o=this.nodes[r],i=o.pendingMarks.lastIndexOf(t);if(i>-1)o.pendingMarks=t.removeFromSet(o.pendingMarks);else{o.activeMarks=t.removeFromSet(o.activeMarks);var s=o.popFromStashMark(t);s&&o.type&&o.type.allowsMarkType(s.type)&&(o.activeMarks=s.addToSet(o.activeMarks))}if(o==n)break}};Object.defineProperties(ct.prototype,Da);function y1(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&kp.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):r=="li"?n=t:r&&(n=null)}}function b1(e){for(var t=/\s*([\w-]+)\s*:\s*([^;]+)/g,n,r=[];n=t.exec(e);)r.push(n[1],n[2].trim());return r}function w1(e,t){var n=t.schema.nodes,r=function(s){var a=n[s];if(!!a.allowsMarkType(e)){var c=[],l=function(u){c.push(u);for(var f=0;f<u.edgeCount;f++){var p=u.edge(f),h=p.type,d=p.next;if(h==t||c.indexOf(d)<0&&l(d))return!0}};if(l(a.contentMatch))return{v:!0}}};for(var o in n){var i=r(o);if(i)return i.v}}function k1(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}var Op=65535,xp=Math.pow(2,16);function S1(e,t){return e+t*xp}function Mp(e){return e&Op}function O1(e){return(e-(e&Op))/xp}var Ra=function(t,n,r){n===void 0&&(n=!1),r===void 0&&(r=null),this.pos=t,this.deleted=n,this.recover=r},It=function(t,n){n===void 0&&(n=!1),this.ranges=t,this.inverted=n};It.prototype.recover=function(t){var n=0,r=Mp(t);if(!this.inverted)for(var o=0;o<r;o++)n+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[r*3]+n+O1(t)};It.prototype.mapResult=function(t,n){return n===void 0&&(n=1),this._map(t,n,!1)};It.prototype.map=function(t,n){return n===void 0&&(n=1),this._map(t,n,!0)};It.prototype._map=function(t,n,r){for(var o=0,i=this.inverted?2:1,s=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var c=this.ranges[a]-(this.inverted?o:0);if(c>t)break;var l=this.ranges[a+i],u=this.ranges[a+s],f=c+l;if(t<=f){var p=l?t==c?-1:t==f?1:n:n,h=c+o+(p<0?0:u);if(r)return h;var d=t==(n<0?c:f)?null:S1(a/3,t-c);return new Ra(h,n<0?t!=c:t!=f,d)}o+=u-l}return r?t+o:new Ra(t+o)};It.prototype.touches=function(t,n){for(var r=0,o=Mp(n),i=this.inverted?2:1,s=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var c=this.ranges[a]-(this.inverted?r:0);if(c>t)break;var l=this.ranges[a+i],u=c+l;if(t<=u&&a==o*3)return!0;r+=this.ranges[a+s]-l}return!1};It.prototype.forEach=function(t){for(var n=this.inverted?2:1,r=this.inverted?1:2,o=0,i=0;o<this.ranges.length;o+=3){var s=this.ranges[o],a=s-(this.inverted?i:0),c=s+(this.inverted?0:i),l=this.ranges[o+n],u=this.ranges[o+r];t(a,a+l,c,c+u),i+=u-l}};It.prototype.invert=function(){return new It(this.ranges,!this.inverted)};It.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)};It.offset=function(t){return t==0?It.empty:new It(t<0?[0,-t,0]:[0,0,t])};It.empty=new It([]);var Gt=function(t,n,r,o){this.maps=t||[],this.from=r||0,this.to=o==null?this.maps.length:o,this.mirror=n};Gt.prototype.slice=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=this.maps.length),new Gt(this.maps,this.mirror,t,n)};Gt.prototype.copy=function(){return new Gt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)};Gt.prototype.appendMap=function(t,n){this.to=this.maps.push(t),n!=null&&this.setMirror(this.maps.length-1,n)};Gt.prototype.appendMapping=function(t){for(var n=0,r=this.maps.length;n<t.maps.length;n++){var o=t.getMirror(n);this.appendMap(t.maps[n],o!=null&&o<n?r+o:null)}};Gt.prototype.getMirror=function(t){if(this.mirror){for(var n=0;n<this.mirror.length;n++)if(this.mirror[n]==t)return this.mirror[n+(n%2?-1:1)]}};Gt.prototype.setMirror=function(t,n){this.mirror||(this.mirror=[]),this.mirror.push(t,n)};Gt.prototype.appendMappingInverted=function(t){for(var n=t.maps.length-1,r=this.maps.length+t.maps.length;n>=0;n--){var o=t.getMirror(n);this.appendMap(t.maps[n].invert(),o!=null&&o>n?r-o-1:null)}};Gt.prototype.invert=function(){var t=new Gt;return t.appendMappingInverted(this),t};Gt.prototype.map=function(t,n){if(n===void 0&&(n=1),this.mirror)return this._map(t,n,!0);for(var r=this.from;r<this.to;r++)t=this.maps[r].map(t,n);return t};Gt.prototype.mapResult=function(t,n){return n===void 0&&(n=1),this._map(t,n,!1)};Gt.prototype._map=function(t,n,r){for(var o=!1,i=this.from;i<this.to;i++){var s=this.maps[i],a=s.mapResult(t,n);if(a.recover!=null){var c=this.getMirror(i);if(c!=null&&c>i&&c<this.to){i=c,t=this.maps[c].recover(a.recover);continue}}a.deleted&&(o=!0),t=a.pos}return r?t:new Ra(t,o)};function gr(e){var t=Error.call(this,e);return t.__proto__=gr.prototype,t}gr.prototype=Object.create(Error.prototype);gr.prototype.constructor=gr;gr.prototype.name="TransformError";var pt=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Gt},Ba={before:{configurable:!0},docChanged:{configurable:!0}};Ba.before.get=function(){return this.docs.length?this.docs[0]:this.doc};pt.prototype.step=function(t){var n=this.maybeStep(t);if(n.failed)throw new gr(n.failed);return this};pt.prototype.maybeStep=function(t){var n=t.apply(this.doc);return n.failed||this.addStep(t,n.doc),n};Ba.docChanged.get=function(){return this.steps.length>0};pt.prototype.addStep=function(t,n){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=n};Object.defineProperties(pt.prototype,Ba);function xi(){throw new Error("Override me")}var La=Object.create(null),Ht=function(){};Ht.prototype.apply=function(t){return xi()};Ht.prototype.getMap=function(){return It.empty};Ht.prototype.invert=function(t){return xi()};Ht.prototype.map=function(t){return xi()};Ht.prototype.merge=function(t){return null};Ht.prototype.toJSON=function(){return xi()};Ht.fromJSON=function(t,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");var r=La[n.stepType];if(!r)throw new RangeError("No step type "+n.stepType+" defined");return r.fromJSON(t,n)};Ht.jsonID=function(t,n){if(t in La)throw new RangeError("Duplicate use of step JSON ID "+t);return La[t]=n,n.prototype.jsonID=t,n};var Yt=function(t,n){this.doc=t,this.failed=n};Yt.ok=function(t){return new Yt(t,null)};Yt.fail=function(t){return new Yt(null,t)};Yt.fromReplace=function(t,n,r,o){try{return Yt.ok(t.replace(n,r,o))}catch(i){if(i instanceof Je)return Yt.fail(i.message);throw i}};var kn=function(e){function t(n,r,o,i){e.call(this),this.from=n,this.to=r,this.slice=o,this.structure=!!i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){return this.structure&&za(r,this.from,this.to)?Yt.fail("Structure replace would overwrite content"):Yt.fromReplace(r,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new It([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(r){return new t(this.from,this.from+this.slice.size,r.slice(this.from,this.to))},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1);return o.deleted&&i.deleted?null:new t(o.pos,Math.max(o.pos,i.pos),this.slice)},t.prototype.merge=function(r){if(!(r instanceof t)||r.structure||this.structure)return null;if(this.from+this.slice.size==r.from&&!this.slice.openEnd&&!r.slice.openStart){var o=this.slice.size+r.slice.size==0?I.empty:new I(this.slice.content.append(r.slice.content),this.slice.openStart,r.slice.openEnd);return new t(this.from,this.to+(r.to-r.from),o,this.structure)}else if(r.to==this.from&&!this.slice.openStart&&!r.slice.openEnd){var i=this.slice.size+r.slice.size==0?I.empty:new I(r.slice.content.append(this.slice.content),r.slice.openStart,this.slice.openEnd);return new t(r.from,this.to,i,this.structure)}else return null},t.prototype.toJSON=function(){var r={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(r.slice=this.slice.toJSON()),this.structure&&(r.structure=!0),r},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(o.from,o.to,I.fromJSON(r,o.slice),!!o.structure)},t}(Ht);Ht.jsonID("replace",kn);var Kn=function(e){function t(n,r,o,i,s,a,c){e.call(this),this.from=n,this.to=r,this.gapFrom=o,this.gapTo=i,this.slice=s,this.insert=a,this.structure=!!c}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){if(this.structure&&(za(r,this.from,this.gapFrom)||za(r,this.gapTo,this.to)))return Yt.fail("Structure gap-replace would overwrite content");var o=r.slice(this.gapFrom,this.gapTo);if(o.openStart||o.openEnd)return Yt.fail("Gap is not a flat range");var i=this.slice.insertAt(this.insert,o.content);return i?Yt.fromReplace(r,this.from,this.to,i):Yt.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new It([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(r){var o=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+o,this.from+this.insert,this.from+this.insert+o,r.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1),s=r.map(this.gapFrom,-1),a=r.map(this.gapTo,1);return o.deleted&&i.deleted||s<o.pos||a>i.pos?null:new t(o.pos,i.pos,s,a,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var r={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(r.slice=this.slice.toJSON()),this.structure&&(r.structure=!0),r},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number"||typeof o.gapFrom!="number"||typeof o.gapTo!="number"||typeof o.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(o.from,o.to,o.gapFrom,o.gapTo,I.fromJSON(r,o.slice),o.insert,!!o.structure)},t}(Ht);Ht.jsonID("replaceAround",Kn);function za(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}pt.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=T.empty,u=0,f=o,p=!1;f>t;f--)p||n.index(f)>0?(p=!0,l=T.from(n.node(f).copy(l)),u++):a--;for(var h=T.empty,d=0,v=o,g=!1;v>t;v--)g||r.after(v+1)<r.end(v)?(g=!0,h=T.from(r.node(v).copy(h)),d++):c++;return this.step(new Kn(a,c,i,s,new I(l.append(h),u,d),l.size-u,!0))};pt.prototype.wrap=function(e,t){for(var n=T.empty,r=t.length-1;r>=0;r--)n=T.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new Kn(o,i,o,i,new I(n,0,0),t.length,!0))};pt.prototype.setBlockType=function(e,t,n,r){var o=this;if(t===void 0&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,function(s,a){if(s.isTextblock&&!s.hasMarkup(n,r)&&x1(o.doc,o.mapping.slice(i).map(a),n)){o.clearIncompatible(o.mapping.slice(i).map(a,1),n);var c=o.mapping.slice(i),l=c.map(a,1),u=c.map(a+s.nodeSize,1);return o.step(new Kn(l,u,l+1,u-1,new I(T.from(n.create(r,null,s.marks)),0,0),1,!0)),!1}}),this};function x1(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}pt.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new Kn(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new I(T.from(i),0,0),1,!0))};pt.prototype.split=function(e,t,n){t===void 0&&(t=1);for(var r=this.doc.resolve(e),o=T.empty,i=T.empty,s=r.depth,a=r.depth-t,c=t-1;s>a;s--,c--){o=T.from(r.node(s).copy(o));var l=n&&n[c];i=T.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new kn(e,e,new I(o.append(i),t,t),!0))};pt.prototype.join=function(e,t){t===void 0&&(t=1);var n=new kn(e-t,e+t,I.empty,!0);return this.step(n)};function M1(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(r.parentOffset==0)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}function Fa(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(Fa(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return T.fromArray(r)}var $a=function(e){function t(n,r,o){e.call(this),this.from=n,this.to=r,this.mark=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){var o=this,i=r.slice(this.from,this.to),s=r.resolve(this.from),a=s.node(s.sharedDepth(this.to)),c=new I(Fa(i.content,function(l,u){return!l.isAtom||!u.type.allowsMarkType(o.mark.type)?l:l.mark(o.mark.addToSet(l.marks))},a),i.openStart,i.openEnd);return Yt.fromReplace(r,this.from,this.to,c)},t.prototype.invert=function(){return new co(this.from,this.to,this.mark)},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1);return o.deleted&&i.deleted||o.pos>=i.pos?null:new t(o.pos,i.pos,this.mark)},t.prototype.merge=function(r){if(r instanceof t&&r.mark.eq(this.mark)&&this.from<=r.to&&this.to>=r.from)return new t(Math.min(this.from,r.from),Math.max(this.to,r.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(o.from,o.to,r.markFromJSON(o.mark))},t}(Ht);Ht.jsonID("addMark",$a);var co=function(e){function t(n,r,o){e.call(this),this.from=n,this.to=r,this.mark=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(r){var o=this,i=r.slice(this.from,this.to),s=new I(Fa(i.content,function(a){return a.mark(o.mark.removeFromSet(a.marks))}),i.openStart,i.openEnd);return Yt.fromReplace(r,this.from,this.to,s)},t.prototype.invert=function(){return new $a(this.from,this.to,this.mark)},t.prototype.map=function(r){var o=r.mapResult(this.from,1),i=r.mapResult(this.to,-1);return o.deleted&&i.deleted||o.pos>=i.pos?null:new t(o.pos,i.pos,this.mark)},t.prototype.merge=function(r){if(r instanceof t&&r.mark.eq(this.mark)&&this.from<=r.to&&this.to>=r.from)return new t(Math.min(this.from,r.from),Math.max(this.to,r.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(r,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(o.from,o.to,r.markFromJSON(o.mark))},t}(Ht);Ht.jsonID("removeMark",co);pt.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(e,t,function(c,l,u){if(!!c.isInline){var f=c.marks;if(!n.isInSet(f)&&u.type.allowsMarkType(n.type)){for(var p=Math.max(l,e),h=Math.min(l+c.nodeSize,t),d=n.addToSet(f),v=0;v<f.length;v++)f[v].isInSet(d)||(s&&s.to==p&&s.mark.eq(f[v])?s.to=h:o.push(s=new co(p,h,f[v])));a&&a.to==p?a.to=h:i.push(a=new $a(p,h,n))}}}),o.forEach(function(c){return r.step(c)}),i.forEach(function(c){return r.step(c)}),this};pt.prototype.removeMark=function(e,t,n){var r=this;n===void 0&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,function(s,a){if(!!s.isInline){i++;var c=null;if(n instanceof qn)for(var l=s.marks,u;u=n.isInSet(l);)(c||(c=[])).push(u),l=u.removeFromSet(l);else n?n.isInSet(s.marks)&&(c=[n]):c=s.marks;if(c&&c.length)for(var f=Math.min(a+s.nodeSize,t),p=0;p<c.length;p++){for(var h=c[p],d=void 0,v=0;v<o.length;v++){var g=o[v];g.step==i-1&&h.eq(o[v].style)&&(d=g)}d?(d.to=f,d.step=i):o.push({style:h,from:Math.max(a,e),to:f,step:i})}}}),o.forEach(function(s){return r.step(new co(s.from,s.to,s.style))}),this};pt.prototype.clearIncompatible=function(e,t,n){n===void 0&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(!l)o.push(new kn(i,c,I.empty));else{n=l;for(var u=0;u<a.marks.length;u++)t.allowsMarkType(a.marks[u].type)||this.step(new co(i,c,a.marks[u]))}i=c}if(!n.validEnd){var f=n.fillBefore(T.empty,!0);this.replace(i,i,new I(f,0,0))}for(var p=o.length-1;p>=0;p--)this.step(o[p]);return this};function C1(e,t,n,r){if(n===void 0&&(n=t),r===void 0&&(r=I.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return Cp(o,i,r)?new kn(t,n,r):new ke(o,i,r).fit()}pt.prototype.replace=function(e,t,n){t===void 0&&(t=e),n===void 0&&(n=I.empty);var r=C1(this.doc,e,t,n);return r&&this.step(r),this};pt.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new I(T.from(n),0,0))};pt.prototype.delete=function(e,t){return this.replace(e,t,I.empty)};pt.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};function Cp(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}var ke=function(t,n,r){this.$to=n,this.$from=t,this.unplaced=r,this.frontier=[];for(var o=0;o<=t.depth;o++){var i=t.node(o);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(o))})}this.placed=T.empty;for(var s=t.depth;s>0;s--)this.placed=T.from(t.node(s).copy(this.placed))},Tp={depth:{configurable:!0}};Tp.depth.get=function(){return this.frontier.length-1};ke.prototype.fit=function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var n=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,o=this.$from,i=this.close(n<0?this.$to:o.doc.resolve(n));if(!i)return null;for(var s=this.placed,a=o.depth,c=i.depth;a&&c&&s.childCount==1;)s=s.firstChild.content,a--,c--;var l=new I(s,a,c);if(n>-1)return new Kn(o.pos,n,this.$to.pos,this.$to.end(),l,r);if(l.size||o.pos!=this.$to.pos)return new kn(o.pos,i.pos,l)};ke.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var n=this.unplaced.openStart;n>=0;n--){var r=void 0,o=void 0;n?(o=Va(this.unplaced.content,n-1).firstChild,r=o.content):r=this.unplaced.content;for(var i=r.firstChild,s=this.depth;s>=0;s--){var a=this.frontier[s],c=a.type,l=a.match,u=void 0,f=void 0;if(t==1&&(i?l.matchType(i.type)||(f=l.fillBefore(T.from(i),!1)):c.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:s,parent:o,inject:f};if(t==2&&i&&(u=l.findWrapping(i.type)))return{sliceDepth:n,frontierDepth:s,parent:o,wrap:u};if(o&&l.matchType(o.type))break}}};ke.prototype.openMore=function(){var t=this.unplaced,n=t.content,r=t.openStart,o=t.openEnd,i=Va(n,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new I(n,r+1,Math.max(o,i.size+r>=n.size-o?r+1:0)),!0)};ke.prototype.dropNode=function(){var t=this.unplaced,n=t.content,r=t.openStart,o=t.openEnd,i=Va(n,r);if(i.childCount<=1&&r>0){var s=n.size-r<=r+i.size;this.unplaced=new I(lo(n,r-1,1),r-1,s?r-1:o)}else this.unplaced=new I(lo(n,r,1),r,o)};ke.prototype.placeNodes=function(t){for(var n=t.sliceDepth,r=t.frontierDepth,o=t.parent,i=t.inject,s=t.wrap;this.depth>r;)this.closeFrontierNode();if(s)for(var a=0;a<s.length;a++)this.openFrontierNode(s[a]);var c=this.unplaced,l=o?o.content:c.content,u=c.openStart-n,f=0,p=[],h=this.frontier[r],d=h.match,v=h.type;if(i){for(var g=0;g<i.childCount;g++)p.push(i.child(g));d=d.matchFragment(i)}for(var b=l.size+n-(c.content.size-c.openEnd);f<l.childCount;){var y=l.child(f),M=d.matchType(y.type);if(!M)break;f++,(f>1||u==0||y.content.size)&&(d=M,p.push(_p(y.mark(v.allowedMarks(y.marks)),f==1?u:0,f==l.childCount?b:-1)))}var m=f==l.childCount;m||(b=-1),this.placed=uo(this.placed,r,T.from(p)),this.frontier[r].match=d,m&&b<0&&o&&o.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var C=0,O=l;C<b;C++){var E=O.lastChild;this.frontier.push({type:E.type,match:E.contentMatchAt(E.childCount)}),O=E.content}this.unplaced=m?n==0?I.empty:new I(lo(c.content,n-1,1),n-1,b<0?c.openEnd:n-1):new I(lo(c.content,n,f),c.openStart,c.openEnd)};ke.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var t=this.frontier[this.depth],n;if(!t.type.isTextblock||!Ha(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;for(var r=this.$to,o=r.depth,i=this.$to.after(o);o>1&&i==this.$to.end(--o);)++i;return i};ke.prototype.findCloseLevel=function(t){t:for(var n=Math.min(this.depth,t.depth);n>=0;n--){var r=this.frontier[n],o=r.match,i=r.type,s=n<t.depth&&t.end(n+1)==t.pos+(t.depth-(n+1)),a=Ha(t,n,i,o,s);if(!!a){for(var c=n-1;c>=0;c--){var l=this.frontier[c],u=l.match,f=l.type,p=Ha(t,c,f,u,!0);if(!p||p.childCount)continue t}return{depth:n,fit:a,move:s?t.doc.resolve(t.after(n+1)):t}}}};ke.prototype.close=function(t){var n=this.findCloseLevel(t);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=uo(this.placed,n.depth,n.fit)),t=n.move;for(var r=n.depth+1;r<=t.depth;r++){var o=t.node(r),i=o.type.contentMatch.fillBefore(o.content,!0,t.index(r));this.openFrontierNode(o.type,o.attrs,i)}return t};ke.prototype.openFrontierNode=function(t,n,r){var o=this.frontier[this.depth];o.match=o.match.matchType(t),this.placed=uo(this.placed,this.depth,T.from(t.create(n,r))),this.frontier.push({type:t,match:t.contentMatch})};ke.prototype.closeFrontierNode=function(){var t=this.frontier.pop(),n=t.match.fillBefore(T.empty,!0);n.childCount&&(this.placed=uo(this.placed,this.frontier.length,n))};Object.defineProperties(ke.prototype,Tp);function lo(e,t,n){return t==0?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(lo(e.firstChild.content,t-1,n)))}function uo(e,t,n){return t==0?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(uo(e.lastChild.content,t-1,n)))}function Va(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function _p(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,_p(r.firstChild,t-1,r.childCount==1?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(T.empty,!0)))),e.copy(r)}function Ha(e,t,n,r,o){var i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!T1(n,i.content,s)?a:null}function T1(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}pt.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(Cp(r,o,n))return this.step(new kn(e,t,n));var i=Ap(r,this.doc.resolve(t));i[i.length-1]==0&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),f=[],p=n.openStart,h=n.content,d=0;;d++){var v=h.firstChild;if(f.push(v),d==n.openStart)break;h=v.content}p>0&&f[p-1].type.spec.defining&&r.node(u).type!=f[p-1].type?p-=1:p>=2&&f[p-1].isTextblock&&f[p-2].type.spec.defining&&r.node(u).type!=f[p-2].type&&(p-=2);for(var g=n.openStart;g>=0;g--){var b=(g+p+1)%(n.openStart+1),y=f[b];if(!!y)for(var M=0;M<i.length;M++){var m=i[(M+u)%i.length],C=!0;m<0&&(C=!1,m=-m);var O=r.node(m-1),E=r.index(m-1);if(O.canReplaceWith(E,E,y.type,y.marks))return this.replace(r.before(m),C?o.after(m):t,new I(Ep(n.content,0,n.openStart,b),b,n.openEnd))}}for(var P=this.steps.length,D=i.length-1;D>=0&&(this.replace(e,t,n),!(this.steps.length>P));D--){var F=i[D];F<0||(e=r.before(F),t=o.after(F))}return this};function Ep(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(Ep(i.content,t+1,n,r,i)))}if(t>r){var s=o.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(T.empty,!0))}return e}pt.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=M1(this.doc,e,n.type);r!=null&&(e=t=r)}return this.replaceRange(e,t,new I(T.from(n),0,0))};pt.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=Ap(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&s==0||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(e-n.start(c)==n.depth-c&&t>n.end(c)&&r.end(c)-t!=r.depth-c)return this.delete(n.before(c),t);return this.delete(e,t)};function Ap(e,t){for(var n=[],r=Math.min(e.depth,t.depth),o=r;o>=0;o--){var i=e.start(o);if(i<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(i==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==i-1)&&n.push(o)}return n}var ja=Object.create(null),ut=function(t,n,r){this.ranges=r||[new _1(t.min(n),t.max(n))],this.$anchor=t,this.$head=n},Sn={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Sn.anchor.get=function(){return this.$anchor.pos};Sn.head.get=function(){return this.$head.pos};Sn.from.get=function(){return this.$from.pos};Sn.to.get=function(){return this.$to.pos};Sn.$from.get=function(){return this.ranges[0].$from};Sn.$to.get=function(){return this.ranges[0].$to};Sn.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0};ut.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)};ut.prototype.replace=function(t,n){n===void 0&&(n=I.empty);for(var r=n.content.lastChild,o=null,i=0;i<n.openEnd;i++)o=r,r=r.lastChild;for(var s=t.steps.length,a=this.ranges,c=0;c<a.length;c++){var l=a[c],u=l.$from,f=l.$to,p=t.mapping.slice(s);t.replaceRange(p.map(u.pos),p.map(f.pos),c?I.empty:n),c==0&&Np(t,s,(r?r.isInline:o&&o.isTextblock)?-1:1)}};ut.prototype.replaceWith=function(t,n){for(var r=t.steps.length,o=this.ranges,i=0;i<o.length;i++){var s=o[i],a=s.$from,c=s.$to,l=t.mapping.slice(r),u=l.map(a.pos),f=l.map(c.pos);i?t.deleteRange(u,f):(t.replaceRangeWith(u,f,n),Np(t,r,n.isInline?-1:1))}};ut.findFrom=function(t,n,r){var o=t.parent.inlineContent?new fo(t):br(t.node(0),t.parent,t.pos,t.index(),n,r);if(o)return o;for(var i=t.depth-1;i>=0;i--){var s=n<0?br(t.node(0),t.node(i),t.before(i+1),t.index(i),n,r):br(t.node(0),t.node(i),t.after(i+1),t.index(i)+1,n,r);if(s)return s}};ut.near=function(t,n){return n===void 0&&(n=1),this.findFrom(t,n)||this.findFrom(t,-n)||new ho(t.node(0))};ut.atStart=function(t){return br(t,t,0,0,1)||new ho(t)};ut.atEnd=function(t){return br(t,t,t.content.size,t.childCount,-1)||new ho(t)};ut.fromJSON=function(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");var r=ja[n.type];if(!r)throw new RangeError("No selection type "+n.type+" defined");return r.fromJSON(t,n)};ut.jsonID=function(t,n){if(t in ja)throw new RangeError("Duplicate use of selection JSON ID "+t);return ja[t]=n,n.prototype.jsonID=t,n};ut.prototype.getBookmark=function(){return fo.between(this.$anchor,this.$head).getBookmark()};Object.defineProperties(ut.prototype,Sn);ut.prototype.visible=!0;var _1=function(t,n){this.$from=t,this.$to=n},fo=function(e){function t(r,o){o===void 0&&(o=r),e.call(this,r,o)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(o,i){var s=o.resolve(i.map(this.head));if(!s.parent.inlineContent)return e.near(s);var a=o.resolve(i.map(this.anchor));return new t(a.parent.inlineContent?a:s,s)},t.prototype.replace=function(o,i){if(i===void 0&&(i=I.empty),e.prototype.replace.call(this,o,i),i==I.empty){var s=this.$from.marksAcross(this.$to);s&&o.ensureMarks(s)}},t.prototype.eq=function(o){return o instanceof t&&o.anchor==this.anchor&&o.head==this.head},t.prototype.getBookmark=function(){return new po(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(o,i){if(typeof i.anchor!="number"||typeof i.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(o.resolve(i.anchor),o.resolve(i.head))},t.create=function(o,i,s){s===void 0&&(s=i);var a=o.resolve(i);return new this(a,s==i?a:o.resolve(s))},t.between=function(o,i,s){var a=o.pos-i.pos;if((!s||a)&&(s=a>=0?1:-1),!i.parent.inlineContent){var c=e.findFrom(i,s,!0)||e.findFrom(i,-s,!0);if(c)i=c.$head;else return e.near(i,s)}return o.parent.inlineContent||(a==0?o=i:(o=(e.findFrom(o,-s,!0)||e.findFrom(o,s,!0)).$anchor,o.pos<i.pos!=a<0&&(o=i))),new t(o,i)},Object.defineProperties(t.prototype,n),t}(ut);ut.jsonID("text",fo);var po=function(t,n){this.anchor=t,this.head=n};po.prototype.map=function(t){return new po(t.map(this.anchor),t.map(this.head))};po.prototype.resolve=function(t){return fo.between(t.resolve(this.anchor),t.resolve(this.head))};var yr=function(e){function t(n){var r=n.nodeAfter,o=n.node(0).resolve(n.pos+r.nodeSize);e.call(this,n,o),this.node=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(r,o){var i=o.mapResult(this.anchor),s=i.deleted,a=i.pos,c=r.resolve(a);return s?e.near(c):new t(c)},t.prototype.content=function(){return new I(T.from(this.node),0,0)},t.prototype.eq=function(r){return r instanceof t&&r.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new Mi(this.anchor)},t.fromJSON=function(r,o){if(typeof o.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(r.resolve(o.anchor))},t.create=function(r,o){return new this(r.resolve(o))},t.isSelectable=function(r){return!r.isText&&r.type.spec.selectable!==!1},t}(ut);yr.prototype.visible=!1;ut.jsonID("node",yr);var Mi=function(t){this.anchor=t};Mi.prototype.map=function(t){var n=t.mapResult(this.anchor),r=n.deleted,o=n.pos;return r?new po(o,o):new Mi(o)};Mi.prototype.resolve=function(t){var n=t.resolve(this.anchor),r=n.nodeAfter;return r&&yr.isSelectable(r)?new yr(n):ut.near(n)};var ho=function(e){function t(n){e.call(this,n.resolve(0),n.resolve(n.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(r,o){if(o===void 0&&(o=I.empty),o==I.empty){r.delete(0,r.doc.content.size);var i=e.atStart(r.doc);i.eq(r.selection)||r.setSelection(i)}else e.prototype.replace.call(this,r,o)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(r){return new t(r)},t.prototype.map=function(r){return new t(r)},t.prototype.eq=function(r){return r instanceof t},t.prototype.getBookmark=function(){return E1},t}(ut);ut.jsonID("all",ho);var E1={map:function(){return this},resolve:function(t){return new ho(t)}};function br(e,t,n,r,o,i){if(t.inlineContent)return fo.create(e,n);for(var s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){var a=t.child(s);if(a.isAtom){if(!i&&yr.isSelectable(a))return yr.create(e,n-(o<0?a.nodeSize:0))}else{var c=br(e,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function Np(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o=e.steps[r];if(o instanceof kn||o instanceof Kn){var i=e.mapping.maps[r],s;i.forEach(function(a,c,l,u){s==null&&(s=u)}),e.setSelection(ut.near(e.doc.resolve(s),n))}}}var Ip=1,Ci=2,Pp=4,A1=function(e){function t(r){e.call(this,r.doc),this.time=Date.now(),this.curSelection=r.selection,this.curSelectionFor=0,this.storedMarks=r.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(o){if(o.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=o,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Ip)&~Ci,this.storedMarks=null,this},n.selectionSet.get=function(){return(this.updated&Ip)>0},t.prototype.setStoredMarks=function(o){return this.storedMarks=o,this.updated|=Ci,this},t.prototype.ensureMarks=function(o){return U.sameSet(this.storedMarks||this.selection.$from.marks(),o)||this.setStoredMarks(o),this},t.prototype.addStoredMark=function(o){return this.ensureMarks(o.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(o){return this.ensureMarks(o.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(this.updated&Ci)>0},t.prototype.addStep=function(o,i){e.prototype.addStep.call(this,o,i),this.updated=this.updated&~Ci,this.storedMarks=null},t.prototype.setTime=function(o){return this.time=o,this},t.prototype.replaceSelection=function(o){return this.selection.replace(this,o),this},t.prototype.replaceSelectionWith=function(o,i){var s=this.selection;return i!==!1&&(o=o.mark(this.storedMarks||(s.empty?s.$from.marks():s.$from.marksAcross(s.$to)||U.none))),s.replaceWith(this,o),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(o,i,s){s===void 0&&(s=i);var a=this.doc.type.schema;if(i==null)return o?this.replaceSelectionWith(a.text(o),!0):this.deleteSelection();if(!o)return this.deleteRange(i,s);var c=this.storedMarks;if(!c){var l=this.doc.resolve(i);c=s==i?l.marks():l.marksAcross(this.doc.resolve(s))}return this.replaceRangeWith(i,s,a.text(o,c)),this.selection.empty||this.setSelection(ut.near(this.selection.$to)),this},t.prototype.setMeta=function(o,i){return this.meta[typeof o=="string"?o:o.key]=i,this},t.prototype.getMeta=function(o){return this.meta[typeof o=="string"?o:o.key]},n.isGeneric.get=function(){for(var r in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=Pp,this},n.scrolledIntoView.get=function(){return(this.updated&Pp)>0},Object.defineProperties(t.prototype,n),t}(pt);function Dp(e,t){return!t||!e?e:e.bind(t)}var vo=function(t,n,r){this.name=t,this.init=Dp(n.init,r),this.apply=Dp(n.apply,r)},N1=[new vo("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new vo("selection",{init:function(t,n){return t.selection||ut.atStart(n.doc)},apply:function(t){return t.selection}}),new vo("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,n,r,o){return o.selection.$cursor?t.storedMarks:null}}),new vo("scrollToSelection",{init:function(){return 0},apply:function(t,n){return t.scrolledIntoView?n+1:n}})],Ja=function(t,n){var r=this;this.schema=t,this.fields=N1.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),n&&n.forEach(function(o){if(r.pluginsByKey[o.key])throw new RangeError("Adding different instances of a keyed plugin ("+o.key+")");r.plugins.push(o),r.pluginsByKey[o.key]=o,o.spec.state&&r.fields.push(new vo(o.key,o.spec.state,o))})},Xt=function(t){this.config=t},Ti={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Ti.schema.get=function(){return this.config.schema};Ti.plugins.get=function(){return this.config.plugins};Xt.prototype.apply=function(t){return this.applyTransaction(t).state};Xt.prototype.filterTransaction=function(t,n){n===void 0&&(n=-1);for(var r=0;r<this.config.plugins.length;r++)if(r!=n){var o=this.config.plugins[r];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,t,this))return!1}return!0};Xt.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var n=[t],r=this.applyInner(t),o=null;;){for(var i=!1,s=0;s<this.config.plugins.length;s++){var a=this.config.plugins[s];if(a.spec.appendTransaction){var c=o?o[s].n:0,l=o?o[s].state:this,u=c<n.length&&a.spec.appendTransaction.call(a,c?n.slice(c):n,l,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",t),!o){o=[];for(var f=0;f<this.config.plugins.length;f++)o.push(f<s?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),i=!0}o&&(o[s]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}};Xt.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new Xt(this.config),r=this.config.fields,o=0;o<r.length;o++){var i=r[o];n[i.name]=i.apply(t,this[i.name],this,n)}for(var s=0;s<mo.length;s++)mo[s](this,t,n);return n};Ti.tr.get=function(){return new A1(this)};Xt.create=function(t){for(var n=new Ja(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new Xt(n),o=0;o<n.fields.length;o++)r[n.fields[o].name]=n.fields[o].init(t,r);return r};Xt.prototype.reconfigure=function(t){for(var n=new Ja(this.schema,t.plugins),r=n.fields,o=new Xt(n),i=0;i<r.length;i++){var s=r[i].name;o[s]=this.hasOwnProperty(s)?this[s]:r[i].init(t,o)}return o};Xt.prototype.toJSON=function(t){var n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(function(s){return s.toJSON()})),t&&typeof t=="object")for(var r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");var o=t[r],i=o.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(o,this[o.key]))}return n};Xt.fromJSON=function(t,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var o=new Ja(t.schema,t.plugins),i=new Xt(o);return o.fields.forEach(function(s){if(s.name=="doc")i.doc=G.fromJSON(t.schema,n.doc);else if(s.name=="selection")i.selection=ut.fromJSON(i.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(r)for(var a in r){var c=r[a],l=c.spec.state;if(c.key==s.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){i[s.name]=l.fromJSON.call(c,t,n[a],i);return}}i[s.name]=s.init(t,i)}}),i};Xt.addApplyListener=function(t){mo.push(t)};Xt.removeApplyListener=function(t){var n=mo.indexOf(t);n>-1&&mo.splice(n,1)};Object.defineProperties(Xt.prototype,Ti);var mo=[];function Rp(e,t,n){for(var r in e){var o=e[r];o instanceof Function?o=o.bind(t):r=="handleDOMEvents"&&(o=Rp(o,t,{})),n[r]=o}return n}var Bp=function(t){this.props={},t.props&&Rp(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Lp("plugin")};Bp.prototype.getState=function(t){return t[this.key]};var Wa=Object.create(null);function Lp(e){return e in Wa?e+"$"+ ++Wa[e]:(Wa[e]=0,e+"$")}var qa=function(t){t===void 0&&(t="key"),this.key=Lp(t)};qa.prototype.get=function(t){return t.config.pluginsByKey[this.key]};qa.prototype.getState=function(t){return t[this.key]};const I1=new qa("characterLimit");kt.create({name:"characterCount",addOptions(){return{limit:0}},addProseMirrorPlugins(){const{options:e}=this;return[new Bp({key:I1,appendTransaction:(t,n,r)=>{const o=r.doc.content.size;if(e.limit&&o>e.limit)return r.tr.insertText("",e.limit+1,o)}})]}});const P1={props:{icon:{type:String,required:!0},title:{type:String,required:!0},action:{type:Function,required:!0},isActive:{type:Function,default:null}},components:{SvgIcon:An}},D1=["title"];function R1(e,t,n,r,o,i){const s=xe("SvgIcon");return q(),lt("button",{class:Ot(["menu-item",{"is-active":n.isActive?n.isActive():null}]),onClick:t[0]||(t[0]=(...a)=>n.action&&n.action(...a)),title:n.title},[rt(s,{name:"tiptap-"+n.icon},null,8,["name"])],10,D1)}var B1=Tr(P1,[["render",R1],["__scopeId","data-v-d2d2a634"]]);const L1={components:{MenuItem:B1},props:{editor:{type:Object,required:!0}},data(){return{items:[{icon:"bold",title:"Bold",action:()=>this.editor.chain().focus().toggleBold().run(),isActive:()=>this.editor.isActive("bold")},{icon:"italic",title:"Italic",action:()=>this.editor.chain().focus().toggleItalic().run(),isActive:()=>this.editor.isActive("italic")},{icon:"strikethrough",title:"Strike",action:()=>this.editor.chain().focus().toggleStrike().run(),isActive:()=>this.editor.isActive("strike")},{icon:"code-view",title:"Code",action:()=>this.editor.chain().focus().toggleCode().run(),isActive:()=>this.editor.isActive("code")},{icon:"mark-pen-line",title:"Highlight",action:()=>this.editor.chain().focus().toggleHighlight().run(),isActive:()=>this.editor.isActive("highlight")},{type:"divider"},{icon:"h-1",title:"Heading 1",action:()=>this.editor.chain().focus().toggleHeading({level:1}).run(),isActive:()=>this.editor.isActive("heading",{level:1})},{icon:"h-2",title:"Heading 2",action:()=>this.editor.chain().focus().toggleHeading({level:2}).run(),isActive:()=>this.editor.isActive("heading",{level:2})},{icon:"paragraph",title:"Paragraph",action:()=>this.editor.chain().focus().setParagraph().run(),isActive:()=>this.editor.isActive("paragraph")},{icon:"list-unordered",title:"Bullet List",action:()=>this.editor.chain().focus().toggleBulletList().run(),isActive:()=>this.editor.isActive("bulletList")},{icon:"list-ordered",title:"Ordered List",action:()=>this.editor.chain().focus().toggleOrderedList().run(),isActive:()=>this.editor.isActive("orderedList")},{icon:"list-check-2",title:"Task List",action:()=>this.editor.chain().focus().toggleTaskList().run(),isActive:()=>this.editor.isActive("taskList")},{icon:"code-box-line",title:"Code Block",action:()=>this.editor.chain().focus().toggleCodeBlock().run(),isActive:()=>this.editor.isActive("codeBlock")},{type:"divider"},{icon:"double-quotes-l",title:"Blockquote",action:()=>this.editor.chain().focus().toggleBlockquote().run(),isActive:()=>this.editor.isActive("blockquote")},{icon:"separator",title:"Horizontal Rule",action:()=>this.editor.chain().focus().setHorizontalRule().run()},{type:"divider"},{icon:"text-wrap",title:"Hard Break",action:()=>this.editor.chain().focus().setHardBreak().run()},{icon:"format-clear",title:"Clear Format",action:()=>this.editor.chain().focus().clearNodes().unsetAllMarks().run()},{type:"divider"},{icon:"arrow-go-back-line",title:"Undo",action:()=>this.editor.chain().focus().undo().run()},{icon:"arrow-go-forward-line",title:"Redo",action:()=>this.editor.chain().focus().redo().run()}]}}};function z1(e,t,n,r,o,i){const s=xe("menu-item");return q(),lt("div",null,[(q(!0),lt(Ke,null,Bi(o.items,(a,c)=>(q(),lt(Ke,null,[a.type==="divider"?(q(),lt("div",{class:"divider",key:`divider${c}`})):(q(),Re(s,vc({key:1,key:c},a),null,16))],64))),256))])}var F1=Tr(L1,[["render",z1],["__scopeId","data-v-1ebce63e"]]);const Ka=e=>e[Math.floor(Math.random()*e.length)],$1=()=>Ka(["rooms.10","rooms.11","rooms.12"]),V1={components:{EditorContent:Db,MenuBar:F1},data(){return{currentUser:JSON.parse(localStorage.getItem("currentUser"))||{name:this.getRandomName(),color:this.getRandomColor()},provider:null,editor:null,users:[],status:"connecting",room:$1()}},mounted(){this.editor=new Pb({extensions:[Nw.configure({history:!1}),r1,Zw,t1]}),localStorage.setItem("currentUser",JSON.stringify(this.currentUser))},methods:{setName(){const e=(window.prompt("Name")||"").trim().substring(0,32);if(e)return this.updateCurrentUser({name:e})},updateCurrentUser(e){this.currentUser=S(S({},this.currentUser),e),this.editor.chain().focus().user(this.currentUser).run(),localStorage.setItem("currentUser",JSON.stringify(this.currentUser))},getRandomColor(){return Ka(["#958DF1","#F98181","#FBBC88","#FAF594","#70CFF8","#94FADB","#B9F18D"])},getRandomName(){return Ka(["Lea Thompson","Cyndi Lauper","Tom Cruise","Madonna","Jerry Hall","Joan Collins","Winona Ryder","Christina Applegate","Alyssa Milano","Molly Ringwald","Ally Sheedy","Debbie Harry","Olivia Newton-John","Elton John","Michael J. Fox","Axl Rose","Emilio Estevez","Ralph Macchio","Rob Lowe","Jennifer Grey","Mickey Rourke","John Cusack","Matthew Broderick","Justine Bateman","Lisa Bonet"])}},beforeUnmount(){this.editor.destroy(),this.provider.destroy()}},H1={key:0,class:"editor"},j1={class:"editor__footer"},J1=Co(" offline "),W1={class:"editor__name"};function q1(e,t,n,r,o,i){const s=xe("menu-bar"),a=xe("editor-content");return o.editor?(q(),lt("div",H1,[rt(s,{class:"editor__header",editor:o.editor},null,8,["editor"]),rt(a,{class:"editor__content",editor:o.editor},null,8,["editor"]),V("div",j1,[V("div",{class:Ot(`editor__status editor__status--${o.status}`)},[o.status==="connected"?(q(),lt(Ke,{key:0},[Co(nn(o.users.length)+" user"+nn(o.users.length===1?"":"s")+" online in "+nn(o.room),1)],64)):(q(),lt(Ke,{key:1},[J1],64))],2),V("div",W1,[V("button",{onClick:t[0]||(t[0]=(...c)=>i.setName&&i.setName(...c))},nn(o.currentUser.name),1)])])])):Xn("",!0)}var K1=Tr(V1,[["render",q1],["__scopeId","data-v-4ad0eb1a"]]);const U1={setup(e){const t=En([{name:"\u97F3\u9891",value:0},{name:"\u89C6\u9891",value:1}]),n=Rt(0),r=o=>{n.value=o};return(o,i)=>(q(),Re(De(Rh),{onChange:r},{default:rn(()=>[rt(De(Dh),{class:"flex p-1 space-x-1 bg-indigo-500 rounded-lg dark border dark:border-gray-600 transition"},{default:rn(()=>[(q(!0),lt(Ke,null,Bi(De(t),s=>(q(),Re(De(Ph),{as:"template",key:s.value},{default:rn(({selected:a})=>[V("button",{class:Ot(["w-full py-1 text-sm leading-5 font-mediumtext-white text-white font-bold rounded-md","focus:outline-none focus:ring-2 ring-offset-2 ring-offset-indigo-300",a?"bg-white shadow text-indigo-700":"hover:bg-white/[0.12]"])},nn(s.name),3)]),_:2},1024))),128))]),_:1})]),_:1}))}},zp=Object.prototype.toString;function G1(e){return zp.call(e)==="[object Array]"}function Fp(e){return zp.call(e)==="[object String]"}function Y1(e){return e===void 0}function Ua(e){return typeof e=="function"}const X1=Symbol("ArcoConfigProvider");var Z1=Object.defineProperty,Q1=Object.defineProperties,tk=Object.getOwnPropertyDescriptors,$p=Object.getOwnPropertySymbols,ek=Object.prototype.hasOwnProperty,nk=Object.prototype.propertyIsEnumerable,Vp=(e,t,n)=>t in e?Z1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rk=(e,t)=>{for(var n in t||(t={}))ek.call(t,n)&&Vp(e,n,t[n]);if($p)for(var n of $p(t))nk.call(t,n)&&Vp(e,n,t[n]);return e},ok=(e,t)=>Q1(e,tk(t));const ik="A",sk="arco",Ga="$arco",Hp=e=>{var t;return(t=e==null?void 0:e.componentPrefix)!=null?t:ik},jp=(e,t)=>{var n;t&&t.classPrefix&&(e.config.globalProperties[Ga]=ok(rk({},(n=e.config.globalProperties[Ga])!=null?n:{}),{classPrefix:t.classPrefix}))},We=e=>{var t,n,r;const o=Mo(),i=Li(X1,void 0),s=(r=(n=i==null?void 0:i.prefixCls)!=null?n:(t=o==null?void 0:o.appContext.config.globalProperties[Ga])==null?void 0:t.classPrefix)!=null?r:sk;return e?`${s}-${e}`:s},Jp=["info","success","warning","error"],ak=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"],Wp=["hover","click","focus","contextMenu"];var On=(e,t)=>{for(const[n,r]of t)e[n]=r;return e};const ck=Dt({name:"IconHover",props:{prefix:{type:String},size:{type:String,default:"medium"},disabled:{type:Boolean,default:!1}},setup(){return{prefixCls:We("icon-hover")}}});function lk(e,t,n,r,o,i){return q(),lt("span",{class:Ot([e.prefixCls,{[`${e.prefix}-icon-hover`]:e.prefix,[`${e.prefixCls}-size-${e.size}`]:e.size!=="default",[`${e.prefixCls}-disabled`]:e.disabled}])},[Zn(e.$slots,"default")],2)}var uk=On(ck,[["render",lk]]);const fk=Dt({name:"IconClose",props:{strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},spin:Boolean},setup(e){const t=We("icon");return{cls:te(()=>[t,`${t}-close`,{[`${t}-spin`]:e.spin}])}}}),pk=["stroke-width","stroke-linecap","stroke-linejoin"],hk=V("path",{d:"M9.857 9.858 24 24m0 0 14.142 14.142M24 24 38.142 9.858M24 24 9.857 38.142"},null,-1),dk=[hk];function vk(e,t,n,r,o,i){return q(),lt("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:Ot(e.cls),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},dk,10,pk)}var Ya=On(fk,[["render",vk]]);const mk=Object.assign(Ya,{install:(e,t)=>{var n;const r=(n=t==null?void 0:t.iconPrefix)!=null?n:"";e.component(r+Ya.name,Ya)}});var gk=Object.defineProperty,qp=Object.getOwnPropertySymbols,yk=Object.prototype.hasOwnProperty,bk=Object.prototype.propertyIsEnumerable,Kp=(e,t,n)=>t in e?gk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,he=(e,t)=>{for(var n in t||(t={}))yk.call(t,n)&&Kp(e,n,t[n]);if(qp)for(var n of qp(t))bk.call(t,n)&&Kp(e,n,t[n]);return e};const wk=()=>({width:document.documentElement.clientWidth||window.innerWidth,height:document.documentElement.clientHeight||window.innerHeight}),Up=(e,t)=>{const n=e.getBoundingClientRect();return{top:n.top,bottom:n.bottom,left:n.left,right:n.right,scrollTop:n.top-t.top,scrollBottom:n.bottom-t.top,scrollLeft:n.left-t.left,scrollRight:n.right-t.left,width:e.offsetWidth,height:e.offsetHeight}},kk=e=>{switch(e){case"top":case"tl":case"tr":return"top";case"bottom":case"bl":case"br":return"bottom";case"left":case"lt":case"lb":return"left";case"right":case"rt":case"rb":return"right";default:return"top"}},_i=(e,t)=>{switch(t){case"top":switch(e){case"bottom":return"top";case"bl":return"tl";case"br":return"tr";default:return e}case"bottom":switch(e){case"top":return"bottom";case"tl":return"bl";case"tr":return"br";default:return e}case"left":switch(e){case"right":return"left";case"rt":return"lt";case"rb":return"lb";default:return e}case"right":switch(e){case"left":return"right";case"lt":return"rt";case"lb":return"rb";default:return e}default:return e}},Sk=(e,t,{containerRect:n,triggerRect:r,popupRect:o,offset:i,translate:s})=>{const a=kk(e),c=wk(),l={top:n.top+t.top,bottom:c.height-(n.top+t.top+o.height),left:n.left+t.left,right:c.width-(n.left+t.left+o.width)};let u=e;if(a==="top"&&l.top<0)if(r.top>o.height)t.top=-n.top;else{const f=go("bottom",r,o,{offset:i,translate:s});c.height-(n.top+f.top+o.height)>0&&(u=_i(e,"bottom"),t.top=f.top)}if(a==="bottom"&&l.bottom<0)if(c.height-r.bottom>o.height)t.top=-n.top+(c.height-o.height);else{const f=go("top",r,o,{offset:i,translate:s});n.top+f.top>0&&(u=_i(e,"top"),t.top=f.top)}if(a==="left"&&l.left<0)if(r.left>o.width)t.left=-n.left;else{const f=go("right",r,o,{offset:i,translate:s});c.width-(n.left+f.left+o.width)>0&&(u=_i(e,"right"),t.left=f.left)}if(a==="right"&&l.right<0)if(c.width-r.right>o.width)t.left=-n.left+(c.width-o.width);else{const f=go("left",r,o,{offset:i,translate:s});n.left+f.left>0&&(u=_i(e,"left"),t.left=f.left)}return(a==="top"||a==="bottom")&&(l.left<0?t.left=-n.left:l.right<0&&(t.left=-n.left+(c.width-o.width))),(a==="left"||a==="right")&&(l.top<0?t.top=-n.top:l.bottom<0&&(t.top=-n.top+(c.height-o.height))),{popupPosition:t,position:u}},go=(e,t,n,{offset:r=0,translate:o=[0,0]}={})=>{var i;const s=(i=G1(o)?o:o[e])!=null?i:[0,0];switch(e){case"top":return{left:t.scrollLeft+Math.round(t.width/2)-Math.round(n.width/2)+s[0],top:t.scrollTop-n.height-r+s[1]};case"tl":return{left:t.scrollLeft+s[0],top:t.scrollTop-n.height-r+s[1]};case"tr":return{left:t.scrollRight-n.width+s[0],top:t.scrollTop-n.height-r+s[1]};case"bottom":return{left:t.scrollLeft+Math.round(t.width/2)-Math.round(n.width/2)+s[0],top:t.scrollBottom+r+s[1]};case"bl":return{left:t.scrollLeft+s[0],top:t.scrollBottom+r+s[1]};case"br":return{left:t.scrollRight-n.width+s[0],top:t.scrollBottom+r+s[1]};case"left":return{left:t.scrollLeft-n.width-r+s[0],top:t.scrollTop+Math.round(t.height/2)-Math.round(n.height/2)+s[1]};case"lt":return{left:t.scrollLeft-n.width-r+s[0],top:t.scrollTop+s[1]};case"lb":return{left:t.scrollLeft-n.width-r+s[0],top:t.scrollBottom-n.height+s[1]};case"right":return{left:t.scrollRight+r+s[0],top:t.scrollTop+Math.round(t.height/2)-Math.round(n.height/2)+s[1]};case"rt":return{left:t.scrollRight+r+s[0],top:t.scrollTop+s[1]};case"rb":return{left:t.scrollRight+r+s[0],top:t.scrollBottom-n.height+s[1]};default:return{left:0,top:0}}},Ok=(e,t,n,r,{offset:o=0,translate:i=[0,0],customStyle:s={},autoFitPosition:a=!1,autoFitTransformOrigin:c=!1}={})=>{let l=e,u=go(e,n,r,{offset:o,translate:i});if(a){const p=Sk(e,u,{containerRect:t,popupRect:r,triggerRect:n,offset:o,translate:i});u=p.popupPosition,l=p.position}const f=he({left:`${u.left}px`,top:`${u.top}px`},s);if(c){let p="0";["top","bottom"].includes(l)?p="50%":["left","lt","lb","tr","br"].includes(l)&&(p="100%");let h="0";["left","right"].includes(l)?h="50%":["top","tl","tr","lt","rt"].includes(l)&&(h="100%"),f.transformOrigin=`${p} ${h}`}return{style:f,position:l}},Se=e=>`${e} rotate(45deg)`,xk=(e,t,{customStyle:n={}})=>{switch(e){case"top":return he({left:"50%",bottom:"0",transform:Se("translate(-50%,50%)")},n);case"tl":return he({left:`${Math.round(t.width/2)}px`,bottom:"0",transform:Se("translate(-50%,50%)")},n);case"tr":return he({right:`${Math.round(t.width/2)}px`,bottom:"0",transform:Se("translate(50%,50%)")},n);case"bottom":return he({left:"50%",top:"0",transform:Se("translate(-50%,-50%)")},n);case"bl":return he({left:`${Math.round(t.width/2)}px`,top:"0",transform:Se("translate(-50%,-50%)")},n);case"br":return he({right:`${Math.round(t.width/2)}px`,top:"0",transform:Se("translate(50%,-50%)")},n);case"left":return he({right:"0",top:"50%",transform:Se("translate(50%,-50%)")},n);case"lt":return he({right:"0",top:`${Math.round(t.height/2)}px`,transform:Se("translate(50%,-50%)")},n);case"lb":return he({right:"0",bottom:`${Math.round(t.height/2)}px`,transform:Se("translate(50%,50%)")},n);case"right":return he({left:"0",top:"50%",transform:Se("translate(-50%,-50%)")},n);case"rt":return he({left:"0",top:`${Math.round(t.height/2)}px`,transform:Se("translate(-50%,-50%)")},n);case"rb":return he({left:"0",bottom:`${Math.round(t.height/2)}px`,transform:Se("translate(-50%,50%)")},n);default:return{}}},Mk=e=>e.scrollHeight>e.offsetHeight||e.scrollWidth>e.offsetWidth,Ck=e=>{const t=[];let n=e;for(;n&&n!==document.documentElement;)Mk(n)&&t.push(n),n=n.parentElement;return t};var Gp=function(){if(typeof Map!="undefined")return Map;function e(t,n){var r=-1;return t.some(function(o,i){return o[0]===n?(r=i,!0):!1}),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var r=e(this.__entries__,n),o=this.__entries__[r];return o&&o[1]},t.prototype.set=function(n,r){var o=e(this.__entries__,n);~o?this.__entries__[o][1]=r:this.__entries__.push([n,r])},t.prototype.delete=function(n){var r=this.__entries__,o=e(r,n);~o&&r.splice(o,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var o=0,i=this.__entries__;o<i.length;o++){var s=i[o];n.call(r,s[1],s[0])}},t}()}(),Xa=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,Ei=function(){return typeof global!="undefined"&&global.Math===Math?global:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")()}(),Tk=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Ei):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),_k=2;function Ek(e,t){var n=!1,r=!1,o=0;function i(){n&&(n=!1,e()),r&&a()}function s(){Tk(i)}function a(){var c=Date.now();if(n){if(c-o<_k)return;r=!0}else n=!0,r=!1,setTimeout(s,t);o=c}return a}var Ak=20,Nk=["top","right","bottom","left","width","height","size","weight"],Ik=typeof MutationObserver!="undefined",Pk=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Ek(this.refresh.bind(this),Ak)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,r=n.indexOf(t);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!Xa||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Ik?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!Xa||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,r=n===void 0?"":n,o=Nk.some(function(i){return!!~r.indexOf(i)});o&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Yp=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];Object.defineProperty(e,o,{value:t[o],enumerable:!1,writable:!1,configurable:!0})}return e},wr=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||Ei},Xp=Ni(0,0,0,0);function Ai(e){return parseFloat(e)||0}function Zp(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(r,o){var i=e["border-"+o+"-width"];return r+Ai(i)},0)}function Dk(e){for(var t=["top","right","bottom","left"],n={},r=0,o=t;r<o.length;r++){var i=o[r],s=e["padding-"+i];n[i]=Ai(s)}return n}function Rk(e){var t=e.getBBox();return Ni(0,0,t.width,t.height)}function Bk(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return Xp;var r=wr(e).getComputedStyle(e),o=Dk(r),i=o.left+o.right,s=o.top+o.bottom,a=Ai(r.width),c=Ai(r.height);if(r.boxSizing==="border-box"&&(Math.round(a+i)!==t&&(a-=Zp(r,"left","right")+i),Math.round(c+s)!==n&&(c-=Zp(r,"top","bottom")+s)),!zk(e)){var l=Math.round(a+i)-t,u=Math.round(c+s)-n;Math.abs(l)!==1&&(a-=l),Math.abs(u)!==1&&(c-=u)}return Ni(o.left,o.top,a,c)}var Lk=function(){return typeof SVGGraphicsElement!="undefined"?function(e){return e instanceof wr(e).SVGGraphicsElement}:function(e){return e instanceof wr(e).SVGElement&&typeof e.getBBox=="function"}}();function zk(e){return e===wr(e).document.documentElement}function Fk(e){return Xa?Lk(e)?Rk(e):Bk(e):Xp}function $k(e){var t=e.x,n=e.y,r=e.width,o=e.height,i=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,s=Object.create(i.prototype);return Yp(s,{x:t,y:n,width:r,height:o,top:n,right:t+r,bottom:o+n,left:t}),s}function Ni(e,t,n,r){return{x:e,y:t,width:n,height:r}}var Vk=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Ni(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=Fk(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),Hk=function(){function e(t,n){var r=$k(n);Yp(this,{target:t,contentRect:r})}return e}(),jk=function(){function e(t,n,r){if(this.activeObservations_=[],this.observations_=new Gp,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(t instanceof wr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new Vk(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(t instanceof wr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;!n.has(t)||(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(!!this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new Hk(r.target,r.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Qp=typeof WeakMap!="undefined"?new WeakMap:new Gp,th=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Pk.getInstance(),r=new jk(t,n,this);Qp.set(this,r)}return e}();["observe","unobserve","disconnect"].forEach(function(e){th.prototype[e]=function(){var t;return(t=Qp.get(this))[e].apply(t,arguments)}});var Jk=function(){return typeof Ei.ResizeObserver!="undefined"?Ei.ResizeObserver:th}();const Za=()=>{},Qa=(()=>{try{return!(typeof window!="undefined"&&document!==void 0)}catch{return!0}})(),Wk=(()=>Qa?Za:(e,t,n,r=!1)=>{e.addEventListener(t,n,r)})(),qk=(()=>Qa?Za:(e,t,n,r=!1)=>{e.removeEventListener(t,n,r)})(),eh=e=>{let t=e.el;for(;t&&!t.tagName;)t=t.nextSibling;return t},Kk=e=>{const t=document.createElement("div");return t.setAttribute("class",`arco-overlay arco-overlay-${e}`),t},Uk=e=>Qa?Za():document.querySelector(e),Gk=e=>Fp(e)?Uk(e):e||void 0;var Yk=Dt({name:"ResizeObserver",emits:["resize"],setup(e,{emit:t,slots:n}){let r;const o=c=>eh(c.vnode),i=c=>eh(c.subTree),s=c=>{!c||(r=new Jk(l=>{const u=l[0];t("resize",u)}),r.observe(c))},a=()=>{r&&(r.disconnect(),r=null)};return xr(()=>{const c=Mo();if(c){const l=o(c);s(l)}}),To(()=>{const c=Mo();if(c){const l=o(c),u=i(c);l!==u&&(r&&a(),s(l))}else a()}),zi(()=>{a()}),()=>{const c=n.default&&n.default();return c&&c.length?c[0]:null}}}),nh;(function(e){e[e.ELEMENT=1]="ELEMENT",e[e.FUNCTIONAL_COMPONENT=2]="FUNCTIONAL_COMPONENT",e[e.STATEFUL_COMPONENT=4]="STATEFUL_COMPONENT",e[e.TEXT_CHILDREN=8]="TEXT_CHILDREN",e[e.ARRAY_CHILDREN=16]="ARRAY_CHILDREN",e[e.SLOTS_CHILDREN=32]="SLOTS_CHILDREN",e[e.TELEPORT=64]="TELEPORT",e[e.SUSPENSE=128]="SUSPENSE",e[e.COMPONENT_SHOULD_KEEP_ALIVE=256]="COMPONENT_SHOULD_KEEP_ALIVE",e[e.COMPONENT_KEPT_ALIVE=512]="COMPONENT_KEPT_ALIVE",e[e.COMPONENT=6]="COMPONENT"})(nh||(nh={}));const Xk=e=>(e==null?void 0:e.$)!==void 0,Zk=e=>e&&e.shapeFlag&1,Qk=(e,t)=>Boolean(e&&e.shapeFlag&6),tS=(e,t)=>Boolean(e&&e.shapeFlag&16),eS=e=>{if(!e)return!0;for(const t of e)if(t.children)return!1;return!0},rh=(e,t)=>{for(let n=0;n<e.length;n++){const r=e[n];if(Zk(r)||Qk(r)){const o=Ua(t)?t(r):t;return e[n]=Bh(r,o,!0),!0}if(tS(r,r.children)&&rh(r.children,t))return!0}return!1};function nS(e,t){const n=Rt(e[t]);return To(()=>{const r=e[t];n.value!==r&&(n.value=r)}),n}const oh=Symbol("ArcoTrigger"),ih=Symbol("ArcoZIndex"),sh=typeof window=="undefined"?global:window,rS=sh.requestAnimationFrame,ah=sh.cancelAnimationFrame;function oS(e){let t=0;const n=(...r)=>{t&&ah(t),t=rS(()=>{e(...r),t=0})};return n.cancel=()=>{ah(t),t=0},n}var iS=Object.defineProperty,sS=Object.defineProperties,aS=Object.getOwnPropertyDescriptors,ch=Object.getOwnPropertySymbols,cS=Object.prototype.hasOwnProperty,lS=Object.prototype.propertyIsEnumerable,lh=(e,t,n)=>t in e?iS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,uh=(e,t)=>{for(var n in t||(t={}))cS.call(t,n)&&lh(e,n,t[n]);if(ch)for(var n of ch(t))lS.call(t,n)&&lh(e,n,t[n]);return e},uS=(e,t)=>sS(e,aS(t));function fS(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!yc(e)}const pS=100;var tc=Dt({name:"Trigger",inheritAttrs:!1,props:{popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},trigger:{type:[String,Array],default:"hover",validator:e=>{const t=[].concat(e);for(const n of t)if(!Wp.includes(n))return!1;return!0}},position:{type:String,default:"bottom"},disabled:{type:Boolean,default:!1},popupOffset:{type:Number,default:0},popupTranslate:{type:[Array,Object]},showArrow:{type:Boolean,default:!1},alignPoint:{type:Boolean,default:!1},popupHoverStay:{type:Boolean,default:!0},blurToClose:{type:Boolean,default:!0},clickToClose:{type:Boolean,default:!0},clickOutsideToClose:{type:Boolean,default:!0},unmountOnClose:{type:Boolean,default:!0},contentClass:{type:[String,Array,Object]},contentStyle:{type:Object},arrowClass:{type:[String,Array,Object]},arrowStyle:{type:Object},popupStyle:{type:Object},animationName:{type:String,default:"fade-in"},duration:{type:[Number,Object]},mouseEnterDelay:{type:Number,default:100},mouseLeaveDelay:{type:Number,default:100},focusDelay:{type:Number,default:0},autoFitPopupWidth:{type:Boolean,default:!1},autoFitPopupMinWidth:{type:Boolean,default:!1},autoFixPosition:{type:Boolean,default:!0},popupContainer:{type:[String,Object]},updateAtScroll:{type:Boolean,default:!1},autoFitTransformOrigin:{type:Boolean,default:!1},hideEmpty:{type:Boolean,default:!1},openedCls:{type:String},autoFitPosition:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},onPopupVisibleChange:{type:Function}},emits:["update:popupVisible","popupVisibleChange"],setup(e,{emit:t,slots:n,attrs:r}){var o;const i=We("trigger"),s=te(()=>[].concat(e.trigger)),a=new Set,c=Li(oh,void 0),l=Li(ih,void 0),u=((o=l==null?void 0:l.zIndex)!=null?o:0)+pS,f=Rt(),p=te(()=>Xk(f.value)?f.value.$el:f.value),h={},d=Rt(),v=Rt(e.defaultPopupVisible),g=Rt(e.position),b={},y=Rt({}),M=Rt({}),m=te(()=>{var R;return Gk((R=e.popupContainer)!=null?R:document.documentElement)}),C=Rt(),O=Rt({top:"0px",left:"0px"}),E=te(()=>{var R;return(R=e.popupVisible)!=null?R:v.value});let P=0,D=!1;const F=()=>{P&&(window.clearTimeout(P),P=0)},it=R=>{if(e.alignPoint){const{pageX:tt,pageY:wt}=R;O.value={top:`${wt}px`,left:`${tt}px`}}},W=()=>{if(e.alignPoint)y.value=O.value;else{if(!p.value||!d.value||!m.value)return;const R=m.value.getBoundingClientRect(),tt=Up(p.value,R),wt=Up(d.value,R),{style:bt,position:Qt}=Ok(e.position,R,tt,wt,{offset:e.popupOffset,translate:e.popupTranslate,customStyle:e.popupStyle,autoFitPosition:e.autoFitPosition,autoFitTransformOrigin:e.autoFitTransformOrigin});e.autoFitPopupMinWidth?bt.minWidth=`${tt.width}px`:e.autoFitPopupWidth&&(bt.width=`${tt.width}px`),g.value!==Qt&&(g.value=Qt),y.value=bt,e.showArrow&&(M.value=xk(Qt,tt,{customStyle:e.arrowStyle}))}},H=(R,tt)=>{if(R===E.value&&P===0)return;const wt=()=>{v.value=R,t("update:popupVisible",R),t("popupVisibleChange",R),R&&hc(()=>{W()})};tt?(F(),P=window.setTimeout(wt,tt)):wt()},mt=R=>{E.value&&!e.clickToClose||(it(R),H(!E.value))},Z=R=>{c==null||c.onMouseenter(),it(R),H(!0,e.mouseEnterDelay)},Y=()=>{c==null||c.onMouseleave(),H(!1,e.mouseLeaveDelay)},gt=()=>{c==null||c.onFocusin(),H(!0,e.focusDelay)},yt=()=>{c==null||c.onFocusout(),!!e.blurToClose&&H(!1)};s.value.includes("click")&&(h.onClick=mt),s.value.includes("hover")&&(h.onMouseenter=Z,h.onMouseleave=Y,e.popupHoverStay&&(b.onMouseenter=Z,b.onMouseleave=Y)),s.value.includes("focus")&&(h.onFocusin=gt,h.onFocusout=yt),s.value.includes("contextMenu")&&(h.onContextmenu=R=>{R.preventDefault(),mt(R)}),mc(oh,En({onMouseenter:Z,onMouseleave:Y,onFocusin:gt,onFocusout:yt,addChildRef:R=>{a.add(R),c==null||c.addChildRef(R)},removeChildRef:R=>{a.delete(R),c==null||c.removeChildRef(R)}})),mc(ih,En({zIndex:u}));const Ie=()=>{qk(document.body,"mousedown",oe),D=!1},Zt=nS(n,"content"),qe=te(()=>{var R;return e.hideEmpty&&eS((R=Zt.value)==null?void 0:R.call(Zt))}),oe=R=>{var tt,wt,bt;if(!(((tt=p.value)==null?void 0:tt.contains(R.target))||((wt=d.value)==null?void 0:wt.contains(R.target)))){for(const Qt of a)if((bt=Qt.value)==null?void 0:bt.contains(R.target))return;Ie(),H(!1)}},Pt=oS(()=>{E.value&&W()}),Pe=()=>{E.value&&W()};c==null||c.addChildRef(d);const Mn=te(()=>E.value?e.openedCls:void 0);let ie;return gc(E,R=>{if(e.clickOutsideToClose){if(D&&!R){Ie();return}D||(Wk(document.body,"mousedown",oe),D=!0)}if(e.updateAtScroll){if(R){ie=Ck(p.value);for(const tt of ie)tt.addEventListener("scroll",Pt)}else if(ie)for(const tt of ie)tt.removeEventListener("scroll",Pt)}}),gc(()=>[e.autoFitPopupWidth,e.autoFitPopupMinWidth],()=>{E.value&&W()}),xr(()=>{E.value&&W()}),To(()=>{E.value&&W()}),xo(()=>{c==null||c.removeChildRef(d)}),()=>{var R,tt,wt;const bt=(tt=(R=n.default)==null?void 0:R.call(n))!=null?tt:[];return!e.disabled&&bt&&rh(bt,uh({ref:f,class:Mn.value},h)),rt(Ke,null,[e.autoFixPosition?rt(Yk,{onResize:Pe},fS(bt)?bt:{default:()=>[bt]}):bt,rt(dc,{to:(wt=e.popupContainer)!=null?wt:"body",disabled:!e.renderToBody},{default:()=>[rt(Lh,{name:e.animationName,duration:e.duration},{default:()=>{var Qt;return[(!e.unmountOnClose||E.value)&&!qe.value&&bc(rt("div",vc({ref:d,class:[`${i}-popup`,`${i}-position-${g.value}`],style:uS(uh({},y.value),{zIndex:u}),"trigger-placement":g.value},b,{onMousedown:Un=>Un.preventDefault()},r),[rt("div",{class:[`${i}-content`,e.contentClass],style:e.contentStyle},[(Qt=n.content)==null?void 0:Qt.call(n)]),e.showArrow&&rt("div",{ref:C,class:[`${i}-arrow`,e.arrowClass],style:M.value},null)]),[[zh,E.value]])]}})]})])}}});const hS=Object.assign(tc,{install:(e,t)=>{jp(e,t);const n=Hp(t);e.component(n+tc.name,tc)}}),dS=Dt({name:"IconCheckCircleFill",props:{strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},spin:Boolean},setup(e){const t=We("icon");return{cls:te(()=>[t,`${t}-check-circle-fill`,{[`${t}-spin`]:e.spin}])}}}),vS=["stroke-width","stroke-linecap","stroke-linejoin"],mS=V("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm10.207-24.379a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0L22 26.172l-4.878-4.88a1 1 0 0 0-1.415 0l-1.414 1.415a1 1 0 0 0 0 1.414l7 7a1 1 0 0 0 1.414 0l11.5-11.5Z",fill:"currentColor",stroke:"none"},null,-1),gS=[mS];function yS(e,t,n,r,o,i){return q(),lt("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:Ot(e.cls),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},gS,10,vS)}var ec=On(dS,[["render",yS]]);const bS=Object.assign(ec,{install:(e,t)=>{var n;const r=(n=t==null?void 0:t.iconPrefix)!=null?n:"";e.component(r+ec.name,ec)}}),wS=Dt({name:"Popover",components:{Trigger:hS},props:{popupVisible:{type:Boolean,default:void 0},defaultPopupVisible:{type:Boolean,default:!1},title:String,content:String,trigger:{type:[String,Array],default:"hover",validator:e=>{const t=[].concat(e);for(const n of t)if(!Wp.includes(n))return!1;return!0}},position:{type:String,default:"top",validator:e=>ak.includes(e)},contentClass:{type:[String,Array,Object]},contentStyle:{type:Object},arrowClass:{type:[String,Array,Object]},arrowStyle:{type:Object},popupContainer:{type:[String,Object]}},emits:["update:popupVisible","popupVisibleChange"],setup(e,{emit:t}){const n=We("popover"),r=Rt(e.defaultPopupVisible),o=te(()=>{var c;return(c=e.popupVisible)!=null?c:r.value}),i=c=>{r.value=c,t("update:popupVisible",c),t("popupVisibleChange",c)},s=te(()=>[`${n}-popup-content`,e.contentClass]),a=te(()=>[`${n}-popup-arrow`,e.arrowClass]);return{prefixCls:n,computedPopupVisible:o,contentCls:s,arrowCls:a,handlePopupVisibleChange:i}}});function kS(e,t,n,r,o,i){const s=xe("trigger");return q(),Re(s,{class:Ot(e.prefixCls),trigger:e.trigger,position:e.position,"popup-visible":e.computedPopupVisible,"popup-offset":10,"content-class":e.contentCls,"content-style":e.contentStyle,"arrow-class":e.arrowCls,"arrow-style":e.arrowStyle,"show-arrow":"","popup-container":e.popupContainer,onPopupVisibleChange:e.handlePopupVisibleChange},{content:rn(()=>[V("div",{class:Ot(`${e.prefixCls}-title`)},[Zn(e.$slots,"title",{},()=>[Co(nn(e.title),1)])],2),V("div",{class:Ot(`${e.prefixCls}-content`)},[Zn(e.$slots,"content",{},()=>[Co(nn(e.content),1)])],2)]),default:rn(()=>[Zn(e.$slots,"default")]),_:3},8,["class","trigger","position","popup-visible","content-class","content-style","arrow-class","arrow-style","popup-container","onPopupVisibleChange"])}var nc=On(wS,[["render",kS]]);const SS=Object.assign(nc,{install:(e,t)=>{jp(e,t);const n=Hp(t);e.component(n+nc.name,nc)}}),OS=Dt({name:"IconExclamationCircleFill",props:{strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},spin:Boolean},setup(e){const t=We("icon");return{cls:te(()=>[t,`${t}-exclamation-circle-fill`,{[`${t}-spin`]:e.spin}])}}}),xS=["stroke-width","stroke-linecap","stroke-linejoin"],MS=V("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm-2-11a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2Zm4-18a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V15Z",fill:"currentColor",stroke:"none"},null,-1),CS=[MS];function TS(e,t,n,r,o,i){return q(),lt("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:Ot(e.cls),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},CS,10,xS)}var rc=On(OS,[["render",TS]]);const _S=Object.assign(rc,{install:(e,t)=>{var n;const r=(n=t==null?void 0:t.iconPrefix)!=null?n:"";e.component(r+rc.name,rc)}}),ES=Dt({name:"IconInfoCircleFill",props:{strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},spin:Boolean},setup(e){const t=We("icon");return{cls:te(()=>[t,`${t}-info-circle-fill`,{[`${t}-spin`]:e.spin}])}}}),AS=["stroke-width","stroke-linecap","stroke-linejoin"],NS=V("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm2-30a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2Zm0 17h1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-6a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h1v-8a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v11Z",fill:"currentColor",stroke:"none"},null,-1),IS=[NS];function PS(e,t,n,r,o,i){return q(),lt("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:Ot(e.cls),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},IS,10,AS)}var oc=On(ES,[["render",PS]]);const DS=Object.assign(oc,{install:(e,t)=>{var n;const r=(n=t==null?void 0:t.iconPrefix)!=null?n:"";e.component(r+oc.name,oc)}}),RS=Dt({name:"IconCloseCircleFill",props:{strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},spin:Boolean},setup(e){const t=We("icon");return{cls:te(()=>[t,`${t}-close-circle-fill`,{[`${t}-spin`]:e.spin}])}}}),BS=["stroke-width","stroke-linecap","stroke-linejoin"],LS=V("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm4.955-27.771-4.95 4.95-4.95-4.95a1 1 0 0 0-1.414 0l-1.414 1.414a1 1 0 0 0 0 1.414l4.95 4.95-4.95 4.95a1 1 0 0 0 0 1.414l1.414 1.414a1 1 0 0 0 1.414 0l4.95-4.95 4.95 4.95a1 1 0 0 0 1.414 0l1.414-1.414a1 1 0 0 0 0-1.414l-4.95-4.95 4.95-4.95a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0Z",fill:"currentColor",stroke:"none"},null,-1),zS=[LS];function FS(e,t,n,r,o,i){return q(),lt("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:Ot(e.cls),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},zS,10,BS)}var ic=On(RS,[["render",FS]]);const $S=Object.assign(ic,{install:(e,t)=>{var n;const r=(n=t==null?void 0:t.iconPrefix)!=null?n:"";e.component(r+ic.name,ic)}}),VS=Dt({name:"Message",components:{AIconHover:uk,IconInfoCircleFill:DS,IconCheckCircleFill:bS,IconExclamationCircleFill:_S,IconCloseCircleFill:$S,IconClose:mk},props:{type:{type:String,default:"info",validator:e=>Jp.includes(e)},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!0},duration:{type:Number,default:3e3},resetOnUpdate:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const n=We("message");let r=0;const o=()=>{t("close")};return xr(()=>{e.duration>0&&(r=window.setTimeout(o,e.duration))}),To(()=>{e.resetOnUpdate&&(r&&(window.clearTimeout(r),r=0),e.duration>0&&(r=window.setTimeout(o,e.duration)))}),zi(()=>{r&&window.clearTimeout(r)}),{prefixCls:n,handleClose:o}}});function HS(e,t,n,r,o,i){const s=xe("icon-info-circle-fill"),a=xe("icon-check-circle-fill"),c=xe("icon-exclamation-circle-fill"),l=xe("icon-close-circle-fill"),u=xe("icon-close"),f=xe("a-icon-hover");return q(),lt("li",{class:Ot([e.prefixCls,`${e.prefixCls}-${e.type}`,{[`${e.prefixCls}-closable`]:e.closable}])},[e.showIcon?(q(),lt("span",{key:0,class:Ot(`${e.prefixCls}-icon`)},[Zn(e.$slots,"icon",{},()=>[e.type==="info"?(q(),Re(s,{key:0})):e.type==="success"?(q(),Re(a,{key:1})):e.type==="warning"?(q(),Re(c,{key:2})):e.type==="error"?(q(),Re(l,{key:3})):Xn("v-if",!0)])],2)):Xn("v-if",!0),V("span",{class:Ot(`${e.prefixCls}-content`)},[Zn(e.$slots,"default")],2),e.closable?(q(),lt("span",{key:1,class:Ot(`${e.prefixCls}-close-btn`),onClick:t[0]||(t[0]=(...p)=>e.handleClose&&e.handleClose(...p))},[rt(f,null,{default:rn(()=>[rt(u)]),_:1})],2)):Xn("v-if",!0)],2)}var jS=On(VS,[["render",HS]]);const JS=["top","bottom"];function WS(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!yc(e)}var qS=Dt({name:"MessageList",props:{messages:{type:Array,default:()=>[]},position:{type:String,default:"top",validator:e=>JS.includes(e)}},emits:["close"],setup(e,t){const n=We("message-list");return()=>{let r;return rt(Fh,{class:[n,`${n}-${e.position}`],name:"fade-message",tag:"ul"},WS(r=e.messages.map(o=>{const i={default:()=>Ua(o.content)?o.content():o.content,icon:()=>Ua(o.icon)?o.icon():o.icon};return rt(jS,{key:o.id,type:o.type,duration:o.duration,closable:o.closable,resetOnUpdate:o.resetOnUpdate,onClose:()=>t.emit("close",o.id)},i)}))?r:{default:()=>[r]})}}}),KS=Object.defineProperty,US=Object.defineProperties,GS=Object.getOwnPropertyDescriptors,fh=Object.getOwnPropertySymbols,YS=Object.prototype.hasOwnProperty,XS=Object.prototype.propertyIsEnumerable,ph=(e,t,n)=>t in e?KS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ii=(e,t)=>{for(var n in t||(t={}))YS.call(t,n)&&ph(e,n,t[n]);if(fh)for(var n of fh(t))XS.call(t,n)&&ph(e,n,t[n]);return e},hh=(e,t)=>US(e,GS(t));class ZS{constructor(t,n){this.messageCount=0,this.add=i=>{var s;this.messageCount++;const a=(s=i.id)!=null?s:`__arco_message_${this.messageCount}`;if(this.messageIds.has(a))return this.update(a,i);const c=En(Ii({id:a},i));return this.messages.value.push(c),this.messageIds.add(a),{close:()=>this.remove(a)}},this.update=(i,s)=>{for(let a=0;a<this.messages.value.length;a++)if(this.messages.value[a].id===i){const c=!Y1(s.duration);Object.assign(this.messages.value[a],hh(Ii({},s),{id:i,resetOnUpdate:c}));break}return{close:()=>this.remove(i)}},this.remove=i=>{for(let s=0;s<this.messages.value.length;s++)if(this.messages.value[s].id===i){this.messages.value.splice(s,1),this.messageIds.delete(i);break}},this.clear=()=>{this.messages.value.splice(0)};const{position:r}=t;this.container=Kk("message"),this.messageIds=new Set,this.messages=Rt([]);const o=rt(qS,{messages:this.messages.value,position:r,onClose:this.remove});n&&(o.appContext=n),$h(o,this.container),document.body.appendChild(this.container)}}const yo={},sc=Jp.reduce((e,t)=>(e[t]=n=>{Fp(n)&&(n={content:n});const r=Ii({type:t},n),{position:o="top"}=r;return yo[o]||(yo[o]=new ZS(r)),yo[o].add(r)},e),{});sc.clear=e=>{var t;e?(t=yo[e])==null||t.clear():Object.values(yo).forEach(n=>n.clear())};const QS=hh(Ii({},sc),{install:e=>{e.config.globalProperties.$message=sc}});const xn=e=>(wc("data-v-ec913d2a"),e=e(),kc(),e),tO={as:"nav",class:"bg-gray-800 rounded-b-md fixed top-0 w-full z-10"},eO={class:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8"},nO={class:"relative flex items-center justify-between h-16"},rO={class:"flex-1 flex items-center justify-center sm:justify-start"},oO={class:"absolute inset-y-0 inset-x-0 right-0 flex items-center px-2 sm:static sm:inset-auto sm:pr-0"},iO={class:"video-btn mr-4"},sO=xn(()=>V("span",{class:"sr-only"},"Open live",-1)),aO={class:"w-80"},cO=xn(()=>V("div",null,"\u656C\u8BF7\u671F\u5F85~",-1)),lO=xn(()=>V("hr",{class:"my-4"},null,-1)),uO={class:"flex items-center"},fO=xn(()=>V("div",{class:"w-24 text-right"},"\u5206\u4EAB\u6A21\u5F0F\uFF1A",-1)),pO={class:"w-40"},hO=xn(()=>V("button",{class:"close-btn"},"\u5173\u95ED",-1)),dO=xn(()=>V("div",{class:"flex-grow"},null,-1)),vO=xn(()=>V("span",{class:"sr-only"},"Copy Share Link",-1)),mO=xn(()=>V("div",{class:"leave-btn"},"\u79BB\u5F00",-1)),gO={setup(e){const t="doc/qwdQs",n=()=>{navigator.clipboard.writeText(t),QS.success("\u5DF2\u6210\u529F\u590D\u5236\u9080\u8BF7\u94FE\u63A5\uFF01")};return(r,o)=>(q(),lt("nav",tO,[V("div",eO,[V("div",nO,[V("div",rO,[rt(An,{name:"logo",class:"h-8 w-8"})]),V("div",oO,[rt(De(SS),null,{content:rn(()=>[V("div",aO,[cO,lO,V("div",uO,[fO,V("div",pO,[rt(U1)]),hO])])]),default:rn(()=>[V("button",iO,[sO,rt(An,{name:"toolbar-live",class:"h-6 w-6"})])]),_:1}),dO,V("button",{title:"\u70B9\u51FB\u5206\u4EAB\u6B64\u623F\u95F4",class:"text-gray-300 hover:text-white cursor-pointer mr-4",onClick:n},[vO,rt(An,{name:"toolbar-share",class:"inline-block h-5 w-5"})]),mO])])])]))}};var yO=Tr(gO,[["__scopeId","data-v-ec913d2a"]]);const bO=e=>(wc("data-v-5aa22a46"),e=e(),kc(),e),wO={class:"relative"},kO={class:"absolute flex left-0 right-0 group-hover:bg-gray-800 text-white p-1 transition"},SO={class:"sm-btn w-5 bg-indigo-600 text-center overflow-hidden",title:"\u70B9\u51FB\u5206\u4EAB\u6B64\u623F\u95F4"},OO={class:"sm-btn",title:"\u70B9\u51FB\u5206\u4EAB\u6B64\u623F\u95F4"},xO={class:"sm-btn",title:"\u70B9\u51FB\u5206\u4EAB\u6B64\u623F\u95F4"},MO=bO(()=>V("div",{class:"flex-1"},null,-1)),CO=["onClick"];function TO(e,{emit:t}){const n=e,r=Rt(null);Vh(window,"resize",()=>{const i=window.getComputedStyle(r.value,null),s=+i.left.replace(/\px/g,""),a=+i.top.replace(/\px/g,"");(s<0||a<0)&&(r.value.style.right="8px",r.value.style.bottom="8px")});const o=()=>{};return zi(()=>{}),(i,s)=>{const a=Hh("drag");return bc((q(),lt("div",{ref:(c,l)=>{l.target=c,r.value=c},class:Ot(["fixed min-w-[10rem] min-h-[8rem] right-2 select-none z-10 bg-gray-100 rounded overflow-hidden border-4 border-indigo-300 shadow-md hover:shadow-lg transition group",e.className])},[V("div",wO,[V("div",kO,[V("div",SO,nn(n.name[0]),1),V("button",OO,[rt(An,{name:"live-camera-off",class:"w-5 h-5"})]),V("button",xO,[rt(An,{name:"live-mic-off",class:"w-5 h-5"})]),MO,V("button",{class:"close-btn",onClick:s[0]||(s[0]=c=>i.$emit("close",n.name)),title:"\u70B9\u51FB\u5206\u4EAB\u6B64\u623F\u95F4"},[rt(An,{name:"close",class:"h-5 w-5"})])]),V("div",{class:"cursor-pointer",onMousedown:s[1]||(s[1]=Sc(()=>{},["self","stop"])),onClick:Sc(o,["self","stop"])},null,40,CO)])],2)),[[a]])}}const _O={directives:{drag:{mounted(e){e.style.cursor="move";const t=window.getComputedStyle(e,null);e.onmousedown=n=>{const r=n.clientX,o=n.clientY,i=+t.right.replace(/\px/g,""),s=+t.bottom.replace(/\px/g,""),a=+t.width.replace(/\px/g,""),c=+t.height.replace(/\px/g,""),l=window.innerWidth,u=window.innerHeight;document.onmousemove=function(f){const p=f.clientX-r,h=f.clientY-o,d=i-p,v=s-h;d<0||v<0||d>l-a||v>u-c||(e.style.right=d+"px",e.style.bottom=v+"px")},document.onmouseup=function(f){document.onmousemove=null,document.onmouseup=null}}}}}},EO=Object.assign(_O,{props:{name:{type:String,default:"me"},className:{type:String,default:"bottom-2"}},emits:["close"],setup:TO});var dh=Tr(EO,[["__scopeId","data-v-5aa22a46"]]);const AO={class:"pt-16 w-screen h-screen overflow-hidden"},BO={setup(e){const t=En({id:1,name:"a",openVideo:!1,openRadio:!1,isShow:!0}),n=En([{id:1,name:"a",openVideo:!1,openRadio:!1,isShow:!0},{id:2,name:"111",openVideo:!1,openRadio:!1,isShow:!0}]);return(r,o)=>(q(),lt(Ke,null,[rt(yO),V("div",AO,[rt(K1,{class:"h-full"}),(q(!0),lt(Ke,null,Bi(De(n),(i,s)=>(q(),lt(Ke,null,[i.isShow?(q(),Re(dh,{onClose:a=>i.isShow=!1,name:i.name,"class-name":"w-80 h-60 "+(s==0?"bottom-[calc(100vh-19rem)]":"bottom-[calc(100vh-35rem)]"),key:i.id},null,8,["onClose","name","class-name"])):Xn("",!0)],64))),256)),De(t).isShow?(q(),Re(dh,{onClose:o[0]||(o[0]=i=>De(t).isShow=!1),name:"\u6211",key:De(t).name})):Xn("",!0)])],64))}};export{BO as default};
